!function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:r})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(t.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var o in e)t.d(r,o,function(t){return e[t]}.bind(null,o));return r},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=14)}([function(e,t){var n,r=Math.ceil;n=function(){var e=e||function(e){var t=Object.create||function(){function e(){}return function(t){var n;return e.prototype=t,n=new e,e.prototype=null,n}}(),n={},o=n.lib={},i=o.Base={extend:function(e){var n=t(this);return e&&n.mixIn(e),n.hasOwnProperty("init")&&this.init!==n.init||(n.init=function(){n.$super.init.apply(this,arguments)}),n.init.prototype=n,n.$super=this,n},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},s=o.WordArray=i.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null==t?4*e.length:t},toString:function(e){return(e||c).stringify(this)},concat:function(e){var t=this.words,n=e.words,r=this.sigBytes,o=e.sigBytes;if(this.clamp(),r%4)for(var i,s=0;s<o;s++)i=255&n[s>>>2]>>>24-s%4*8,t[r+s>>>2]|=i<<24-(r+s)%4*8;else for(s=0;s<o;s+=4)t[r+s>>>2]=n[s>>>2];return this.sigBytes+=o,this},clamp:function(){var e=this.words,t=this.sigBytes;e[t>>>2]&=4294967295<<32-t%4*8,e.length=r(t/4)},clone:function(){var e=i.clone.call(this);return e.words=this.words.slice(0),e},random:function(t){for(var n,r,o=[],i=function(t){t=t;var n=987654321,r=4294967295;return function(){var o=((n=36969*(65535&n)+(n>>16)&r)<<16)+(t=18e3*(65535&t)+(t>>16)&r)&r;return o/=4294967296,(o+=.5)*(.5<e.random()?1:-1)}},a=0;a<t;a+=4)n=987654071*(r=i(4294967296*(n||e.random())))(),o.push(0|4294967296*r());return new s.init(o,t)}}),a=n.enc={},c=a.Hex={stringify:function(e){for(var t,n=e.words,r=e.sigBytes,o=[],i=0;i<r;i++)t=255&n[i>>>2]>>>24-i%4*8,o.push((t>>>4).toString(16)),o.push((15&t).toString(16));return o.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r+=2)n[r>>>3]|=parseInt(e.substr(r,2),16)<<24-r%8*4;return new s.init(n,t/2)}},u=a.Latin1={stringify:function(e){for(var t,n=e.words,r=e.sigBytes,o=[],i=0;i<r;i++)t=255&n[i>>>2]>>>24-i%4*8,o.push(String.fromCharCode(t));return o.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r++)n[r>>>2]|=(255&e.charCodeAt(r))<<24-r%4*8;return new s.init(n,t)}},l=a.Utf8={stringify:function(e){try{return decodeURIComponent(escape(u.stringify(e)))}catch(e){throw new Error("Malformed UTF-8 data")}},parse:function(e){return u.parse(unescape(encodeURIComponent(e)))}},h=o.BufferedBlockAlgorithm=i.extend({reset:function(){this._data=new s.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=l.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var n=this._data,o=n.words,i=n.sigBytes,a=this.blockSize,c=i/(4*a),u=(c=t?r(c):e.max((0|c)-this._minBufferSize,0))*a,l=e.min(4*u,i);if(u){for(var h=0;h<u;h+=a)this._doProcessBlock(o,h);var p=o.splice(0,u);n.sigBytes-=l}return new s.init(p,l)},clone:function(){var e=i.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0}),p=(o.Hasher=h.extend({cfg:i.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){h.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,n){return new e.init(n).finalize(t)}},_createHmacHelper:function(e){return function(t,n){return new p.HMAC.init(e,n).finalize(t)}}}),n.algo={});return n}(Math);return e},e.exports=n()},function(e,t,n){e.exports=function(e){var t,n,r,o,i,s,a,c,u,l,h,p,d,f,_,m,g,y,v,E,b,N;e.lib.Cipher||(n=(t=e).lib,r=n.Base,o=n.WordArray,i=n.BufferedBlockAlgorithm,(s=t.enc).Utf8,a=s.Base64,c=t.algo,u=c.EvpKDF,l=n.Cipher=i.extend({cfg:r.extend(),createEncryptor:function(e,t){return this.create(this._ENC_XFORM_MODE,e,t)},createDecryptor:function(e,t){return this.create(this._DEC_XFORM_MODE,e,t)},init:function(e,t,n){this.cfg=this.cfg.extend(n),this._xformMode=e,this._key=t,this.reset()},reset:function(){i.reset.call(this),this._doReset()},process:function(e){return this._append(e),this._process()},finalize:function(e){e&&this._append(e);var t=this._doFinalize();return t},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function e(e){return"string"==typeof e?N:v}return function(t){return{encrypt:function(n,r,o){return e(r).encrypt(t,n,r,o)},decrypt:function(n,r,o){return e(r).decrypt(t,n,r,o)}}}}()}),n.StreamCipher=l.extend({_doFinalize:function(){var e=this._process(!0);return e},blockSize:1}),h=t.mode={},p=n.BlockCipherMode=r.extend({createEncryptor:function(e,t){return this.Encryptor.create(e,t)},createDecryptor:function(e,t){return this.Decryptor.create(e,t)},init:function(e,t){this._cipher=e,this._iv=t}}),d=h.CBC=function(){function e(e,t,n){var r=this._iv;if(r){var o=r;this._iv=void 0}else var o=this._prevBlock;for(var i=0;i<n;i++)e[t+i]^=o[i]}var t=p.extend();return t.Encryptor=t.extend({processBlock:function(t,n){var r=this._cipher,o=r.blockSize;e.call(this,t,n,o),r.encryptBlock(t,n),this._prevBlock=t.slice(n,n+o)}}),t.Decryptor=t.extend({processBlock:function(t,n){var r=this._cipher,o=r.blockSize,i=t.slice(n,n+o);r.decryptBlock(t,n),e.call(this,t,n,o),this._prevBlock=i}}),t}(),f=t.pad={},_=f.Pkcs7={pad:function(e,t){for(var n=4*t,r=n-e.sigBytes%n,i=[],s=0;s<r;s+=4)i.push(r<<24|r<<16|r<<8|r);var a=o.create(i,r);e.concat(a)},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},n.BlockCipher=l.extend({cfg:l.cfg.extend({mode:d,padding:_}),reset:function(){l.reset.call(this);var e=this.cfg,t=e.iv,n=e.mode;if(this._xformMode==this._ENC_XFORM_MODE)var r=n.createEncryptor;else{var r=n.createDecryptor;this._minBufferSize=1}this._mode&&this._mode.__creator==r?this._mode.init(this,t&&t.words):(this._mode=r.call(n,this,t&&t.words),this._mode.__creator=r)},_doProcessBlock:function(e,t){this._mode.processBlock(e,t)},_doFinalize:function(){var e=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){e.pad(this._data,this.blockSize);var t=this._process(!0)}else{var t=this._process(!0);e.unpad(t)}return t},blockSize:4}),m=n.CipherParams=r.extend({init:function(e){this.mixIn(e)},toString:function(e){return(e||this.formatter).stringify(this)}}),g=t.format={},y=g.OpenSSL={stringify:function(e){var t=e.ciphertext,n=e.salt;if(n)var r=o.create([1398893684,1701076831]).concat(n).concat(t);else var r=t;return r.toString(a)},parse:function(e){var t=a.parse(e),n=t.words;if(1398893684==n[0]&&1701076831==n[1]){var r=o.create(n.slice(2,4));n.splice(0,4),t.sigBytes-=16}return m.create({ciphertext:t,salt:r})}},v=n.SerializableCipher=r.extend({cfg:r.extend({format:y}),encrypt:function(e,t,n,r){r=this.cfg.extend(r);var o=e.createEncryptor(n,r),i=o.finalize(t),s=o.cfg;return m.create({ciphertext:i,key:n,iv:s.iv,algorithm:e,mode:s.mode,padding:s.padding,blockSize:e.blockSize,formatter:r.format})},decrypt:function(e,t,n,r){r=this.cfg.extend(r),t=this._parse(t,r.format);var o=e.createDecryptor(n,r).finalize(t.ciphertext);return o},_parse:function(e,t){return"string"==typeof e?t.parse(e,this):e}}),E=t.kdf={},b=E.OpenSSL={execute:function(e,t,n,r){r||(r=o.random(8));var i=u.create({keySize:t+n}).compute(e,r),s=o.create(i.words.slice(t),4*n);return i.sigBytes=4*t,m.create({key:i,iv:s,salt:r})}},N=n.PasswordBasedCipher=v.extend({cfg:v.cfg.extend({kdf:b}),encrypt:function(e,t,n,r){var o=(r=this.cfg.extend(r)).kdf.execute(n,e.keySize,e.ivSize);r.iv=o.iv;var i=v.encrypt.call(this,e,t,o.key,r);return i.mixIn(o),i},decrypt:function(e,t,n,r){r=this.cfg.extend(r),t=this._parse(t,r.format);var o=r.kdf.execute(n,e.keySize,e.ivSize,t.salt);r.iv=o.iv;var i=v.decrypt.call(this,e,t,o.key,r);return i}}))}(n(0),n(2))},function(e,t,n){e.exports=function(e){return n=(t=e).lib,r=n.Base,o=n.WordArray,i=t.algo,s=i.MD5,a=i.EvpKDF=r.extend({cfg:r.extend({keySize:4,hasher:s,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var n=this.cfg,r=n.hasher.create(),i=o.create(),s=i.words,a=n.keySize,c=n.iterations;s.length<a;){u&&r.update(u);var u=r.update(e).finalize(t);r.reset();for(var l=1;l<c;l++)u=r.finalize(u),r.reset();i.concat(u)}return i.sigBytes=4*a,i}}),t.EvpKDF=function(e,t,n){return a.create(n).compute(e,t)},e.EvpKDF;var t,n,r,o,i,s,a}(n(0),n(6),n(7))},function(e,t,n){e.exports=function(e){return function(){function t(e,t,n){for(var r=[],i=0,s=0;s<t;s++)if(s%4){var a=n[e.charCodeAt(s-1)]<<s%4*2,c=n[e.charCodeAt(s)]>>>6-s%4*2;r[i>>>2]|=(a|c)<<24-i%4*8,i++}return o.create(r,i)}var n=e,r=n.lib,o=r.WordArray,i=n.enc;i.Base64={stringify:function(e){var t=e.words,n=e.sigBytes,r=this._map;e.clamp();for(var o=[],i=0;i<n;i+=3)for(var s=255&t[i>>>2]>>>24-i%4*8,a=255&t[i+1>>>2]>>>24-(i+1)%4*8,c=255&t[i+2>>>2]>>>24-(i+2)%4*8,u=0;4>u&&i+.75*u<n;u++)o.push(r.charAt(63&(s<<16|a<<8|c)>>>6*(3-u)));var l=r.charAt(64);if(l)for(;o.length%4;)o.push(l);return o.join("")},parse:function(e){var n=e.length,r=this._map,o=this._reverseMap;if(!o){o=this._reverseMap=[];for(var i=0;i<r.length;i++)o[r.charCodeAt(i)]=i}var s=r.charAt(64);if(s){var a=e.indexOf(s);-1!==a&&(n=a)}return t(e,n,o)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),e.enc.Base64}(n(0))},function(e,t,n){e.exports=function(e){return function(t){function n(e,t,n,r,o,i,s){var a=e+(t&n|~t&r)+o+s;return(a<<i|a>>>32-i)+t}function r(e,t,n,r,o,i,s){var a=e+(t&r|n&~r)+o+s;return(a<<i|a>>>32-i)+t}function o(e,t,n,r,o,i,s){var a=e+(t^n^r)+o+s;return(a<<i|a>>>32-i)+t}function i(e,t,n,r,o,i,s){var a=e+(n^(t|~r))+o+s;return(a<<i|a>>>32-i)+t}var s=e,a=s.lib,c=a.WordArray,u=a.Hasher,l=s.algo,h=[];!function(){for(var e=0;64>e;e++)h[e]=0|4294967296*t.abs(t.sin(e+1))}();var p=l.MD5=u.extend({_doReset:function(){this._hash=new c.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(e,t){for(var s=0;16>s;s++){var a=t+s,c=e[a];e[a]=16711935&(c<<8|c>>>24)|4278255360&(c<<24|c>>>8)}var u=this._hash.words,l=e[t+0],p=e[t+1],d=e[t+2],f=e[t+3],_=e[t+4],m=e[t+5],g=e[t+6],y=e[t+7],v=e[t+8],E=e[t+9],b=e[t+10],N=e[t+11],S=e[t+12],T=e[t+13],O=e[t+14],x=e[t+15],I=u[0],C=u[1],R=u[2],A=u[3];I=n(I,C,R,A,l,7,h[0]),A=n(A,I,C,R,p,12,h[1]),R=n(R,A,I,C,d,17,h[2]),C=n(C,R,A,I,f,22,h[3]),I=n(I,C,R,A,_,7,h[4]),A=n(A,I,C,R,m,12,h[5]),R=n(R,A,I,C,g,17,h[6]),C=n(C,R,A,I,y,22,h[7]),I=n(I,C,R,A,v,7,h[8]),A=n(A,I,C,R,E,12,h[9]),R=n(R,A,I,C,b,17,h[10]),C=n(C,R,A,I,N,22,h[11]),I=n(I,C,R,A,S,7,h[12]),A=n(A,I,C,R,T,12,h[13]),R=n(R,A,I,C,O,17,h[14]),C=n(C,R,A,I,x,22,h[15]),I=r(I,C,R,A,p,5,h[16]),A=r(A,I,C,R,g,9,h[17]),R=r(R,A,I,C,N,14,h[18]),C=r(C,R,A,I,l,20,h[19]),I=r(I,C,R,A,m,5,h[20]),A=r(A,I,C,R,b,9,h[21]),R=r(R,A,I,C,x,14,h[22]),C=r(C,R,A,I,_,20,h[23]),I=r(I,C,R,A,E,5,h[24]),A=r(A,I,C,R,O,9,h[25]),R=r(R,A,I,C,f,14,h[26]),C=r(C,R,A,I,v,20,h[27]),I=r(I,C,R,A,T,5,h[28]),A=r(A,I,C,R,d,9,h[29]),R=r(R,A,I,C,y,14,h[30]),C=r(C,R,A,I,S,20,h[31]),I=o(I,C,R,A,m,4,h[32]),A=o(A,I,C,R,v,11,h[33]),R=o(R,A,I,C,N,16,h[34]),C=o(C,R,A,I,O,23,h[35]),I=o(I,C,R,A,p,4,h[36]),A=o(A,I,C,R,_,11,h[37]),R=o(R,A,I,C,y,16,h[38]),C=o(C,R,A,I,b,23,h[39]),I=o(I,C,R,A,T,4,h[40]),A=o(A,I,C,R,l,11,h[41]),R=o(R,A,I,C,f,16,h[42]),C=o(C,R,A,I,g,23,h[43]),I=o(I,C,R,A,E,4,h[44]),A=o(A,I,C,R,S,11,h[45]),R=o(R,A,I,C,x,16,h[46]),C=o(C,R,A,I,d,23,h[47]),I=i(I,C,R,A,l,6,h[48]),A=i(A,I,C,R,y,10,h[49]),R=i(R,A,I,C,O,15,h[50]),C=i(C,R,A,I,m,21,h[51]),I=i(I,C,R,A,S,6,h[52]),A=i(A,I,C,R,f,10,h[53]),R=i(R,A,I,C,b,15,h[54]),C=i(C,R,A,I,p,21,h[55]),I=i(I,C,R,A,v,6,h[56]),A=i(A,I,C,R,x,10,h[57]),R=i(R,A,I,C,g,15,h[58]),C=i(C,R,A,I,T,21,h[59]),I=i(I,C,R,A,_,6,h[60]),A=i(A,I,C,R,N,10,h[61]),R=i(R,A,I,C,d,15,h[62]),C=i(C,R,A,I,E,21,h[63]),u[0]=0|u[0]+I,u[1]=0|u[1]+C,u[2]=0|u[2]+R,u[3]=0|u[3]+A},_doFinalize:function(){var e=this._data,n=e.words,r=8*this._nDataBytes,o=8*e.sigBytes;n[o>>>5]|=128<<24-o%32;var i=t.floor(r/4294967296),s=r;n[15+(o+64>>>9<<4)]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8),n[14+(o+64>>>9<<4)]=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),e.sigBytes=4*(n.length+1),this._process();for(var a,c=this._hash,u=c.words,l=0;4>l;l++)a=u[l],u[l]=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8);return c},clone:function(){var e=u.clone.call(this);return e._hash=this._hash.clone(),e}});s.MD5=u._createHelper(p),s.HmacMD5=u._createHmacHelper(p)}(Math),e.MD5}(n(0))},function(e,t,n){e.exports=function(e){return n=(t=e).lib,r=n.Base,o=n.WordArray,(i=t.x64={}).Word=r.extend({init:function(e,t){this.high=e,this.low=t}}),i.WordArray=r.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null==t?8*e.length:t},toX32:function(){for(var e,t=this.words,n=t.length,r=[],i=0;i<n;i++)e=t[i],r.push(e.high),r.push(e.low);return o.create(r,this.sigBytes)},clone:function(){for(var e=r.clone.call(this),t=e.words=this.words.slice(0),n=t.length,o=0;o<n;o++)t[o]=t[o].clone();return e}}),e;var t,n,r,o,i}(n(0))},function(e,t,n){e.exports=function(e){return n=(t=e).lib,r=n.WordArray,o=n.Hasher,i=t.algo,s=[],a=i.SHA1=o.extend({_doReset:function(){this._hash=new r.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var n=this._hash.words,r=n[0],o=n[1],i=n[2],a=n[3],c=n[4],u=0;80>u;u++){if(16>u)s[u]=0|e[t+u];else{var l=s[u-3]^s[u-8]^s[u-14]^s[u-16];s[u]=l<<1|l>>>31}var h=(r<<5|r>>>27)+c+s[u];h+=20>u?1518500249+(o&i|~o&a):40>u?1859775393+(o^i^a):60>u?(o&i|o&a|i&a)-1894007588:(o^i^a)-899497514,c=a,a=i,i=o<<30|o>>>2,o=r,r=h}n[0]=0|n[0]+r,n[1]=0|n[1]+o,n[2]=0|n[2]+i,n[3]=0|n[3]+a,n[4]=0|n[4]+c},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,r=8*e.sigBytes;return t[r>>>5]|=128<<24-r%32,t[14+(r+64>>>9<<4)]=Math.floor(n/4294967296),t[15+(r+64>>>9<<4)]=n,e.sigBytes=4*t.length,this._process(),this._hash},clone:function(){var e=o.clone.call(this);return e._hash=this._hash.clone(),e}}),t.SHA1=o._createHelper(a),t.HmacSHA1=o._createHmacHelper(a),e.SHA1;var t,n,r,o,i,s,a}(n(0))},function(e,t,n){e.exports=function(e){var t,n,r,o,i;n=(t=e).lib,r=n.Base,o=t.enc,i=o.Utf8,t.algo.HMAC=r.extend({init:function(e,t){e=this._hasher=new e.init,"string"==typeof t&&(t=i.parse(t));var n=e.blockSize,r=4*n;t.sigBytes>r&&(t=e.finalize(t)),t.clamp();for(var o=this._oKey=t.clone(),s=this._iKey=t.clone(),a=o.words,c=s.words,u=0;u<n;u++)a[u]^=1549556828,c[u]^=909522486;o.sigBytes=s.sigBytes=r,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher,n=t.finalize(e);t.reset();var r=t.finalize(this._oKey.clone().concat(n));return r}})}(n(0))},function(e,t){t.code={WEBIM_CONNCTION_USER_NOT_ASSIGN_ERROR:0,WEBIM_CONNCTION_OPEN_ERROR:1,WEBIM_CONNCTION_AUTH_ERROR:2,WEBIM_CONNCTION_OPEN_USERGRID_ERROR:3,WEBIM_CONNCTION_ATTACH_ERROR:4,WEBIM_CONNCTION_ATTACH_USERGRID_ERROR:5,WEBIM_CONNCTION_REOPEN_ERROR:6,WEBIM_CONNCTION_SERVER_CLOSE_ERROR:7,WEBIM_CONNCTION_SERVER_ERROR:8,WEBIM_CONNCTION_IQ_ERROR:9,WEBIM_CONNCTION_PING_ERROR:10,WEBIM_CONNCTION_NOTIFYVERSION_ERROR:11,WEBIM_CONNCTION_GETROSTER_ERROR:12,WEBIM_CONNCTION_CROSSDOMAIN_ERROR:13,WEBIM_CONNCTION_LISTENING_OUTOF_MAXRETRIES:14,WEBIM_CONNCTION_RECEIVEMSG_CONTENTERROR:15,WEBIM_CONNCTION_DISCONNECTED:16,WEBIM_CONNCTION_AJAX_ERROR:17,WEBIM_CONNCTION_JOINROOM_ERROR:18,WEBIM_CONNCTION_GETROOM_ERROR:19,WEBIM_CONNCTION_GETROOMINFO_ERROR:20,WEBIM_CONNCTION_GETROOMMEMBER_ERROR:21,WEBIM_CONNCTION_GETROOMOCCUPANTS_ERROR:22,WEBIM_CONNCTION_LOAD_CHATROOM_ERROR:23,WEBIM_CONNCTION_NOT_SUPPORT_CHATROOM_ERROR:24,WEBIM_CONNCTION_JOINCHATROOM_ERROR:25,WEBIM_CONNCTION_QUITCHATROOM_ERROR:26,WEBIM_CONNCTION_APPKEY_NOT_ASSIGN_ERROR:27,WEBIM_CONNCTION_TOKEN_NOT_ASSIGN_ERROR:28,WEBIM_CONNCTION_SESSIONID_NOT_ASSIGN_ERROR:29,WEBIM_CONNCTION_RID_NOT_ASSIGN_ERROR:30,WEBIM_CONNCTION_CALLBACK_INNER_ERROR:31,WEBIM_CONNCTION_CLIENT_OFFLINE:32,WEBIM_CONNCTION_CLIENT_LOGOUT:33,WEBIM_CONNCTION_CLIENT_TOO_MUCH_ERROR:34,WEBIM_CONNECTION_ACCEPT_INVITATION_FROM_GROUP:35,WEBIM_CONNECTION_DECLINE_INVITATION_FROM_GROUP:36,WEBIM_CONNECTION_ACCEPT_JOIN_GROUP:37,WEBIM_CONNECTION_DECLINE_JOIN_GROUP:38,WEBIM_CONNECTION_CLOSED:39,WEBIM_UPLOADFILE_BROWSER_ERROR:100,WEBIM_UPLOADFILE_ERROR:101,WEBIM_UPLOADFILE_NO_LOGIN:102,WEBIM_UPLOADFILE_NO_FILE:103,WEBIM_DOWNLOADFILE_ERROR:200,WEBIM_DOWNLOADFILE_NO_LOGIN:201,WEBIM_DOWNLOADFILE_BROWSER_ERROR:202,WEBIM_MESSAGE_REC_TEXT:300,WEBIM_MESSAGE_REC_TEXT_ERROR:301,WEBIM_MESSAGE_REC_EMOTION:302,WEBIM_MESSAGE_REC_PHOTO:303,WEBIM_MESSAGE_REC_AUDIO:304,WEBIM_MESSAGE_REC_AUDIO_FILE:305,WEBIM_MESSAGE_REC_VEDIO:306,WEBIM_MESSAGE_REC_VEDIO_FILE:307,WEBIM_MESSAGE_REC_FILE:308,WEBIM_MESSAGE_SED_TEXT:309,WEBIM_MESSAGE_SED_EMOTION:310,WEBIM_MESSAGE_SED_PHOTO:311,WEBIM_MESSAGE_SED_AUDIO:312,WEBIM_MESSAGE_SED_AUDIO_FILE:313,WEBIM_MESSAGE_SED_VEDIO:314,WEBIM_MESSAGE_SED_VEDIO_FILE:315,WEBIM_MESSAGE_SED_FILE:316,WEBIM_MESSAGE_SED_ERROR:317,STATUS_INIT:400,STATUS_DOLOGIN_USERGRID:401,STATUS_DOLOGIN_IM:402,STATUS_OPENED:403,STATUS_CLOSING:404,STATUS_CLOSED:405,STATUS_ERROR:406}},function(e,t,n){"use strict";n.r(t),n.d(t,"utils",function(){return d});var r=function(){},o=n(8).code,i=function(e){e=e||!0;var t=function(){try{return new window.XMLHttpRequest}catch(e){return!1}}()||function(){try{return new window.ActiveXObject("Microsoft.XMLHTTP")}catch(e){return!1}}();if("withCredentials"in t)return t;if(!e)return t;if(void 0===window.XDomainRequest)return t;var n=new XDomainRequest;return n.readyState=0,n.status=100,n.onreadystatechange=r,n.onload=function(){n.readyState=4,n.status=200;var e=new ActiveXObject("Microsoft.XMLDOM");e.async="false",e.loadXML(n.responseText),n.responseXML=e,n.response=n.responseText,n.onreadystatechange()},n.ontimeout=n.onerror=function(){n.readyState=4,n.status=500,n.onreadystatechange()},n},s=function(){if("ActiveXObject"in window)try{return new ActiveXObject("ShockwaveFlash.ShockwaveFlash")}catch(e){return 0}else if(navigator.plugins&&0<navigator.plugins.length)return navigator.plugins["Shockwave Flash"];return 0}(),a=i(),c="undefined"!=typeof FormData,u="undefined"!=typeof Blob,l=a.setRequestHeader||!1,h=a.overrideMimeType||!1,p=l&&c;Object.keys||(Object.keys=function(){var e=Object.prototype.hasOwnProperty,t=!{toString:null}.propertyIsEnumerable("toString"),n=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],r=n.length;return function(o){if("object"!=typeof o&&("function"!=typeof o||null===o))throw new TypeError("Object.keys called on non-object");var i,s,a=[];for(i in o)e.call(o,i)&&a.push(i);if(t)for(s=0;s<r;s++)e.call(o,n[s])&&a.push(n[s]);return a}}());const d={hasFormData:c,hasBlob:u,emptyfn:r,isCanSetRequestHeader:l,hasOverrideMimeType:h,isCanUploadFileAsync:p,isCanUploadFile:p||s,isCanDownLoadFile:l&&(u||h),isSupportWss:function(){var e=[/MQQBrowser[\/]5([.]\d+)?\sTBS/];if(!window.WebSocket)return!1;for(var t=window.navigator.userAgent,n=0,r=e.length;n<r;n++)if(e[n].test(t))return!1;return!0}(),getIEVersion:function(){var e,t=navigator.userAgent;return(e=t.match(/MSIE (\d+)/i))&&e[1]?+e[1]:(e=t.match(/Trident\/(\d+)/i))&&e[1]&&{4:8,5:9,6:10,7:11}[e[1]]||null}(),stringify:function(e){if("undefined"!=typeof JSON&&JSON.stringify)return JSON.stringify(e);var t="",n=[],r=function(e){var o=!1;for(var i in"[object Array]"===Object.prototype.toString.call(e)?(n.push("]","["),o=!0):"[object Object]"===Object.prototype.toString.call(e)&&n.push("}","{"),e)"[object Null]"===Object.prototype.toString.call(e[i])?e[i]="null":"[object Undefined]"===Object.prototype.toString.call(e[i])&&(e[i]="undefined"),t+=e[i]&&"object"==typeof e[i]?","+(o?"":'"'+i+'":'+(o?'"':""))+r(e[i]):',"'+(o?"":i+'":"')+e[i]+'"';return""!=t&&(t=t.slice(1)),n.pop()+t+n.pop()};return r(e)},login:function(e){var t=(e=e||{}).success||r,n=e.error||r,i=(e.appKey||"").split("#");if(2!==i.length)return n({type:o.WEBIM_CONNCTION_APPKEY_NOT_ASSIGN_ERROR}),!1;var s=i[0],a=i[1],c=c||e.https,u=e.user||"",l=e.pwd||"",h=e.apiUrl,p={grant_type:"password",username:u,password:l,timestamp:+new Date};e={url:h+"/"+s+"/"+a+"/token",dataType:"json",data:d.stringify(p),success:t,error:n};return d.ajax(e)},getFileUrl:function(e){var t={url:"",filename:"",filetype:"",data:""},n="string"==typeof e?document.getElementById(e):e;if(!d.isCanUploadFileAsync||!n)return t;try{if(window.URL.createObjectURL){var r=n.files;if(0<r.length){var o=r.item(0);t.data=o,t.url=window.URL.createObjectURL(o),t.filename=o.name||""}}else{o=document.getElementById(e).value;t.url=o;var i=o.lastIndexOf("/"),s=o.lastIndexOf("\\"),a=Math.max(i,s);t.filename=0>a?o:o.substring(a+1)}var c=t.filename.lastIndexOf(".");return-1!=c&&(t.filetype=t.filename.substring(c+1).toLowerCase()),t}catch(t){throw t}},getFileSize:function(e){var t=this.getFileLength(e);if(1e7<t)return!1;var n=Math.round(t/1e3);if(1e3>n)t=n+" KB";else if(1e3<=n){var r=n/1e3;t=1e3>r?r.toFixed(1)+" MB":(r/1e3).toFixed(1)+" GB"}return t},getFileLength:function(e){var t=0;if(e)if(e.files)0<e.files.length&&(t=e.files[0].size);else if(e.select&&"ActiveXObject"in window){e.select(),t=(e=new ActiveXObject("Scripting.FileSystemObject").GetFile(e.value)).Size}return t},hasFlash:s,trim:function(e){return(e="string"==typeof e?e:"").trim?e.trim():e.replace(/^\s|\s$/g,"")},parseEmoji:function(e){if(void 0===WebIM.Emoji||void 0===WebIM.Emoji.map)return e;var t=WebIM.Emoji;for(var n in t.map)if(t.map.hasOwnProperty(n))for(;-1<e.indexOf(n);)e=e.replace(n,'<img class="emoji" src="'+t.path+t.map[n]+'" />');return e},parseLink:function(e){return e=e.replace(/(https?\:\/\/|www\.)([a-zA-Z0-9-]+(\.[a-zA-Z0-9]+)+)(\:[0-9]{2,4})?\/?((\.[:_0-9a-zA-Z-]+)|[:_0-9a-zA-Z-]*\/?)*\??[:_#@*&%0-9a-zA-Z-\/=]*/gm,function(e){return"<a href='"+(/^https?/gm.test(e)?e:"//"+e)+"' target='_blank'>"+e+"</a>"})},parseJSON:function(e){if(window.JSON&&window.JSON.parse)return window.JSON.parse(e+"");var t,n=null,r=d.trim(e+"");return r&&!d.trim(r.replace(/(,)|(\[|{)|(}|])|"(?:[^"\\\r\n]|\\["\\\/bfnrt]|\\u[\da-fA-F]{4})*"\s*:?|true|false|null|-?(?!0\d)\d+(?:\.\d+|)(?:[eE][+-]?\d+|)/g,function(e,r,o,i){return t&&r&&(n=0),0===n?e:(t=o||r,n+=!i-!o,"")}))?Function("return "+r)():Function("Invalid JSON: "+e)()},parseUploadResponse:function(e){return-1<e.indexOf("callback")?e.slice(9,-1):e},parseDownloadResponse:function(e){return e&&e.type&&"application/json"===e.type||0>Object.prototype.toString.call(e).indexOf("Blob")?this.url+"?token=":window.URL.createObjectURL(e)},uploadFile:function(e){(e=e||{}).onFileUploadProgress=e.onFileUploadProgress||r,e.onFileUploadComplete=e.onFileUploadComplete||r,e.onFileUploadError=e.onFileUploadError||r,e.onFileUploadCanceled=e.onFileUploadCanceled||r;var t=e.accessToken||this.context.accessToken;if(t){var n,i,s,a=e.appKey||this.context.appKey||"";if(a&&(n=(s=a.split("#"))[0],i=s[1]),n||i){var c=e.apiUrl+"/"+n+"/"+i+"/chatfiles";if(d.isCanUploadFileAsync){var u=e.file.data?e.file.data.size:void 0;if(u>10485760)e.onFileUploadError({type:o.WEBIM_UPLOADFILE_ERROR,id:e.id});else if(0>=u)e.onFileUploadError({type:o.WEBIM_UPLOADFILE_ERROR,id:e.id});else{var l=d.xmlrequest();l.upload&&l.upload.addEventListener("progress",e.onFileUploadProgress,!1),l.addEventListener?(l.addEventListener("abort",e.onFileUploadCanceled,!1),l.addEventListener("load",function(){try{var t=d.parseJSON(l.responseText);try{e.onFileUploadComplete(t)}catch(t){e.onFileUploadError({type:o.WEBIM_CONNCTION_CALLBACK_INNER_ERROR,data:t})}}catch(t){e.onFileUploadError({type:o.WEBIM_UPLOADFILE_ERROR,data:l.responseText,id:e.id,xhr:l})}},!1),l.addEventListener("error",function(){e.onFileUploadError({type:o.WEBIM_UPLOADFILE_ERROR,id:e.id,xhr:l})},!1)):l.onreadystatechange&&(l.onreadystatechange=function(){if(4!==l.readyState)l.abort(),e.onFileUploadCanceled();else if(200===ajax.status)try{var t=d.parseJSON(l.responseText);e.onFileUploadComplete(t)}catch(t){e.onFileUploadError({type:o.WEBIM_UPLOADFILE_ERROR,data:l.responseText,id:e.id,xhr:l})}else e.onFileUploadError({type:o.WEBIM_UPLOADFILE_ERROR,data:l.responseText,id:e.id,xhr:l})}),l.open("POST",c),l.setRequestHeader("restrict-access","true"),l.setRequestHeader("Accept","*/*"),l.setRequestHeader("Authorization","Bearer "+t);var h=new FormData;h.append("file",e.file.data),window.XDomainRequest&&(l.readyState=2),l.send(h)}}else d.hasFlash&&"function"==typeof e.flashUpload?e.flashUpload&&e.flashUpload(c,e):e.onFileUploadError({type:o.WEBIM_UPLOADFILE_BROWSER_ERROR,id:e.id})}else e.onFileUploadError({type:o.WEBIM_UPLOADFILE_ERROR,id:e.id})}else e.onFileUploadError({type:o.WEBIM_UPLOADFILE_NO_LOGIN,id:e.id})},download:function(e){e.onFileDownloadComplete=e.onFileDownloadComplete||r,e.onFileDownloadError=e.onFileDownloadError||r;var t=e.accessToken||this.context.accessToken;if(t)if(d.isCanDownLoadFile){var n=d.xmlrequest();"addEventListener"in n?(n.addEventListener("load",function(){e.onFileDownloadComplete(n.response,n)},!1),n.addEventListener("error",function(){e.onFileDownloadError({type:o.WEBIM_DOWNLOADFILE_ERROR,id:e.id,xhr:n})},!1)):"onreadystatechange"in n&&(n.onreadystatechange=function(){4===n.readyState?200===ajax.status?e.onFileDownloadComplete(n.response,n):e.onFileDownloadError({type:o.WEBIM_DOWNLOADFILE_ERROR,id:e.id,xhr:n}):(n.abort(),e.onFileDownloadError({type:o.WEBIM_DOWNLOADFILE_ERROR,id:e.id,xhr:n}))});var i=e.method||"GET",s=e.responseType||"blob",a=e.mimeType||"text/plain; charset=x-user-defined";n.open(i,e.url),"undefined"==typeof Blob?n.overrideMimeType(a):n.responseType=s;var c={"X-Requested-With":"XMLHttpRequest",Accept:"application/octet-stream","share-secret":e.secret,Authorization:"Bearer "+t},u=e.headers||{};for(var l in u)c[l]=u[l];for(var l in c)c[l]&&n.setRequestHeader(l,c[l]);window.XDomainRequest&&(n.readyState=2),n.send(null)}else e.onFileDownloadComplete();else e.onFileDownloadError({type:o.WEBIM_DOWNLOADFILE_NO_LOGIN,id:e.id})},parseTextMessage:function(e,t){if("string"==typeof e){if("[object Object]"!==Object.prototype.toString.call(t))return{isemoji:!1,body:[{type:"txt",data:e}]};var n=e,r=[],o=n.match(/\[[^[\]]{2,3}\]/gm);if(!o||1>o.length)return{isemoji:!1,body:[{type:"txt",data:e}]};for(var i=!1,s=0;s<o.length;s++){var a=n.substring(0,n.indexOf(o[s])),c=WebIM.Emoji.map[o[s]];if(a&&r.push({type:"txt",data:a}),c){var u=WebIM.Emoji.map?WebIM.Emoji.path+c:null;u?(i=!0,r.push({type:"emoji",data:u})):r.push({type:"txt",data:o[s]});var l=n.indexOf(o[s])+o[s].length;n=n.substring(l)}else r.push({type:"txt",data:o[s]})}return n&&r.push({type:"txt",data:n}),i?{isemoji:i,body:r}:{isemoji:!1,body:[{type:"txt",data:e}]}}},parseUri:function(){var e={};if(window.location.search){var t=window.location.search.match(/([^\?|&])\w+=([^&]+)/g);for(var n in t){var r=t[n],o=r.indexOf("="),i=r.substr(0,o),s=r.substr(o+1);e[i]=s}}return e},parseHrefHash:function(){var e={};if(window.location.hash){var t=window.location.hash.match(/([^\#|&])\w+=([^&]+)/g);for(var n in t){var r=t[n],o=r.indexOf("="),i=r.substr(0,o),s=r.substr(o+1);e[i]=s}}return e},xmlrequest:i,getXmlFirstChild:function(e,t){var n=e.getElementsByTagName(t);return 0==n.length?null:n[0]},ajax:function(e){var t=e.dataType||"text",n=e.success||r,i=e.error||r,s=d.xmlrequest();s.onreadystatechange=function(){if(4!==s.readyState)0===s.readyState&&i({type:o.WEBIM_CONNCTION_AJAX_ERROR,data:s.responseText});else{if(200===(s.status||0)){try{switch(t){case"text":return void n(s.responseText);case"json":var e=d.parseJSON(s.responseText);return void n(e,s);case"xml":return void(s.responseXML&&s.responseXML.documentElement?n(s.responseXML.documentElement,s):i({type:o.WEBIM_CONNCTION_AJAX_ERROR,data:s.responseText}))}n(s.response||s.responseText,s)}catch(e){i({type:o.WEBIM_CONNCTION_AJAX_ERROR,data:e})}return}i({type:o.WEBIM_CONNCTION_AJAX_ERROR,data:s.responseText})}},e.responseType&&s.responseType&&(s.responseType=e.responseType),e.mimeType&&d.hasOverrideMimeType&&s.overrideMimeType(e.mimeType);var a=e.type||"POST",c=e.data||null,u="";if("get"===a.toLowerCase()&&c){for(var l in c)c.hasOwnProperty(l)&&(u+=l+"="+c[l]+"&");u=u?u.slice(0,-1):u,e.url+=(0<e.url.indexOf("?")?"&":"?")+(u?u+"&":u)+"_v="+(new Date).getTime(),c=null,u=null}if(s.open(a,e.url,d.isCanSetRequestHeader),d.isCanSetRequestHeader){var h=e.headers||{};for(var p in h)h.hasOwnProperty(p)&&s.setRequestHeader(p,h[p])}return window.XDomainRequest&&(s.readyState=2),s.send(c),s},ts:function(){var e=new Date,t=e.getHours(),n=e.getMinutes(),r=e.getSeconds();return(10>t?"0"+t:t)+":"+(10>n?"0"+n:n)+":"+(10>r?"0"+r:r)+":"+e.getMilliseconds()+" "},getObjectKey:function(e,t){for(var n in e)if(e[n]==t)return n;return""},sprintf:function(){var e,t,n=arguments,r=n[0]||"";for(e=1,t=n.length;e<t;e++)r=r.replace(/%s/,n[e]);return r},setCookie:function(e,t,n){var r=e+"="+encodeURIComponent(t);"number"==typeof n&&(r+="; max-age: "+60*n*60*24),document.cookie=r},getCookie:function(){var e={},t=document.cookie;if(""===t)return e;for(var n=t.split("; "),r=0;r<n.length;r++){var o=n[r],i=o.indexOf("="),s=o.substring(0,i),a=o.substring(i+1);a=decodeURIComponent(a),e[s]=a}return e}}},function(e,t,n){e.exports=function(e){return e}(n(0),n(5),n(17),n(18),n(3),n(4),n(6),n(11),n(19),n(12),n(20),n(21),n(22),n(7),n(23),n(2),n(1),n(24),n(25),n(26),n(27),n(28),n(29),n(30),n(31),n(32),n(33),n(34),n(35),n(36),n(37),n(38),n(39))},function(e,t,n){var r,o=Math.pow;r=function(e){return function(t){var n=e,r=n.lib,i=r.WordArray,s=r.Hasher,a=n.algo,c=[],u=[];!function(){function e(e){for(var n=t.sqrt(e),r=2;r<=n;r++)if(!(e%r))return!1;return!0}function n(e){return 0|4294967296*(e-(0|e))}for(var r=2,i=0;64>i;)e(r)&&(8>i&&(c[i]=n(o(r,.5))),u[i]=n(o(r,1/3)),i++),r++}();var l=[],h=a.SHA256=s.extend({_doReset:function(){this._hash=new i.init(c.slice(0))},_doProcessBlock:function(e,t){for(var n=this._hash.words,r=n[0],o=n[1],i=n[2],s=n[3],a=n[4],c=n[5],h=n[6],p=n[7],d=0;64>d;d++){if(16>d)l[d]=0|e[t+d];else{var f=l[d-15],_=l[d-2];l[d]=((f<<25|f>>>7)^(f<<14|f>>>18)^f>>>3)+l[d-7]+((_<<15|_>>>17)^(_<<13|_>>>19)^_>>>10)+l[d-16]}var m=r&o^r&i^o&i,g=(r<<30|r>>>2)^(r<<19|r>>>13)^(r<<10|r>>>22),y=p+((a<<26|a>>>6)^(a<<21|a>>>11)^(a<<7|a>>>25))+(a&c^~a&h)+u[d]+l[d];p=h,h=c,c=a,a=0|s+y,s=i,i=o,o=r,r=0|y+(g+m)}n[0]=0|n[0]+r,n[1]=0|n[1]+o,n[2]=0|n[2]+i,n[3]=0|n[3]+s,n[4]=0|n[4]+a,n[5]=0|n[5]+c,n[6]=0|n[6]+h,n[7]=0|n[7]+p},_doFinalize:function(){var e=this._data,n=e.words,r=8*this._nDataBytes,o=8*e.sigBytes;return n[o>>>5]|=128<<24-o%32,n[14+(o+64>>>9<<4)]=t.floor(r/4294967296),n[15+(o+64>>>9<<4)]=r,e.sigBytes=4*n.length,this._process(),this._hash},clone:function(){var e=s.clone.call(this);return e._hash=this._hash.clone(),e}});n.SHA256=s._createHelper(h),n.HmacSHA256=s._createHmacHelper(h)}(Math),e.SHA256},e.exports=r(n(0))},function(e,t,n){e.exports=function(e){return function(){function t(){return s.create.apply(s,arguments)}var n=e,r=n.lib,o=r.Hasher,i=n.x64,s=i.Word,a=i.WordArray,c=n.algo,u=[t(1116352408,3609767458),t(1899447441,602891725),t(3049323471,3964484399),t(3921009573,2173295548),t(961987163,4081628472),t(1508970993,3053834265),t(2453635748,2937671579),t(2870763221,3664609560),t(3624381080,2734883394),t(310598401,1164996542),t(607225278,1323610764),t(1426881987,3590304994),t(1925078388,4068182383),t(2162078206,991336113),t(2614888103,633803317),t(3248222580,3479774868),t(3835390401,2666613458),t(4022224774,944711139),t(264347078,2341262773),t(604807628,2007800933),t(770255983,1495990901),t(1249150122,1856431235),t(1555081692,3175218132),t(1996064986,2198950837),t(2554220882,3999719339),t(2821834349,766784016),t(2952996808,2566594879),t(3210313671,3203337956),t(3336571891,1034457026),t(3584528711,2466948901),t(113926993,3758326383),t(338241895,168717936),t(666307205,1188179964),t(773529912,1546045734),t(1294757372,1522805485),t(1396182291,2643833823),t(1695183700,2343527390),t(1986661051,1014477480),t(2177026350,1206759142),t(2456956037,344077627),t(2730485921,1290863460),t(2820302411,3158454273),t(3259730800,3505952657),t(3345764771,106217008),t(3516065817,3606008344),t(3600352804,1432725776),t(4094571909,1467031594),t(275423344,851169720),t(430227734,3100823752),t(506948616,1363258195),t(659060556,3750685593),t(883997877,3785050280),t(958139571,3318307427),t(1322822218,3812723403),t(1537002063,2003034995),t(1747873779,3602036899),t(1955562222,1575990012),t(2024104815,1125592928),t(2227730452,2716904306),t(2361852424,442776044),t(2428436474,593698344),t(2756734187,3733110249),t(3204031479,2999351573),t(3329325298,3815920427),t(3391569614,3928383900),t(3515267271,566280711),t(3940187606,3454069534),t(4118630271,4000239992),t(116418474,1914138554),t(174292421,2731055270),t(289380356,3203993006),t(460393269,320620315),t(685471733,587496836),t(852142971,1086792851),t(1017036298,365543100),t(1126000580,2618297676),t(1288033470,3409855158),t(1501505948,4234509866),t(1607167915,987167468),t(1816402316,1246189591)],l=[];!function(){for(var e=0;80>e;e++)l[e]=t()}();var h=c.SHA512=o.extend({_doReset:function(){this._hash=new a.init([new s.init(1779033703,4089235720),new s.init(3144134277,2227873595),new s.init(1013904242,4271175723),new s.init(2773480762,1595750129),new s.init(1359893119,2917565137),new s.init(2600822924,725511199),new s.init(528734635,4215389547),new s.init(1541459225,327033209)])},_doProcessBlock:function(e,t){for(var n,r=this._hash.words,o=r[0],i=r[1],s=r[2],a=r[3],c=r[4],h=r[5],p=r[6],d=r[7],f=o.high,_=o.low,m=i.high,g=i.low,y=s.high,v=s.low,E=a.high,b=a.low,N=c.high,S=c.low,T=h.high,O=h.low,x=p.high,I=p.low,C=d.high,R=d.low,A=f,M=_,w=m,B=g,k=y,D=v,j=E,L=b,F=N,H=S,U=T,W=O,q=x,G=I,P=C,J=R,z=0;80>z;z++){if(n=l[z],16>z)var X=n.high=0|e[t+2*z],$=n.low=0|e[t+2*z+1];else{var K=l[z-15],Q=K.high,V=K.low,Y=(V>>>1|Q<<31)^(V>>>8|Q<<24)^(V>>>7|Q<<25),Z=l[z-2],ee=Z.high,te=Z.low,ne=(te>>>19|ee<<13)^(te<<3|ee>>>29)^(te>>>6|ee<<26),re=l[z-7],oe=re.high,ie=re.low,se=l[z-16],ae=se.high,ce=se.low,$=Y+ie,X=((Q>>>1|V<<31)^(Q>>>8|V<<24)^Q>>>7)+oe+($>>>0<Y>>>0?1:0),$=$+ne,X=X+((ee>>>19|te<<13)^(ee<<3|te>>>29)^ee>>>6)+($>>>0<ne>>>0?1:0),$=$+ce,X=X+ae+($>>>0<ce>>>0?1:0);n.high=X,n.low=$}var ue=F&U^~F&q,le=H&W^~H&G,he=A&w^A&k^w&k,pe=M&B^M&D^B&D,de=(A>>>28|M<<4)^(A<<30|M>>>2)^(A<<25|M>>>7),fe=(M>>>28|A<<4)^(M<<30|A>>>2)^(M<<25|A>>>7),_e=(F>>>14|H<<18)^(F>>>18|H<<14)^(F<<23|H>>>9),me=(H>>>14|F<<18)^(H>>>18|F<<14)^(H<<23|F>>>9),ge=u[z],ye=ge.high,ve=ge.low,Ee=J+me,be=P+_e+(Ee>>>0<J>>>0?1:0),Ee=Ee+le,be=be+ue+(Ee>>>0<le>>>0?1:0),Ee=Ee+ve,be=be+ye+(Ee>>>0<ve>>>0?1:0),Ee=Ee+$,be=be+X+(Ee>>>0<$>>>0?1:0),Ne=fe+pe,Se=de+he+(Ne>>>0<fe>>>0?1:0);P=q,J=G,q=U,G=W,U=F,W=H,F=0|j+be+((H=0|L+Ee)>>>0<L>>>0?1:0),j=k,L=D,k=w,D=B,w=A,B=M,A=0|be+Se+((M=0|Ee+Ne)>>>0<Ee>>>0?1:0)}_=o.low=_+M,o.high=f+A+(_>>>0<M>>>0?1:0),g=i.low=g+B,i.high=m+w+(g>>>0<B>>>0?1:0),v=s.low=v+D,s.high=y+k+(v>>>0<D>>>0?1:0),b=a.low=b+L,a.high=E+j+(b>>>0<L>>>0?1:0),S=c.low=S+H,c.high=N+F+(S>>>0<H>>>0?1:0),O=h.low=O+W,h.high=T+U+(O>>>0<W>>>0?1:0),I=p.low=I+G,p.high=x+q+(I>>>0<G>>>0?1:0),R=d.low=R+J,d.high=C+P+(R>>>0<J>>>0?1:0)},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,r=8*e.sigBytes;t[r>>>5]|=128<<24-r%32,t[30+(r+128>>>10<<5)]=Math.floor(n/4294967296),t[31+(r+128>>>10<<5)]=n,e.sigBytes=4*t.length,this._process();var o=this._hash.toX32();return o},clone:function(){var e=o.clone.call(this);return e._hash=this._hash.clone(),e},blockSize:32});n.SHA512=o._createHelper(h),n.HmacSHA512=o._createHmacHelper(h)}(),e.SHA512}(n(0),n(5))},function(e,t,n){"use strict";function r(e,t){e[t>>5]|=128<<24-t%32,e[15+(t+64>>9<<4)]=t;var n,r,s,u,l,h,p,d,f=Array(80),_=1732584193,m=-271733879,g=-1732584194,y=271733878,v=-1009589776;for(n=0;n<e.length;n+=16){for(u=_,l=m,h=g,p=y,d=v,r=0;80>r;r++)f[r]=16>r?e[n+r]:c(f[r-3]^f[r-8]^f[r-14]^f[r-16],1),s=a(a(c(_,5),o(r,m,g,y)),a(a(v,f[r]),i(r))),v=y,y=g,g=c(m,30),m=_,_=s;_=a(_,u),m=a(m,l),g=a(g,h),y=a(y,p),v=a(v,d)}return[_,m,g,y,v]}function o(e,t,n,r){return 20>e?t&n|~t&r:40>e?t^n^r:60>e?t&n|t&r|n&r:t^n^r}function i(e){return 20>e?1518500249:40>e?1859775393:60>e?-1894007588:-899497514}function s(e,t){var n=u(e);16<n.length&&(n=r(n,8*e.length));for(var o=Array(16),i=Array(16),s=0;16>s;s++)o[s]=909522486^n[s],i[s]=1549556828^n[s];var a=r(o.concat(u(t)),512+8*t.length);return r(i.concat(a),672)}function a(e,t){var n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}function c(e,t){return e<<t|e>>>32-t}function u(e){for(var t=[],n=0;n<8*e.length;n+=8)t[n>>5]|=(255&e.charCodeAt(n/8))<<24-n%32;return t}function l(e){for(var t,n,r="",o=0;o<4*e.length;o+=3)for(t=(255&e[o>>2]>>8*(3-o%4))<<16|(255&e[o+1>>2]>>8*(3-(o+1)%4))<<8|255&e[o+2>>2]>>8*(3-(o+2)%4),n=0;4>n;n++)r+=8*o+6*n>32*e.length?"=":"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(63&t>>6*(3-n));return r}function h(e){for(var t="",n=0;n<32*e.length;n+=8)t+=m(e[n>>5]>>>24-n%32&255);return t}function p(e,t){return new R.Builder(e,t)}function d(e){return new R.Builder("iq",e)}function f(e){return new R.Builder("presence",e)}var _=Math.floor,m=String.fromCharCode;const g=function(e,t){const n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n},y=function(e){if("string"!=typeof e)throw new Error("str2binl was passed a non-string");const t=[];for(let n=0;n<8*e.length;n+=8)t[n>>5]|=(255&e.charCodeAt(n/8))<<n%32;return t},v=function(e,t,n,r,o,i){return g(function(e,t){return e<<t|e>>>32-t}(g(g(t,e),g(r,i)),o),n)},E=function(e,t,n,r,o,i,s){return v(t&n|~t&r,e,t,o,i,s)},b=function(e,t,n,r,o,i,s){return v(t&r|n&~r,e,t,o,i,s)},N=function(e,t,n,r,o,i,s){return v(t^n^r,e,t,o,i,s)},S=function(e,t,n,r,o,i,s){return v(n^(t|~r),e,t,o,i,s)},T=function(e,t){e[t>>5]|=128<<t%32,e[14+(t+64>>>9<<4)]=t;let n,r,o,i,s=1732584193,a=-271733879,c=-1732584194,u=271733878;for(let t=0;t<e.length;t+=16)n=s,r=a,o=c,i=u,s=E(s,a,c,u,e[t+0],7,-680876936),u=E(u,s,a,c,e[t+1],12,-389564586),c=E(c,u,s,a,e[t+2],17,606105819),a=E(a,c,u,s,e[t+3],22,-1044525330),s=E(s,a,c,u,e[t+4],7,-176418897),u=E(u,s,a,c,e[t+5],12,1200080426),c=E(c,u,s,a,e[t+6],17,-1473231341),a=E(a,c,u,s,e[t+7],22,-45705983),s=E(s,a,c,u,e[t+8],7,1770035416),u=E(u,s,a,c,e[t+9],12,-1958414417),c=E(c,u,s,a,e[t+10],17,-42063),a=E(a,c,u,s,e[t+11],22,-1990404162),s=E(s,a,c,u,e[t+12],7,1804603682),u=E(u,s,a,c,e[t+13],12,-40341101),c=E(c,u,s,a,e[t+14],17,-1502002290),a=E(a,c,u,s,e[t+15],22,1236535329),s=b(s,a,c,u,e[t+1],5,-165796510),u=b(u,s,a,c,e[t+6],9,-1069501632),c=b(c,u,s,a,e[t+11],14,643717713),a=b(a,c,u,s,e[t+0],20,-373897302),s=b(s,a,c,u,e[t+5],5,-701558691),u=b(u,s,a,c,e[t+10],9,38016083),c=b(c,u,s,a,e[t+15],14,-660478335),a=b(a,c,u,s,e[t+4],20,-405537848),s=b(s,a,c,u,e[t+9],5,568446438),u=b(u,s,a,c,e[t+14],9,-1019803690),c=b(c,u,s,a,e[t+3],14,-187363961),a=b(a,c,u,s,e[t+8],20,1163531501),s=b(s,a,c,u,e[t+13],5,-1444681467),u=b(u,s,a,c,e[t+2],9,-51403784),c=b(c,u,s,a,e[t+7],14,1735328473),a=b(a,c,u,s,e[t+12],20,-1926607734),s=N(s,a,c,u,e[t+5],4,-378558),u=N(u,s,a,c,e[t+8],11,-2022574463),c=N(c,u,s,a,e[t+11],16,1839030562),a=N(a,c,u,s,e[t+14],23,-35309556),s=N(s,a,c,u,e[t+1],4,-1530992060),u=N(u,s,a,c,e[t+4],11,1272893353),c=N(c,u,s,a,e[t+7],16,-155497632),a=N(a,c,u,s,e[t+10],23,-1094730640),s=N(s,a,c,u,e[t+13],4,681279174),u=N(u,s,a,c,e[t+0],11,-358537222),c=N(c,u,s,a,e[t+3],16,-722521979),a=N(a,c,u,s,e[t+6],23,76029189),s=N(s,a,c,u,e[t+9],4,-640364487),u=N(u,s,a,c,e[t+12],11,-421815835),c=N(c,u,s,a,e[t+15],16,530742520),a=N(a,c,u,s,e[t+2],23,-995338651),s=S(s,a,c,u,e[t+0],6,-198630844),u=S(u,s,a,c,e[t+7],10,1126891415),c=S(c,u,s,a,e[t+14],15,-1416354905),a=S(a,c,u,s,e[t+5],21,-57434055),s=S(s,a,c,u,e[t+12],6,1700485571),u=S(u,s,a,c,e[t+3],10,-1894986606),c=S(c,u,s,a,e[t+10],15,-1051523),a=S(a,c,u,s,e[t+1],21,-2054922799),s=S(s,a,c,u,e[t+8],6,1873313359),u=S(u,s,a,c,e[t+15],10,-30611744),c=S(c,u,s,a,e[t+6],15,-1560198380),a=S(a,c,u,s,e[t+13],21,1309151649),s=S(s,a,c,u,e[t+4],6,-145523070),u=S(u,s,a,c,e[t+11],10,-1120210379),c=S(c,u,s,a,e[t+2],15,718787259),a=S(a,c,u,s,e[t+9],21,-343485551),s=g(s,n),a=g(a,r),c=g(c,o),u=g(u,i);return[s,a,c,u]},O={hexdigest:function(e){return function(e){const t="0123456789abcdef";let n="";for(let r=0;r<4*e.length;r++)n+=t.charAt(15&e[r>>2]>>r%4*8+4)+t.charAt(15&e[r>>2]>>r%4*8);return n}(T(y(e),8*e.length))},hash:function(e){return function(e){let t="";for(let n=0;n<32*e.length;n+=8)t+=m(255&e[n>>5]>>>n%32);return t}(T(y(e),8*e.length))}},x={b64_hmac_sha1:function(e,t){return l(s(e,t))},b64_sha1:function(e){return l(r(u(e),8*e.length))},binb2str:h,core_hmac_sha1:s,str_hmac_sha1:function(e,t){return h(s(e,t))},str_sha1:function(e){return h(r(u(e),8*e.length))}},I=function(e){var t,n,r="",o=e.length;for(t=0;t<o;t++)0<=(n=e.charCodeAt(t))&&127>=n?r+=e.charAt(t):2047<n?(r+=m(224|15&n>>12),r+=m(128|63&n>>6),r+=m(128|63&n>>0)):(r+=m(192|31&n>>6),r+=m(128|63&n>>0));return r},C=function(e){for(const t in e=e||{})if(Object.prototype.hasOwnProperty.call(e,t)){let n="",r="",o="";const i=e[t],s="object"==typeof i,a=escape(unescape(s?i.value:i));s&&(n=i.expires?";expires="+i.expires:"",r=i.domain?";domain="+i.domain:"",o=i.path?";path="+i.path:""),document.cookie=t+"="+a+n+r+o}},R={VERSION:"@VERSION@",NS:{HTTPBIND:"http://jabber.org/protocol/httpbind",BOSH:"urn:xmpp:xbosh",CLIENT:"jabber:client",AUTH:"jabber:iq:auth",ROSTER:"jabber:iq:roster",PROFILE:"jabber:iq:profile",DISCO_INFO:"http://jabber.org/protocol/disco#info",DISCO_ITEMS:"http://jabber.org/protocol/disco#items",MUC:"http://jabber.org/protocol/muc",SASL:"urn:ietf:params:xml:ns:xmpp-sasl",STREAM:"http://etherx.jabber.org/streams",FRAMING:"urn:ietf:params:xml:ns:xmpp-framing",BIND:"urn:ietf:params:xml:ns:xmpp-bind",SESSION:"urn:ietf:params:xml:ns:xmpp-session",VERSION:"jabber:iq:version",STANZAS:"urn:ietf:params:xml:ns:xmpp-stanzas",XHTML_IM:"http://jabber.org/protocol/xhtml-im",XHTML:"http://www.w3.org/1999/xhtml"},XHTML:{tags:["a","blockquote","br","cite","em","img","li","ol","p","span","strong","ul","body"],attributes:{a:["href"],blockquote:["style"],br:[],cite:["style"],em:[],img:["src","alt","style","height","width"],li:["style"],ol:["style"],p:["style"],span:["style"],strong:[],ul:["style"],body:[]},css:["background-color","color","font-family","font-size","font-style","font-weight","margin-left","margin-right","text-align","text-decoration"],validTag:function(e){for(let t=0;t<R.XHTML.tags.length;t++)if(e===R.XHTML.tags[t])return!0;return!1},validAttribute:function(e,t){if(void 0!==R.XHTML.attributes[e]&&0<R.XHTML.attributes[e].length)for(let n=0;n<R.XHTML.attributes[e].length;n++)if(t===R.XHTML.attributes[e][n])return!0;return!1},validCSS:function(e){for(let t=0;t<R.XHTML.css.length;t++)if(e===R.XHTML.css[t])return!0;return!1}},Status:{ERROR:0,CONNECTING:1,CONNFAIL:2,AUTHENTICATING:3,AUTHFAIL:4,CONNECTED:5,DISCONNECTED:6,DISCONNECTING:7,ATTACHED:8,REDIRECT:9,CONNTIMEOUT:10},ErrorCondition:{BAD_FORMAT:"bad-format",CONFLICT:"conflict",MISSING_JID_NODE:"x-strophe-bad-non-anon-jid",NO_AUTH_MECH:"no-auth-mech",UNKNOWN_REASON:"unknown"},LogLevel:{DEBUG:0,INFO:1,WARN:2,ERROR:3,FATAL:4},ElementType:{NORMAL:1,TEXT:3,CDATA:4,FRAGMENT:11},TIMEOUT:1.1,SECONDARY_TIMEOUT:.1,addNamespace:function(e,t){R.NS[e]=t},forEachChild:function(e,t,n){for(let r=0;r<e.childNodes.length;r++){const o=e.childNodes[r];o.nodeType===R.ElementType.NORMAL&&(!t||this.isTagEqual(o,t))&&n(o)}},isTagEqual:function(e,t){return e.tagName===t},_xmlGenerator:null,_makeGenerator:function(){let e;return void 0===document.implementation.createDocument||document.implementation.createDocument&&document.documentMode&&10>document.documentMode?(e=this._getIEXmlDom()).appendChild(e.createElement("strophe")):e=document.implementation.createDocument("jabber:client","strophe",null),e},xmlGenerator:function(){return R._xmlGenerator||(R._xmlGenerator=R._makeGenerator()),R._xmlGenerator},_getIEXmlDom:function(){let e=null;const t=["Msxml2.DOMDocument.6.0","Msxml2.DOMDocument.5.0","Msxml2.DOMDocument.4.0","MSXML2.DOMDocument.3.0","MSXML2.DOMDocument","MSXML.DOMDocument","Microsoft.XMLDOM"];for(let n=0;n<t.length&&null===e;n++)try{e=new ActiveXObject(t[n])}catch(t){e=null}return e},xmlElement:function(e){if(!e)return null;const t=R.xmlGenerator().createElement(e);for(let e=1;e<arguments.length;e++){const n=arguments[e];if(n)if("string"==typeof n||"number"==typeof n)t.appendChild(R.xmlTextNode(n));else if("object"==typeof n&&"function"==typeof n.sort)for(let e=0;e<n.length;e++){const r=n[e];"object"==typeof r&&"function"==typeof r.sort&&void 0!==r[1]&&null!==r[1]&&t.setAttribute(r[0],r[1])}else if("object"==typeof n)for(const e in n)Object.prototype.hasOwnProperty.call(n,e)&&void 0!==n[e]&&null!==n[e]&&t.setAttribute(e,n[e])}return t},xmlescape:function(e){return e=(e=(e=(e=(e=e.replace(/\&/g,"&amp;")).replace(/</g,"&lt;")).replace(/>/g,"&gt;")).replace(/'/g,"&apos;")).replace(/"/g,"&quot;")},xmlunescape:function(e){return e=(e=(e=(e=(e=e.replace(/\&amp;/g,"&")).replace(/&lt;/g,"<")).replace(/&gt;/g,">")).replace(/&apos;/g,"'")).replace(/&quot;/g,'"')},xmlTextNode:function(e){return R.xmlGenerator().createTextNode(e)},xmlHtmlNode:function(e){let t;if(DOMParser){t=(new DOMParser).parseFromString(e,"text/xml")}else(t=new ActiveXObject("Microsoft.XMLDOM")).async="false",t.loadXML(e);return t},getText:function(e){if(!e)return null;let t="";0===e.childNodes.length&&e.nodeType===R.ElementType.TEXT&&(t+=e.nodeValue);for(let n=0;n<e.childNodes.length;n++)e.childNodes[n].nodeType===R.ElementType.TEXT&&(t+=e.childNodes[n].nodeValue);return R.xmlescape(t)},copyElement:function(e){let t;if(e.nodeType===R.ElementType.NORMAL){t=R.xmlElement(e.tagName);for(let n=0;n<e.attributes.length;n++)t.setAttribute(e.attributes[n].nodeName,e.attributes[n].value);for(let n=0;n<e.childNodes.length;n++)t.appendChild(R.copyElement(e.childNodes[n]))}else e.nodeType===R.ElementType.TEXT&&(t=R.xmlGenerator().createTextNode(e.nodeValue));return t},createHtml:function(e){let t;if(e.nodeType===R.ElementType.NORMAL){const n=e.nodeName.toLowerCase();if(R.XHTML.validTag(n))try{t=R.xmlElement(n);for(let r=0;r<R.XHTML.attributes[n].length;r++){const o=R.XHTML.attributes[n][r];let i=e.getAttribute(o);if(null!=i&&""!==i&&!1!==i&&0!==i)if("style"===o&&"object"==typeof i&&void 0!==i.cssText&&(i=i.cssText),"style"===o){const e=[],n=i.split(";");for(let t=0;t<n.length;t++){const r=n[t].split(":"),o=r[0].replace(/^\s*/,"").replace(/\s*$/,"").toLowerCase();if(R.XHTML.validCSS(o)){const t=r[1].replace(/^\s*/,"").replace(/\s*$/,"");e.push(o+": "+t)}}0<e.length&&(i=e.join("; "),t.setAttribute(o,i))}else t.setAttribute(o,i)}for(let n=0;n<e.childNodes.length;n++)t.appendChild(R.createHtml(e.childNodes[n]))}catch(e){t=R.xmlTextNode("")}else{t=R.xmlGenerator().createDocumentFragment();for(let n=0;n<e.childNodes.length;n++)t.appendChild(R.createHtml(e.childNodes[n]))}}else if(e.nodeType===R.ElementType.FRAGMENT){t=R.xmlGenerator().createDocumentFragment();for(let n=0;n<e.childNodes.length;n++)t.appendChild(R.createHtml(e.childNodes[n]))}else e.nodeType===R.ElementType.TEXT&&(t=R.xmlTextNode(e.nodeValue));return t},escapeNode:function(e){return"string"==typeof e?e.replace(/^\s+|\s+$/g,"").replace(/\\/g,"\\5c").replace(/ /g,"\\20").replace(/\"/g,"\\22").replace(/\&/g,"\\26").replace(/\'/g,"\\27").replace(/\//g,"\\2f").replace(/:/g,"\\3a").replace(/</g,"\\3c").replace(/>/g,"\\3e").replace(/@/g,"\\40"):e},unescapeNode:function(e){return"string"==typeof e?e.replace(/\\20/g," ").replace(/\\22/g,'"').replace(/\\26/g,"&").replace(/\\27/g,"'").replace(/\\2f/g,"/").replace(/\\3a/g,":").replace(/\\3c/g,"<").replace(/\\3e/g,">").replace(/\\40/g,"@").replace(/\\5c/g,"\\"):e},getNodeFromJid:function(e){return 0>e.indexOf("@")?null:e.split("@")[0]},getDomainFromJid:function(e){const t=R.getBareJidFromJid(e);if(0>t.indexOf("@"))return t;{const e=t.split("@");return e.splice(0,1),e.join("@")}},getResourceFromJid:function(e){const t=e.split("/");return 2>t.length?null:(t.splice(0,1),t.join("/"))},getBareJidFromJid:function(e){return e?e.split("/")[0]:null},_handleError:function(e){void 0!==e.stack&&R.fatal(e.stack),e.sourceURL?R.fatal("error: "+this.handler+" "+e.sourceURL+":"+e.line+" - "+e.name+": "+e.message):e.fileName?R.fatal("error: "+this.handler+" "+e.fileName+":"+e.lineNumber+" - "+e.name+": "+e.message):R.fatal("error: "+e.message)},log:function(e,t){e===this.LogLevel.FATAL&&"object"==typeof window.console&&"function"==typeof window.console.error&&window.console.error(t)},debug:function(e){this.log(this.LogLevel.DEBUG,e)},info:function(e){this.log(this.LogLevel.INFO,e)},warn:function(e){this.log(this.LogLevel.WARN,e)},error:function(e){this.log(this.LogLevel.ERROR,e)},fatal:function(e){this.log(this.LogLevel.FATAL,e)},serialize:function(e){if(!e)return null;"function"==typeof e.tree&&(e=e.tree());const t=[...Array(e.attributes.length).keys()].map(t=>e.attributes[t].nodeName);t.sort();let n=t.reduce((t,n)=>`${t} ${n}="${R.xmlescape(e.attributes.getNamedItem(n).value)}"`,`<${e.nodeName}`);if(0<e.childNodes.length){n+=">";for(let t=0;t<e.childNodes.length;t++){const r=e.childNodes[t];switch(r.nodeType){case R.ElementType.NORMAL:n+=R.serialize(r);break;case R.ElementType.TEXT:n+=R.xmlescape(r.nodeValue);break;case R.ElementType.CDATA:n+="<![CDATA["+r.nodeValue+"]]>"}}n+="</"+e.nodeName+">"}else n+="/>";return n},_requestId:0,_connectionPlugins:{},addConnectionPlugin:function(e,t){R._connectionPlugins[e]=t},Builder:function(e,t){("presence"===e||"message"===e||"iq"===e)&&(t&&!t.xmlns?t.xmlns=R.NS.CLIENT:!t&&(t={xmlns:R.NS.CLIENT})),this.nodeTree=R.xmlElement(e,t),this.node=this.nodeTree}};R.Builder.prototype={tree:function(){return this.nodeTree},toString:function(){return R.serialize(this.nodeTree)},up:function(){return this.node=this.node.parentNode,this},root:function(){return this.node=this.nodeTree,this},attrs:function(e){for(const t in e)Object.prototype.hasOwnProperty.call(e,t)&&(void 0===e[t]?this.node.removeAttribute(t):this.node.setAttribute(t,e[t]));return this},c:function(e,t,n){const r=R.xmlElement(e,t,n);return this.node.appendChild(r),"string"!=typeof n&&"number"!=typeof n&&(this.node=r),this},cnode:function(e){let t;const n=R.xmlGenerator();try{t=void 0!==n.importNode}catch(n){t=!1}const r=t?n.importNode(e,!0):R.copyElement(e);return this.node.appendChild(r),this.node=r,this},t:function(e){const t=R.xmlTextNode(e);return this.node.appendChild(t),this},h:function(e){const t=document.createElement("body");t.innerHTML=e;for(const e=R.createHtml(t);0<e.childNodes.length;)this.node.appendChild(e.childNodes[0]);return this}},R.Handler=function(e,t,n,r,o,i,s){this.handler=e,this.ns=t,this.name=n,this.type=r,this.id=o,this.options=s||{matchBareFromJid:!1,ignoreNamespaceFragment:!1},this.options.matchBare&&(R.warn('The "matchBare" option is deprecated, use "matchBareFromJid" instead.'),this.options.matchBareFromJid=this.options.matchBare,delete this.options.matchBare),this.from=this.options.matchBareFromJid?i?R.getBareJidFromJid(i):null:i,this.user=!0},R.Handler.prototype={getNamespace:function(e){let t=e.getAttribute("xmlns");return t&&this.options.ignoreNamespaceFragment&&(t=t.split("#")[0]),t},namespaceMatch:function(e){let t=!1;return!this.ns||(R.forEachChild(e,null,e=>{this.getNamespace(e)===this.ns&&(t=!0)}),t||this.getNamespace(e)===this.ns)},isMatch:function(e){let t=e.getAttribute("from");this.options.matchBareFromJid&&(t=R.getBareJidFromJid(t));const n=e.getAttribute("type");return!(!this.namespaceMatch(e)||this.name&&!R.isTagEqual(e,this.name)||this.type&&(Array.isArray(this.type)?-1===this.type.indexOf(n):n!==this.type)||this.id&&e.getAttribute("id")!==this.id||this.from&&t!==this.from)},run:function(e){let t=null;try{t=this.handler(e)}catch(t){throw R._handleError(t),t}return t},toString:function(){return"{Handler: "+this.handler+"("+this.name+","+this.id+","+this.ns+")}"}},R.TimedHandler=function(e,t){this.period=e,this.handler=t,this.lastCalled=(new Date).getTime(),this.user=!0},R.TimedHandler.prototype={run:function(){return this.lastCalled=(new Date).getTime(),this.handler()},reset:function(){this.lastCalled=(new Date).getTime()},toString:function(){return"{TimedHandler: "+this.handler+"("+this.period+")}"}},R.Connection=function(e,t){this.service=e,this.options=t||{};const n=this.options.protocol||"";for(const t in this._proto=0===e.indexOf("ws:")||0===e.indexOf("wss:")||0===n.indexOf("ws")?new R.Websocket(this):new R.Bosh(this),this.jid="",this.domain=null,this.features=null,this._sasl_data={},this.do_session=!1,this.do_bind=!1,this.timedHandlers=[],this.handlers=[],this.removeTimeds=[],this.removeHandlers=[],this.addTimeds=[],this.addHandlers=[],this.protocolErrorHandlers={HTTP:{},websocket:{}},this._idleTimeout=null,this._disconnectTimeout=null,this.authenticated=!1,this.connected=!1,this.disconnecting=!1,this.do_authentication=!0,this.paused=!1,this.restored=!1,this._data=[],this._uniqueId=0,this._sasl_success_handler=null,this._sasl_failure_handler=null,this._sasl_challenge_handler=null,this.maxRetries=5,this._idleTimeout=setTimeout(()=>this._onIdle(),100),C(this.options.cookies),this.registerSASLMechanisms(this.options.mechanisms),R._connectionPlugins)if(Object.prototype.hasOwnProperty.call(R._connectionPlugins,t)){const e=function(){};e.prototype=R._connectionPlugins[t],this[t]=new e,this[t].init(this)}},R.Connection.prototype={reset:function(){this._proto._reset(),this.do_session=!1,this.do_bind=!1,this.timedHandlers=[],this.handlers=[],this.removeTimeds=[],this.removeHandlers=[],this.addTimeds=[],this.addHandlers=[],this.authenticated=!1,this.connected=!1,this.disconnecting=!1,this.restored=!1,this._data=[],this._requests=[],this._uniqueId=0},pause:function(){this.paused=!0},resume:function(){this.paused=!1},getUniqueId:function(e){const t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=0|16*Math.random();return("x"===e?t:8|3&t).toString(16)});return"string"==typeof e||"number"==typeof e?t+":"+e:t+""},addProtocolErrorHandler:function(e,t,n){this.protocolErrorHandlers[e][t]=n},connect:function(e,t,n,r,o,i,s){this.jid=e,this.authzid=R.getBareJidFromJid(this.jid),this.authcid=s||R.getNodeFromJid(this.jid),this.pass=t,this.servtype="xmpp",this.connect_callback=n,this.disconnecting=!1,this.connected=!1,this.authenticated=!1,this.restored=!1,this.domain=R.getDomainFromJid(this.jid),this._changeConnectStatus(R.Status.CONNECTING,null),this._proto._connect(r,o,i)},attach:function(e,t,n,r,o,i,s){if(!(this._proto instanceof R.Bosh)){const e=new Error('The "attach" method can only be used with a BOSH connection.');throw e.name="StropheSessionError",e}this._proto._attach(e,t,n,r,o,i,s)},restore:function(e,t,n,r,o){if(!this._sessionCachingSupported()){const e=new Error('The "restore" method can only be used with a BOSH connection.');throw e.name="StropheSessionError",e}this._proto._restore(e,t,n,r,o)},_sessionCachingSupported:function(){if(this._proto instanceof R.Bosh){if(!JSON)return!1;try{sessionStorage.setItem("_strophe_","_strophe_"),sessionStorage.removeItem("_strophe_")}catch(e){return!1}return!0}return!1},xmlInput:function(){},xmlOutput:function(){},rawInput:function(){},rawOutput:function(){},nextValidRid:function(){},send:function(e){if(null!==e){if("function"==typeof e.sort)for(let t=0;t<e.length;t++)this._queueData(e[t]);else"function"==typeof e.tree?this._queueData(e.tree()):this._queueData(e);this._proto._send()}},flush:function(){clearTimeout(this._idleTimeout),this._onIdle()},sendPresence:function(e,t,n,r){let o=null;"function"==typeof e.tree&&(e=e.tree());let i=e.getAttribute("id");if(i||(i=this.getUniqueId("sendPresence"),e.setAttribute("id",i)),"function"==typeof t||"function"==typeof n){const e=this.addHandler(e=>{o&&this.deleteTimedHandler(o),"error"===e.getAttribute("type")?n&&n(e):t&&t(e)},null,"presence",null,i);r&&(o=this.addTimedHandler(r,()=>(this.deleteHandler(e),n&&n(null),!1)))}return this.send(e),i},sendIQ:function(e,t,n,r){let o=null;"function"==typeof e.tree&&(e=e.tree());let i=e.getAttribute("id");if(i||(i=this.getUniqueId("sendIQ"),e.setAttribute("id",i)),"function"==typeof t||"function"==typeof n){const e=this.addHandler(e=>{o&&this.deleteTimedHandler(o);const r=e.getAttribute("type");if("result"===r)t&&t(e);else{if("error"!==r){const e=new Error(`Got bad IQ type of ${r}`);throw e.name="StropheError",e}n&&n(e)}},null,"iq",["error","result"],i);r&&(o=this.addTimedHandler(r,()=>(this.deleteHandler(e),n&&n(null),!1)))}return this.send(e),i},_queueData:function(e){if(null===e||!e.tagName||!e.childNodes){const e=new Error("Cannot queue non-DOMElement.");throw e.name="StropheError",e}this._data.push(e)},_sendRestart:function(){this._data.push("restart"),this._proto._sendRestart(),this._idleTimeout=setTimeout(()=>this._onIdle(),100)},addTimedHandler:function(e,t){const n=new R.TimedHandler(e,t);return this.addTimeds.push(n),n},deleteTimedHandler:function(e){this.removeTimeds.push(e)},addHandler:function(e,t,n,r,o,i,s){const a=new R.Handler(e,t,n,r,o,i,s);return this.addHandlers.push(a),a},deleteHandler:function(e){this.removeHandlers.push(e);const t=this.addHandlers.indexOf(e);0<=t&&this.addHandlers.splice(t,1)},registerSASLMechanisms:function(e){this.mechanisms={},(e=e||[R.SASLAnonymous,R.SASLExternal,R.SASLMD5,R.SASLOAuthBearer,R.SASLXOAuth2,R.SASLPlain,R.SASLSHA1]).forEach(this.registerSASLMechanism.bind(this))},registerSASLMechanism:function(e){this.mechanisms[e.prototype.name]=e},disconnect:function(e){if(this._changeConnectStatus(R.Status.DISCONNECTING,e),R.info("Disconnect was called because: "+e),this.connected){let e=!1;this.disconnecting=!0,this.authenticated&&(e=f({xmlns:R.NS.CLIENT,type:"unavailable"})),this._disconnectTimeout=this._addSysTimedHandler(3e3,this._onDisconnectTimeout.bind(this)),this._proto._disconnect(e)}else R.info("Disconnect was called before Strophe connected to the server"),this._proto._abortAllRequests(),this._doDisconnect()},_changeConnectStatus:function(e,t,n){for(const n in R._connectionPlugins)if(Object.prototype.hasOwnProperty.call(R._connectionPlugins,n)){const r=this[n];if(r.statusChanged)try{r.statusChanged(e,t)}catch(e){R.error(`${n} plugin caused an exception changing status: ${e}`)}}if(this.connect_callback)try{this.connect_callback(e,t,n)}catch(t){R._handleError(t),R.error(`User connection callback caused an exception: ${t}`)}},_doDisconnect:function(e){"number"==typeof this._idleTimeout&&clearTimeout(this._idleTimeout),null!==this._disconnectTimeout&&(this.deleteTimedHandler(this._disconnectTimeout),this._disconnectTimeout=null),R.info("_doDisconnect was called"),this._proto._doDisconnect(),this.authenticated=!1,this.disconnecting=!1,this.restored=!1,this.handlers=[],this.timedHandlers=[],this.removeTimeds=[],this.removeHandlers=[],this.addTimeds=[],this.addHandlers=[],this._changeConnectStatus(R.Status.DISCONNECTED,e),this.connected=!1},_dataRecv:function(e,t){R.info("_dataRecv called");const n=this._proto._reqToData(e);if(null!==n){for(this.xmlInput!==R.Connection.prototype.xmlInput&&(n.nodeName===this._proto.strip&&n.childNodes.length?this.xmlInput(n.childNodes[0]):this.xmlInput(n)),this.rawInput!==R.Connection.prototype.rawInput&&(t?this.rawInput(t):this.rawInput(R.serialize(n)));0<this.removeHandlers.length;){const e=this.removeHandlers.pop(),t=this.handlers.indexOf(e);0<=t&&this.handlers.splice(t,1)}for(;0<this.addHandlers.length;)this.handlers.push(this.addHandlers.pop());if(this.disconnecting&&this._proto._emptyQueue())return void this._doDisconnect();const e=n.getAttribute("type");if(null!==e&&"terminate"===e){if(this.disconnecting)return;let e=n.getAttribute("condition");const t=n.getElementsByTagName("conflict");return null===e?this._changeConnectStatus(R.Status.CONNFAIL,R.ErrorCondition.UNKOWN_REASON):("remote-stream-error"===e&&0<t.length&&(e="conflict"),this._changeConnectStatus(R.Status.CONNFAIL,e)),void this._doDisconnect(e)}R.forEachChild(n,null,e=>{const t=this.handlers;this.handlers=[];for(let n=0;n<t.length;n++){const r=t[n];try{!r.isMatch(e)||!this.authenticated&&r.user?this.handlers.push(r):r.run(e)&&this.handlers.push(r)}catch(t){R.warn("Removing Strophe handlers due to uncaught exception: "+t.message)}}})}},mechanisms:{},_connect_cb:function(e,t,n){let r;R.info("_connect_cb was called"),this.connected=!0;try{r=this._proto._reqToData(e)}catch(t){if(t.name!==R.ErrorCondition.BAD_FORMAT)throw t;this._changeConnectStatus(R.Status.CONNFAIL,R.ErrorCondition.BAD_FORMAT),this._doDisconnect(R.ErrorCondition.BAD_FORMAT)}if(!r)return;if(this.xmlInput!==R.Connection.prototype.xmlInput&&(r.nodeName===this._proto.strip&&r.childNodes.length?this.xmlInput(r.childNodes[0]):this.xmlInput(r)),this.rawInput!==R.Connection.prototype.rawInput&&(n?this.rawInput(n):this.rawInput(R.serialize(r))),this._proto._connect_cb(r)===R.Status.CONNFAIL)return;let o;if(!(o=r.getElementsByTagNameNS?0<r.getElementsByTagNameNS(R.NS.STREAM,"features").length:0<r.getElementsByTagName("stream:features").length||0<r.getElementsByTagName("features").length))return void this._proto._no_auth_received(t);const i=[],s=r.getElementsByTagName("mechanism");if(0<s.length)for(let e=0;e<s.length;e++){const t=R.getText(s[e]);this.mechanisms[t]&&i.push(this.mechanisms[t])}return 0===i.length&&0===r.getElementsByTagName("auth").length?void this._proto._no_auth_received(t):void(!1!==this.do_authentication&&this.authenticate(i))},sortMechanismsByPriority:function(e){for(let t,n=0;n<e.length-1;++n){t=n;for(let r=n+1;r<e.length;++r)e[r].prototype.priority>e[t].prototype.priority&&(t=r);if(t!==n){const r=e[n];e[n]=e[t],e[t]=r}}return e},_attemptSASLAuth:function(e){e=this.sortMechanismsByPriority(e||[]);let t=!1;for(let n=0;n<e.length;++n){if(!e[n].prototype.test(this))continue;this._sasl_success_handler=this._addSysHandler(this._sasl_success_cb.bind(this),null,"success",null,null),this._sasl_failure_handler=this._addSysHandler(this._sasl_failure_cb.bind(this),null,"failure",null,null),this._sasl_challenge_handler=this._addSysHandler(this._sasl_challenge_cb.bind(this),null,"challenge",null,null),this._sasl_mechanism=new e[n],this._sasl_mechanism.onStart(this);const r=p("auth",{xmlns:R.NS.SASL,mechanism:this._sasl_mechanism.name});if(this._sasl_mechanism.isClientFirst){const e=this._sasl_mechanism.onChallenge(this,null);r.t(btoa(e))}this.send(r.tree()),t=!0;break}return t},_attemptLegacyAuth:function(){null===R.getNodeFromJid(this.jid)?(this._changeConnectStatus(R.Status.CONNFAIL,R.ErrorCondition.MISSING_JID_NODE),this.disconnect(R.ErrorCondition.MISSING_JID_NODE)):(this._changeConnectStatus(R.Status.AUTHENTICATING,null),this._addSysHandler(this._auth1_cb.bind(this),null,null,null,"_auth_1"),this.send(d({type:"get",to:this.domain,id:"_auth_1"}).c("query",{xmlns:R.NS.AUTH}).c("username",{}).t(R.getNodeFromJid(this.jid)).tree()))},authenticate:function(e){this._attemptSASLAuth(e)||this._attemptLegacyAuth()},_sasl_challenge_cb:function(e){const t=atob(R.getText(e)),n=this._sasl_mechanism.onChallenge(this,t),r=p("response",{xmlns:R.NS.SASL});return""!==n&&r.t(btoa(n)),this.send(r.tree()),!0},_auth1_cb:function(){const e=d({type:"set",id:"_auth_2"}).c("query",{xmlns:R.NS.AUTH}).c("username",{}).t(R.getNodeFromJid(this.jid)).up().c("password").t(this.pass);return R.getResourceFromJid(this.jid)||(this.jid=R.getBareJidFromJid(this.jid)+"/strophe"),e.up().c("resource",{}).t(R.getResourceFromJid(this.jid)),this._addSysHandler(this._auth2_cb.bind(this),null,null,null,"_auth_2"),this.send(e.tree()),!1},_sasl_success_cb:function(e){if(this._sasl_data["server-signature"]){let t;const n=/([a-z]+)=([^,]+)(,|$)/,r=atob(R.getText(e)).match(n);if("v"===r[1]&&(t=r[2]),t!==this._sasl_data["server-signature"])return this.deleteHandler(this._sasl_failure_handler),this._sasl_failure_handler=null,this._sasl_challenge_handler&&(this.deleteHandler(this._sasl_challenge_handler),this._sasl_challenge_handler=null),this._sasl_data={},this._sasl_failure_cb(null)}R.info("SASL authentication succeeded."),this._sasl_mechanism&&this._sasl_mechanism.onSuccess(),this.deleteHandler(this._sasl_failure_handler),this._sasl_failure_handler=null,this._sasl_challenge_handler&&(this.deleteHandler(this._sasl_challenge_handler),this._sasl_challenge_handler=null);const t=[],n=(e,t)=>{for(;e.length;)this.deleteHandler(e.pop());return this._sasl_auth1_cb(t),!1};return t.push(this._addSysHandler(e=>n(t,e),null,"stream:features",null,null)),t.push(this._addSysHandler(e=>n(t,e),R.NS.STREAM,"features",null,null)),this._sendRestart(),!1},_sasl_auth1_cb:function(e){this.features=e;for(let t=0;t<e.childNodes.length;t++){const n=e.childNodes[t];"bind"===n.nodeName&&(this.do_bind=!0),"session"===n.nodeName&&(this.do_session=!0)}if(!this.do_bind)return this._changeConnectStatus(R.Status.AUTHFAIL,null),!1;{this._addSysHandler(this._sasl_bind_cb.bind(this),null,null,null,"_bind_auth_2");const e=R.getResourceFromJid(this.jid);e?this.send(d({type:"set",id:"_bind_auth_2"}).c("bind",{xmlns:R.NS.BIND}).c("resource",{}).t(e).tree()):this.send(d({type:"set",id:"_bind_auth_2"}).c("bind",{xmlns:R.NS.BIND}).tree())}return!1},_sasl_bind_cb:function(e){if("error"===e.getAttribute("type")){let t;return R.info("SASL binding failed."),0<e.getElementsByTagName("conflict").length&&(t=R.ErrorCondition.CONFLICT),this._changeConnectStatus(R.Status.AUTHFAIL,t,e),!1}const t=e.getElementsByTagName("bind");if(!(0<t.length))return R.info("SASL binding failed."),this._changeConnectStatus(R.Status.AUTHFAIL,null,e),!1;{const e=t[0].getElementsByTagName("jid");0<e.length&&(this.jid=R.getText(e[0]),this.do_session?(this._addSysHandler(this._sasl_session_cb.bind(this),null,null,null,"_session_auth_2"),this.send(d({type:"set",id:"_session_auth_2"}).c("session",{xmlns:R.NS.SESSION}).tree())):(this.authenticated=!0,this._changeConnectStatus(R.Status.CONNECTED,null)))}},_sasl_session_cb:function(e){if("result"===e.getAttribute("type"))this.authenticated=!0,this._changeConnectStatus(R.Status.CONNECTED,null);else if("error"===e.getAttribute("type"))return R.info("Session creation failed."),this._changeConnectStatus(R.Status.AUTHFAIL,null,e),!1;return!1},_sasl_failure_cb:function(e){return this._sasl_success_handler&&(this.deleteHandler(this._sasl_success_handler),this._sasl_success_handler=null),this._sasl_challenge_handler&&(this.deleteHandler(this._sasl_challenge_handler),this._sasl_challenge_handler=null),this._sasl_mechanism&&this._sasl_mechanism.onFailure(),this._changeConnectStatus(R.Status.AUTHFAIL,null,e),!1},_auth2_cb:function(e){return"result"===e.getAttribute("type")?(this.authenticated=!0,this._changeConnectStatus(R.Status.CONNECTED,null)):"error"===e.getAttribute("type")&&(this._changeConnectStatus(R.Status.AUTHFAIL,null,e),this.disconnect("authentication failed")),!1},_addSysTimedHandler:function(e,t){const n=new R.TimedHandler(e,t);return n.user=!1,this.addTimeds.push(n),n},_addSysHandler:function(e,t,n,r,o){const i=new R.Handler(e,t,n,r,o);return i.user=!1,this.addHandlers.push(i),i},_onDisconnectTimeout:function(){return R.info("_onDisconnectTimeout was called"),this._changeConnectStatus(R.Status.CONNTIMEOUT,null),this._proto._onDisconnectTimeout(),this._doDisconnect(),!1},_onIdle:function(){for(;0<this.addTimeds.length;)this.timedHandlers.push(this.addTimeds.pop());for(;0<this.removeTimeds.length;){const e=this.removeTimeds.pop(),t=this.timedHandlers.indexOf(e);0<=t&&this.timedHandlers.splice(t,1)}const e=(new Date).getTime(),t=[];for(let n=0;n<this.timedHandlers.length;n++){const r=this.timedHandlers[n];if(this.authenticated||!r.user){0>=r.lastCalled+r.period-e?r.run()&&t.push(r):t.push(r)}}this.timedHandlers=t,clearTimeout(this._idleTimeout),this._proto._onIdle(),this.connected&&(this._idleTimeout=setTimeout(()=>this._onIdle(),100))}},R.SASLMechanism=function(e,t,n){this.name=e,this.isClientFirst=t,this.priority=n},R.SASLMechanism.prototype={test:function(){return!0},onStart:function(e){this._connection=e},onChallenge:function(){throw new Error("You should implement challenge handling!")},onFailure:function(){this._connection=null},onSuccess:function(){this._connection=null}},R.SASLAnonymous=function(){},R.SASLAnonymous.prototype=new R.SASLMechanism("ANONYMOUS",!1,20),R.SASLAnonymous.prototype.test=function(e){return null===e.authcid},R.SASLPlain=function(){},R.SASLPlain.prototype=new R.SASLMechanism("PLAIN",!0,50),R.SASLPlain.prototype.test=function(e){return null!==e.authcid},R.SASLPlain.prototype.onChallenge=function(e){let t=e.authzid;return t+="\0",t+=e.authcid,t+="\0",t+=e.pass,I(t)},R.SASLSHA1=function(){},R.SASLSHA1.prototype=new R.SASLMechanism("SCRAM-SHA-1",!0,70),R.SASLSHA1.prototype.test=function(e){return null!==e.authcid},R.SASLSHA1.prototype.onChallenge=function(e,t,n){const r=n||O.hexdigest(""+1234567890*Math.random());let o="n="+I(e.authcid);return o+=",r=",o+=r,e._sasl_data.cnonce=r,e._sasl_data["client-first-message-bare"]=o,o="n,,"+o,this.onChallenge=((e,t)=>{let n,r,o,i,s,a,c,u,l="c=biws,",h=`${e._sasl_data["client-first-message-bare"]},${t},`;const p=e._sasl_data.cnonce,d=/([a-z]+)=([^,]+)(,|$)/;for(;t.match(d);){const e=t.match(d);switch(t=t.replace(e[0],""),e[1]){case"r":n=e[2];break;case"s":r=e[2];break;case"i":o=e[2]}}if(n.substr(0,p.length)!==p)return e._sasl_data={},e._sasl_failure_cb();h+=l+="r="+n,r=atob(r),r+="\0\0\0";const f=I(e.pass);for(i=a=x.core_hmac_sha1(f,r),c=1;c<o;c++){for(s=x.core_hmac_sha1(f,x.binb2str(a)),u=0;5>u;u++)i[u]^=s[u];a=s}i=x.binb2str(i);const _=x.core_hmac_sha1(i,"Client Key"),m=x.str_hmac_sha1(i,"Server Key"),g=x.core_hmac_sha1(x.str_sha1(x.binb2str(_)),h);for(e._sasl_data["server-signature"]=x.b64_hmac_sha1(m,h),u=0;5>u;u++)_[u]^=g[u];return l+=",p="+btoa(x.binb2str(_))}),o},R.SASLMD5=function(){},R.SASLMD5.prototype=new R.SASLMechanism("DIGEST-MD5",!1,60),R.SASLMD5.prototype.test=function(e){return null!==e.authcid},R.SASLMD5.prototype._quote=function(e){return'"'+e.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'},R.SASLMD5.prototype.onChallenge=function(e,t,n){const r=/([a-z]+)=("[^"]+"|[^,"]+)(?:,|$)/,o=n||O.hexdigest(""+1234567890*Math.random());let i="",s=null,a="";for(;t.match(r);){const e=t.match(r);switch(t=t.replace(e[0],""),e[2]=e[2].replace(/^"(.+)"$/,"$1"),e[1]){case"realm":i=e[2];break;case"nonce":a=e[2];break;case"qop":e[2];break;case"host":s=e[2]}}let c=e.servtype+"/"+e.domain;null!==s&&(c=c+"/"+s);const u=I(e.authcid+":"+i+":"+this._connection.pass),l=O.hash(u)+":"+a+":"+o,h="AUTHENTICATE:"+c;let p="";return p+="charset=utf-8,",p+="username="+this._quote(I(e.authcid))+",",p+="realm="+this._quote(i)+",",p+="nonce="+this._quote(a)+",",p+="nc=00000001,",p+="cnonce="+this._quote(o)+",",p+="digest-uri="+this._quote(c)+",",p+="response="+O.hexdigest(O.hexdigest(l)+":"+a+":00000001:"+o+":auth:"+O.hexdigest(h))+",",p+="qop=auth",this.onChallenge=(()=>""),p},R.SASLOAuthBearer=function(){},R.SASLOAuthBearer.prototype=new R.SASLMechanism("OAUTHBEARER",!0,40),R.SASLOAuthBearer.prototype.test=function(e){return null!==e.pass},R.SASLOAuthBearer.prototype.onChallenge=function(e){let t="n,";return null!==e.authcid&&(t=t+"a="+e.authzid),t+=",",t+="",t+="auth=Bearer ",t+=e.pass,t+="",I(t+="")},R.SASLExternal=function(){},R.SASLExternal.prototype=new R.SASLMechanism("EXTERNAL",!0,10),R.SASLExternal.prototype.onChallenge=function(e){return e.authcid===e.authzid?"":e.authzid},R.SASLXOAuth2=function(){},R.SASLXOAuth2.prototype=new R.SASLMechanism("X-OAUTH2",!0,30),R.SASLXOAuth2.prototype.test=function(e){return null!==e.pass},R.SASLXOAuth2.prototype.onChallenge=function(e){let t="\0";return null!==e.authcid&&(t+=e.authzid),t+="\0",t+=e.pass,I(t)};var A={Strophe:R,$build:p,$iq:d,$msg:function(e){return new R.Builder("message",e)},$pres:f,SHA1:x,MD5:O,b64_hmac_sha1:x.b64_hmac_sha1,b64_sha1:x.b64_sha1,str_hmac_sha1:x.str_hmac_sha1,str_sha1:x.str_sha1};const M=A.Strophe,w=A.$build;M.Request=function(e,t,n,r){this.id=++M._requestId,this.xmlData=e,this.data=M.serialize(e),this.origFunc=t,this.func=t,this.rid=n,this.date=NaN,this.sends=r||0,this.abort=!1,this.dead=null,this.age=function(){if(!this.date)return 0;return(new Date-this.date)/1e3},this.timeDead=function(){if(!this.dead)return 0;return(new Date-this.dead)/1e3},this.xhr=this._newXHR()},M.Request.prototype={getResponse:function(){let e=null;if(this.xhr.responseXML&&this.xhr.responseXML.documentElement){if("parsererror"===(e=this.xhr.responseXML.documentElement).tagName)throw M.error("invalid response received"),M.error("responseText: "+this.xhr.responseText),M.error("responseXML: "+M.serialize(this.xhr.responseXML)),new Error("parsererror")}else if(this.xhr.responseText){if(M.debug("Got responseText but no responseXML; attempting to parse it with DOMParser..."),!(e=(new DOMParser).parseFromString(this.xhr.responseText,"application/xml").documentElement))throw new Error("Parsing produced null node");if(e.querySelector("parsererror")){M.error("invalid response received: "+e.querySelector("parsererror").textContent),M.error("responseText: "+this.xhr.responseText);const t=new Error;throw t.name=M.ErrorCondition.BAD_FORMAT,t}}return e},_newXHR:function(){let e=null;return window.XMLHttpRequest?(e=new XMLHttpRequest).overrideMimeType&&e.overrideMimeType("text/xml; charset=utf-8"):window.ActiveXObject&&(e=new ActiveXObject("Microsoft.XMLHTTP")),e.onreadystatechange=this.func.bind(null,this),e}},M.Bosh=function(e){this._conn=e,this.rid=_(4294967295*Math.random()),this.sid=null,this.hold=1,this.wait=60,this.window=5,this.errors=0,this.inactivity=null,this.lastResponseHeaders=null,this._requests=[]},M.Bosh.prototype={strip:null,_buildBody:function(){const e=w("body",{rid:this.rid++,xmlns:M.NS.HTTPBIND});return null!==this.sid&&e.attrs({sid:this.sid}),this._conn.options.keepalive&&this._conn._sessionCachingSupported()&&this._cacheSession(),e},_reset:function(){this.rid=_(4294967295*Math.random()),this.sid=null,this.errors=0,this._conn._sessionCachingSupported()&&window.sessionStorage.removeItem("strophe-bosh-session"),this._conn.nextValidRid(this.rid)},_connect:function(e,t,n){this.wait=e||this.wait,this.hold=t||this.hold,this.errors=0;const r=this._buildBody().attrs({to:this._conn.domain,"xml:lang":"en",wait:this.wait,hold:this.hold,content:"text/xml; charset=utf-8",ver:"1.6","xmpp:version":"1.0","xmlns:xmpp":M.NS.BOSH});n&&r.attrs({route:n});const o=this._conn._connect_cb;this._requests.push(new M.Request(r.tree(),this._onRequestStateChange.bind(this,o.bind(this._conn)),r.tree().getAttribute("rid"))),this._throttledRequestHandler()},_attach:function(e,t,n,r,o,i,s){this._conn.jid=e,this.sid=t,this.rid=n,this._conn.connect_callback=r,this._conn.domain=M.getDomainFromJid(this._conn.jid),this._conn.authenticated=!0,this._conn.connected=!0,this.wait=o||this.wait,this.hold=i||this.hold,this.window=s||this.window,this._conn._changeConnectStatus(M.Status.ATTACHED,null)},_restore:function(e,t,n,r,o){const i=JSON.parse(window.sessionStorage.getItem("strophe-bosh-session"));if(!(null!=i&&i.rid&&i.sid&&i.jid&&(null==e||M.getBareJidFromJid(i.jid)===M.getBareJidFromJid(e)||null===M.getNodeFromJid(e)&&M.getDomainFromJid(i.jid)===e))){const e=new Error("_restore: no restoreable session.");throw e.name="StropheSessionError",e}this._conn.restored=!0,this._attach(i.jid,i.sid,i.rid,t,n,r,o)},_cacheSession:function(){this._conn.authenticated?this._conn.jid&&this.rid&&this.sid&&window.sessionStorage.setItem("strophe-bosh-session",JSON.stringify({jid:this._conn.jid,rid:this.rid,sid:this.sid})):window.sessionStorage.removeItem("strophe-bosh-session")},_connect_cb:function(e){const t=e.getAttribute("type");if(null!==t&&"terminate"===t){let t=e.getAttribute("condition");M.error("BOSH-Connection failed: "+t);const n=e.getElementsByTagName("conflict");return null===t?this._conn._changeConnectStatus(M.Status.CONNFAIL,"unknown"):("remote-stream-error"===t&&0<n.length&&(t="conflict"),this._conn._changeConnectStatus(M.Status.CONNFAIL,t)),this._conn._doDisconnect(t),M.Status.CONNFAIL}this.sid||(this.sid=e.getAttribute("sid"));const n=e.getAttribute("requests");n&&(this.window=parseInt(n,10));const r=e.getAttribute("hold");r&&(this.hold=parseInt(r,10));const o=e.getAttribute("wait");o&&(this.wait=parseInt(o,10));const i=e.getAttribute("inactivity");i&&(this.inactivity=parseInt(i,10))},_disconnect:function(e){this._sendTerminate(e)},_doDisconnect:function(){this.sid=null,this.rid=_(4294967295*Math.random()),this._conn._sessionCachingSupported()&&window.sessionStorage.removeItem("strophe-bosh-session"),this._conn.nextValidRid(this.rid)},_emptyQueue:function(){return 0===this._requests.length},_callProtocolErrorHandlers:function(e){const t=this._getRequestStatus(e),n=this._conn.protocolErrorHandlers.HTTP[t];n&&n.call(this,t)},_hitError:function(e){this.errors++,M.warn("request errored, status: "+e+", number of errors: "+this.errors),4<this.errors&&this._conn._onDisconnectTimeout()},_no_auth_received:function(e){M.warn("Server did not yet offer a supported authentication mechanism. Sending a blank poll request."),e=e?e.bind(this._conn):this._conn._connect_cb.bind(this._conn);const t=this._buildBody();this._requests.push(new M.Request(t.tree(),this._onRequestStateChange.bind(this,e),t.tree().getAttribute("rid"))),this._throttledRequestHandler()},_onDisconnectTimeout:function(){this._abortAllRequests()},_abortAllRequests:function(){for(;0<this._requests.length;){const e=this._requests.pop();e.abort=!0,e.xhr.abort(),e.xhr.onreadystatechange=function(){}}},_onIdle:function(){const e=this._conn._data;if(this._conn.authenticated&&0===this._requests.length&&0===e.length&&!this._conn.disconnecting&&(M.info("no requests during idle cycle, sending blank request"),e.push(null)),!this._conn.paused){if(2>this._requests.length&&0<e.length){const t=this._buildBody();for(let n=0;n<e.length;n++)null!==e[n]&&("restart"===e[n]?t.attrs({to:this._conn.domain,"xml:lang":"en","xmpp:restart":"true","xmlns:xmpp":M.NS.BOSH}):t.cnode(e[n]).up());delete this._conn._data,this._conn._data=[],this._requests.push(new M.Request(t.tree(),this._onRequestStateChange.bind(this,this._conn._dataRecv.bind(this._conn)),t.tree().getAttribute("rid"))),this._throttledRequestHandler()}if(0<this._requests.length){const e=this._requests[0].age();null!==this._requests[0].dead&&this._requests[0].timeDead()>_(M.SECONDARY_TIMEOUT*this.wait)&&this._throttledRequestHandler(),e>_(M.TIMEOUT*this.wait)&&(M.warn("Request "+this._requests[0].id+" timed out, over "+_(M.TIMEOUT*this.wait)+" seconds since last activity"),this._throttledRequestHandler())}}},_getRequestStatus:function(e,t){let n;if(4===e.xhr.readyState)try{n=e.xhr.status}catch(t){M.error("Caught an error while retrieving a request's status, reqStatus: "+n)}return void 0===n&&(n="number"==typeof t?t:0),n},_onRequestStateChange:function(e,t){if(M.debug("request id "+t.id+"."+t.sends+" state changed to "+t.xhr.readyState),t.abort)t.abort=!1;else if(4===t.xhr.readyState){const n=this._getRequestStatus(t);if(this.lastResponseHeaders=t.xhr.getAllResponseHeaders(),this.disconnecting&&400<=n)return this._hitError(n),void this._callProtocolErrorHandlers(t);const r=0<n&&500>n,o=t.sends>this._conn.maxRetries;if((r||o)&&(this._removeRequest(t),M.debug("request id "+t.id+" should now be removed")),200===n){const n=this._requests[0]===t;(this._requests[1]===t||n&&0<this._requests.length&&this._requests[0].age()>_(M.SECONDARY_TIMEOUT*this.wait))&&this._restartRequest(0),this._conn.nextValidRid(+t.rid+1),M.debug("request id "+t.id+"."+t.sends+" got 200"),e(t),this.errors=0}else 0===n||400<=n&&600>n||12e3<=n?(M.error("request id "+t.id+"."+t.sends+" error "+n+" happened"),this._hitError(n),this._callProtocolErrorHandlers(t),400<=n&&500>n&&(this._conn._changeConnectStatus(M.Status.DISCONNECTING,null),this._conn._doDisconnect())):M.error("request id "+t.id+"."+t.sends+" error "+n+" happened");r||o?o&&!this._conn.connected&&this._conn._changeConnectStatus(M.Status.CONNFAIL,"giving-up"):this._throttledRequestHandler()}},_processRequest:function(e){let t=this._requests[e];const n=this._getRequestStatus(t,-1);if(t.sends>this._conn.maxRetries)return void this._conn._onDisconnectTimeout();const r=t.age(),o=!isNaN(r)&&r>_(M.TIMEOUT*this.wait),i=null!==t.dead&&t.timeDead()>_(M.SECONDARY_TIMEOUT*this.wait),s=4===t.xhr.readyState&&(1>n||500<=n);if((o||i||s)&&(i&&M.error(`Request ${this._requests[e].id} timed out (secondary), restarting`),t.abort=!0,t.xhr.abort(),t.xhr.onreadystatechange=function(){},this._requests[e]=new M.Request(t.xmlData,t.origFunc,t.rid,t.sends),t=this._requests[e]),0===t.xhr.readyState){M.debug("request id "+t.id+"."+t.sends+" posting");try{const n=this._conn.options.contentType||"text/xml; charset=utf-8";t.xhr.open("POST",this._conn.service,!this._conn.options.sync),void 0!==t.xhr.setRequestHeader&&t.xhr.setRequestHeader("Content-Type",n),this._conn.options.withCredentials&&(t.xhr.withCredentials=!0)}catch(e){return M.error("XHR open failed: "+e.toString()),this._conn.connected||this._conn._changeConnectStatus(M.Status.CONNFAIL,"bad-service"),void this._conn.disconnect()}const n=()=>{if(t.date=new Date,this._conn.options.customHeaders){const e=this._conn.options.customHeaders;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.xhr.setRequestHeader(n,e[n])}t.xhr.send(t.data)};if(1<t.sends){const e=1e3*Math.min(_(M.TIMEOUT*this.wait),Math.pow(t.sends,3));setTimeout(function(){n()},e)}else n();t.sends++,this._conn.xmlOutput!==M.Connection.prototype.xmlOutput&&(t.xmlData.nodeName===this.strip&&t.xmlData.childNodes.length?this._conn.xmlOutput(t.xmlData.childNodes[0]):this._conn.xmlOutput(t.xmlData)),this._conn.rawOutput!==M.Connection.prototype.rawOutput&&this._conn.rawOutput(t.data)}else M.debug("_processRequest: "+(0===e?"first":"second")+" request has readyState of "+t.xhr.readyState)},_removeRequest:function(e){M.debug("removing request");for(let t=this._requests.length-1;0<=t;t--)e===this._requests[t]&&this._requests.splice(t,1);e.xhr.onreadystatechange=function(){},this._throttledRequestHandler()},_restartRequest:function(e){const t=this._requests[e];null===t.dead&&(t.dead=new Date),this._processRequest(e)},_reqToData:function(e){try{return e.getResponse()}catch(e){if("parsererror"!==e.message)throw e;this._conn.disconnect("strophe-parsererror")}},_sendTerminate:function(e){M.info("_sendTerminate was called");const t=this._buildBody().attrs({type:"terminate"});e&&t.cnode(e.tree());const n=new M.Request(t.tree(),this._onRequestStateChange.bind(this,this._conn._dataRecv.bind(this._conn)),t.tree().getAttribute("rid"));this._requests.push(n),this._throttledRequestHandler()},_send:function(){clearTimeout(this._conn._idleTimeout),this._throttledRequestHandler(),this._conn._idleTimeout=setTimeout(()=>this._conn._onIdle(),100)},_sendRestart:function(){this._throttledRequestHandler(),clearTimeout(this._conn._idleTimeout)},_throttledRequestHandler:function(){this._requests?M.debug("_throttledRequestHandler called with "+this._requests.length+" requests"):M.debug("_throttledRequestHandler called with undefined requests"),this._requests&&0!==this._requests.length&&(0<this._requests.length&&this._processRequest(0),1<this._requests.length&&Math.abs(this._requests[0].rid-this._requests[1].rid)<this.window&&this._processRequest(1))}};const B=A.Strophe,k=A.$build;B.Websocket=function(e){this._conn=e,this.strip="wrapper";const t=e.service;if(0!==t.indexOf("ws:")&&0!==t.indexOf("wss:")){let n="";n+="ws"===e.options.protocol&&"https:"!==window.location.protocol?"ws":"wss",n+="://"+window.location.host,n+=0===t.indexOf("/")?t:window.location.pathname+t,e.service=n}},B.Websocket.prototype={_buildStream:function(){return k("open",{xmlns:B.NS.FRAMING,to:this._conn.domain,version:"1.0"})},_check_streamerror:function(e,t){let n;if(0===(n=e.getElementsByTagNameNS?e.getElementsByTagNameNS(B.NS.STREAM,"error"):e.getElementsByTagName("stream:error")).length)return!1;const r=n[0];let o="",i="";for(let e=0;e<r.childNodes.length;e++){const t=r.childNodes[e];if("urn:ietf:params:xml:ns:xmpp-streams"!==t.getAttribute("xmlns"))break;"text"===t.nodeName?i=t.textContent:o=t.nodeName}let s="WebSocket stream error: ";return s+=o||"unknown",i&&(s+=" - "+i),B.error(s),this._conn._changeConnectStatus(t,o),this._conn._doDisconnect(),!0},_reset:function(){},_connect:function(){this._closeSocket(),this.socket=new WebSocket(this._conn.service,"xmpp"),this.socket.onopen=this._onOpen.bind(this),this.socket.onerror=this._onError.bind(this),this.socket.onclose=this._onClose.bind(this),this.socket.onmessage=this._connect_cb_wrapper.bind(this)},_connect_cb:function(e){if(this._check_streamerror(e,B.Status.CONNFAIL))return B.Status.CONNFAIL},_handleStreamStart:function(e){let t=!1;const n=e.getAttribute("xmlns");"string"==typeof n?n!==B.NS.FRAMING&&(t="Wrong xmlns in <open />: "+n):t="Missing xmlns in <open />";const r=e.getAttribute("version");return"string"==typeof r?"1.0"!==r&&(t="Wrong version in <open />: "+r):t="Missing version in <open />",!t||(this._conn._changeConnectStatus(B.Status.CONNFAIL,t),this._conn._doDisconnect(),!1)},_connect_cb_wrapper:function(e){if(0===e.data.indexOf("<open ")||0===e.data.indexOf("<?xml")){const t=e.data.replace(/^(<\?.*?\?>\s*)*/,"");if(""===t)return;const n=(new DOMParser).parseFromString(t,"text/xml").documentElement;this._conn.xmlInput(n),this._conn.rawInput(e.data),this._handleStreamStart(n)&&this._connect_cb(n)}else if(0===e.data.indexOf("<close ")){const t=(new DOMParser).parseFromString(e.data,"text/xml").documentElement;this._conn.xmlInput(t),this._conn.rawInput(e.data);const n=t.getAttribute("see-other-uri");if(n){const e=this._conn.service;(0<=e.indexOf("wss:")&&0<=n.indexOf("wss:")||0<=e.indexOf("ws:"))&&(this._conn._changeConnectStatus(B.Status.REDIRECT,"Received see-other-uri, resetting connection"),this._conn.reset(),this._conn.service=n,this._connect())}else this._conn._changeConnectStatus(B.Status.CONNFAIL,"Received closing stream"),this._conn._doDisconnect()}else{const t=this._streamWrap(e.data),n=(new DOMParser).parseFromString(t,"text/xml").documentElement;this.socket.onmessage=this._onMessage.bind(this),this._conn._connect_cb(n,null,e.data)}},_disconnect:function(e){if(this.socket&&this.socket.readyState!==WebSocket.CLOSED){e&&this._conn.send(e);const t=k("close",{xmlns:B.NS.FRAMING});this._conn.xmlOutput(t.tree());const n=B.serialize(t);this._conn.rawOutput(n);try{this.socket.send(n)}catch(e){B.info("Couldn't send <close /> tag.")}}this._conn._doDisconnect()},_doDisconnect:function(){B.info("WebSockets _doDisconnect was called"),this._closeSocket()},_streamWrap:function(e){return"<wrapper>"+e+"</wrapper>"},_closeSocket:function(){if(this.socket)try{this.socket.onerror=null,this.socket.close()}catch(e){B.debug(e.message)}this.socket=null},_emptyQueue:function(){return!0},_onClose:function(e){this._conn.connected&&!this._conn.disconnecting?(B.error("Websocket closed unexpectedly"),this._conn._doDisconnect()):e&&1006===e.code&&!this._conn.connected&&this.socket?(B.error("Websocket closed unexcectedly"),this._conn._changeConnectStatus(B.Status.CONNFAIL,"The WebSocket connection could not be established or was disconnected."),this._conn._doDisconnect()):B.info("Websocket closed")},_no_auth_received:function(e){B.error("Server did not offer a supported authentication mechanism"),this._changeConnectStatus(B.Status.CONNFAIL,B.ErrorCondition.NO_AUTH_MECH),e&&e.call(this._conn),this._conn._doDisconnect()},_onDisconnectTimeout:function(){},_abortAllRequests:function(){},_onError:function(e){B.error("Websocket error "+e),this._conn._changeConnectStatus(B.Status.CONNFAIL,"The WebSocket connection could not be established or was disconnected."),this._disconnect()},_onIdle:function(){const e=this._conn._data;if(0<e.length&&!this._conn.paused){for(let t=0;t<e.length;t++)if(null!==e[t]){let n="restart"===e[t]?this._buildStream().tree():e[t];const r=B.serialize(n);this._conn.xmlOutput(n),this._conn.rawOutput(r),this.socket.send(r)}this._conn._data=[]}},_onMessage:function(e){let t;const n='<close xmlns="urn:ietf:params:xml:ns:xmpp-framing" />';if(e.data===n)return this._conn.rawInput(n),this._conn.xmlInput(e),void(this._conn.disconnecting||this._conn._doDisconnect());if(0!==e.data.search("<open ")){const n=this._streamWrap(e.data);t=(new DOMParser).parseFromString(n,"text/xml").documentElement}else if(t=(new DOMParser).parseFromString(e.data,"text/xml").documentElement,!this._handleStreamStart(t))return;return this._check_streamerror(t,B.Status.ERROR)?void 0:this._conn.disconnecting&&"presence"===t.firstChild.nodeName&&"unavailable"===t.firstChild.getAttribute("type")?(this._conn.xmlInput(t),void this._conn.rawInput(B.serialize(t))):void this._conn._dataRecv(t,e.data)},_onOpen:function(){B.info("Websocket open");const e=this._buildStream();this._conn.xmlOutput(e.tree());const t=B.serialize(e);this._conn.rawOutput(t),this.socket.send(t)},_reqToData:function(e){return e},_send:function(){this._conn.flush()},_sendRestart:function(){clearTimeout(this._conn._idleTimeout),this._conn._onIdle.bind(this._conn)()}},n.d(t,"a",function(){return A})},function(e,t,n){window.websdk=n(15)},function(module,__webpack_exports__,__webpack_require__){"use strict";function _parsePrivacy(e){var t={},n=e.getElementsByTagName("item");if(n)for(var r=0;r<n.length;r++){var o=n[r],i=o.getAttribute("value"),s=o.getAttribute("order"),a=o.getAttribute("type");if(i){var c=_parseNameFromJidFn(i);t[c]={type:a,order:s,jid:i,name:c}}}return t}function _parseGroupBlacklist(e){var t={},n=e.getElementsByTagName("item");if(n)for(var r=0;r<n.length;r++){var o=n[r],i=o.getAttribute("jid"),s=o.getAttribute("affiliation"),a=o.getAttribute("nick");if(i){var c=_parseNameFromJidFn(i);t[c]={jid:i,affiliation:s,nick:a,name:c}}}return t}function _setText(e,t){"textContent"in e?e.textContent=t:"text"in e&&(e.text=t)}__webpack_require__.r(__webpack_exports__);var _strophe_strophe__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(13),_version="1.4.13",_code=__webpack_require__(8).code,_utils=__webpack_require__(9).utils,_msg=__webpack_require__(16),_message=_msg._msg,_msgHash={},Queue=__webpack_require__(40).Queue,CryptoJS=__webpack_require__(10),_=__webpack_require__(41),stropheConn=null,Strophe=_strophe_strophe__WEBPACK_IMPORTED_MODULE_0__.a.Strophe,isStropheLog;window.URL=window.URL||window.webkitURL||window.mozURL||window.msURL;var logMessage=function(){};window.XDomainRequest,Strophe.Request.prototype._newXHR=function(){var e=_utils.xmlrequest(!0);return e.overrideMimeType&&e.overrideMimeType("text/xml"),e.onreadystatechange=this.func.bind(null,this),e},Strophe.Websocket.prototype._closeSocket=function(){if(this.socket){var e=this;setTimeout(function(){try{e.socket.close()}catch(e){}},0)}else this.socket=null},Strophe.log=function(e,t){isStropheLog&&(e===this.LogLevel.DEBUG?console.debug(t):e===this.LogLevel.INFO?console.info(t):e===this.LogLevel.WARN?console.warn(t):e===this.LogLevel.ERROR||e===this.LogLevel.FATAL?console.error(t):console.log(t))},Strophe.Websocket.prototype._onMessage=function(e){var t;if(logMessage(e),0<(o=e.data).indexOf("<jid>")){var n=o.indexOf("<jid>"),r=o.indexOf("</jid>"),o=o.substring(n+5,r);stropheConn.setJid(o)}if(0!==e.data.indexOf("<close ")){if(0!==e.data.search("<open "))o=this._streamWrap(e.data),t=(new DOMParser).parseFromString(o,"text/xml").documentElement;else if(t=(new DOMParser).parseFromString(e.data,"text/xml").documentElement,!this._handleStreamStart(t))return;return this._check_streamerror(t,Strophe.Status.ERROR)?void 0:this._conn.disconnecting&&"presence"===t.firstChild.nodeName&&"unavailable"===t.firstChild.getAttribute("type")?(this._conn.xmlInput(t),void this._conn.rawInput(Strophe.serialize(t))):void this._conn._dataRecv(t,e.data)}var i=(t=(new DOMParser).parseFromString(e.data,"text/xml").documentElement).getAttribute("see-other-uri");i?(this._conn._changeConnectStatus(Strophe.Status.REDIRECT,"Received see-other-uri, resetting connection"),this._conn.reset(),this._conn.service=i,this._connect()):this._conn._doDisconnect("receive <close> from server")};var _listenNetwork=function(e,t){window.addEventListener?(window.addEventListener("online",e),window.addEventListener("offline",t)):window.attachEvent&&(document.body?(document.body.attachEvent("ononline",e),document.body.attachEvent("onoffline",t)):window.attachEvent("load",function(){document.body.attachEvent("ononline",e),document.body.attachEvent("onoffline",t)}))},_parseRoom=function(e){var t=[],n=e.getElementsByTagName("item");if(n)for(var r=0;r<n.length;r++){var o=n[r],i=o.getAttribute("jid"),s=i.split("@")[0],a={jid:i,name:o.getAttribute("name"),roomId:s.split("_")[1]};t.push(a)}return t},_parseRoomOccupants=function(e){var t=[],n=e.getElementsByTagName("item");if(n)for(var r=0;r<n.length;r++){var o=n[r],i={jid:o.getAttribute("jid"),name:o.getAttribute("name")};t.push(i)}return t},_parseResponseMessage=function(msginfo){var parseMsgData={errorMsg:!0,data:[]},msgBodies=msginfo.getElementsByTagName("body");if(msgBodies){for(var i=0;i<msgBodies.length;i++){var msgBody=msgBodies[i],childNodes=msgBody.childNodes;if(childNodes&&0<childNodes.length){var childNode=msgBody.childNodes[0];if(childNode.nodeType==Strophe.ElementType.TEXT){var jsondata=childNode.wholeText||childNode.nodeValue;jsondata=jsondata.replace("\n","<br>");try{var data=eval("("+jsondata+")");parseMsgData.errorMsg=!1,parseMsgData.data=[data]}catch(e){}}}}var delayTags=msginfo.getElementsByTagName("delay");if(delayTags&&0<delayTags.length){var delayTag=delayTags[0],delayMsgTime=delayTag.getAttribute("stamp");delayMsgTime&&(parseMsgData.delayTimeStamp=delayMsgTime)}}else{var childrens=msginfo.childNodes;if(childrens&&0<childrens.length){var child=msginfo.childNodes[0];if(child.nodeType==Strophe.ElementType.TEXT)try{var data=eval("("+child.nodeValue+")");parseMsgData.errorMsg=!1,parseMsgData.data=[data]}catch(e){}}}return parseMsgData},_parseNameFromJidFn=function(e,t){t=t||"";var n=e,r=n.indexOf("_");-1!==r&&(n=n.substring(r+1));var o=n.indexOf("@"+t);return-1!==o&&(n=n.substring(0,o)),n},_parseFriend=function(e,t){var n=[],r=e.getElementsByTagName("item");if(r)for(var o=0;o<r.length;o++){var i=r[o],s=i.getAttribute("jid");if(s){var a=i.getAttribute("subscription"),c={subscription:a,jid:s},u=i.getAttribute("ask");u&&(c.ask=u);var l=i.getAttribute("name");if(l)c.name=l;else{var h=_parseNameFromJidFn(s);c.name=h}var p=[];Strophe.forEachChild(i,"group",function(e){p.push(Strophe.getText(e))}),c.groups=p,n.push(c),t&&"from"==a&&!u&&t.subscribe({toJid:s,message:"[resp:true]"}),t&&"to"==a&&t.subscribed({toJid:s})}}return n},_login=function(e,t){if(e){var n=e.access_token||"";if(""==n)return _utils.stringify(e),void t.onError({type:_code.WEBIM_CONNCTION_OPEN_USERGRID_ERROR,data:e});t.context.accessToken=e.access_token,t.context.accessTokenExpires=e.expires_in,stropheConn=t.isOpening()&&t.context.stropheConn?t.getStrophe():(t.isOpened()&&t.context.stropheConn,t.getStrophe());var r=function(e,n){_loginCallback(e,n,t)};t.context.stropheConn=stropheConn,t.route?stropheConn.connect(t.context.jid,"$t$"+n,r,t.wait,t.hold,t.route):stropheConn.connect(t.context.jid,"$t$"+n,r,t.wait,t.hold)}},_parseMessageType=function(e){var t=e.getElementsByTagName("received"),n=e.getElementsByTagName("invite"),r=e.getElementsByTagName("delivery"),o=e.getElementsByTagName("acked"),i=e.getElementsByTagName("error"),s="normal";if(t&&0<t.length&&"urn:xmpp:receipts"===t[0].namespaceURI)s="received";else if(n&&0<n.length)s="invite";else if(r&&0<r.length)s="delivery";else if(o&&o.length)s="acked";else if(i&&i.length){var a=i[0].getElementsByTagName("user-muted");a&&a.length&&(s="userMuted")}return s},_handleMessageQueue=function(e){for(var t in _msgHash)_msgHash.hasOwnProperty(t)&&_msgHash[t].send(e)},_loginCallback=function(e,t,n){var r,o;if("conflict"===t&&(r=!0,n.close()),e==Strophe.Status.CONNFAIL)o={type:_code.WEBIM_CONNCTION_SERVER_CLOSE_ERROR,msg:t,reconnect:!0},r&&(o.conflict=!0),n.onError(o);else if(e==Strophe.Status.ATTACHED||e==Strophe.Status.CONNECTED){n.autoReconnectNumTotal=0,n.intervalId=setInterval(function(){n.handelSendQueue()},100);n.addHandler(function(e){var t=e.getElementsByTagName("delivery"),r=e.getElementsByTagName("acked");if(t.length)return n.handleDeliveredMessage(e),!0;if(r.length)return n.handleAckedMessage(e),!0;var o=_parseMessageType(e);return"received"===o?(n.handleReceivedMessage(e),!0):"invite"===o?(n.handleInviteMessage(e),!0):"delivery"===o?(n.handleDeliveredMessage(e),!0):"acked"===o?(n.handleAckedMessage(e),!0):"userMuted"===o?(n.handleMutedMessage(e),!0):(n.handleMessage(e),!0)},null,"message",null,null,null),n.addHandler(function(e){return n.handlePresence(e),!0},null,"presence",null,null,null),n.addHandler(function(e){return n.handlePing(e),!0},"urn:xmpp:ping","iq","get",null,null),n.addHandler(function(e){return n.handleIqRoster(e),!0},"jabber:iq:roster","iq","set",null,null),n.addHandler(function(e){return n.handleIqPrivacy(e),!0},"jabber:iq:privacy","iq","set",null,null),n.addHandler(function(e){return n.handleIq(e),!0},null,"iq",null,null,null),n.registerConfrIQHandler&&n.registerConfrIQHandler(),n.context.status=_code.STATUS_OPENED;var i=[_code.WEBIM_MESSAGE_REC_TEXT,_code.WEBIM_MESSAGE_REC_EMOJI];_utils.isCanDownLoadFile&&(i.push(_code.WEBIM_MESSAGE_REC_PHOTO),i.push(_code.WEBIM_MESSAGE_REC_AUDIO_FILE));var s=[_code.WEBIM_MESSAGE_SED_TEXT];_utils.isCanUploadFile&&(s.push(_code.WEBIM_MESSAGE_REC_PHOTO),s.push(_code.WEBIM_MESSAGE_REC_AUDIO_FILE)),n.notifyVersion(),n.retry&&_handleMessageQueue(n),n.heartBeat(),n.isAutoLogin&&n.setPresence();try{if(0<n.unSendMsgArr.length)for(var a in n.unSendMsgArr){var c=n.unSendMsgArr[a];n.sendCommand(c),delete n.unSendMsgArr[a]}}catch(t){console.error(t.message)}n.offLineSendConnecting=!1,n.logOut=!1,n.onOpened({canReceive:i,canSend:s,accessToken:n.context.accessToken})}else if(e==Strophe.Status.DISCONNECTING)n.isOpened()&&(n.stopHeartBeat(),n.context.status=_code.STATUS_CLOSING,o={type:_code.WEBIM_CONNCTION_SERVER_CLOSE_ERROR,msg:t,reconnect:!0},r&&(o.conflict=!0),n.onError(o));else if(e==Strophe.Status.DISCONNECTED){if(!n.isClosing()||n.isOpened()){if(n.autoReconnectNumTotal<n.autoReconnectNumMax)return void n.reconnect(!n.isClosing());o={type:_code.WEBIM_CONNCTION_DISCONNECTED},n.onError(o)}n.context.status=_code.STATUS_CLOSED,n.clear(),n.onClosed()}else e==Strophe.Status.AUTHFAIL?(o={type:_code.WEBIM_CONNCTION_AUTH_ERROR},r&&(o.conflict=!0),n.onError(o),n.clear()):e==Strophe.Status.ERROR&&(n.context.status=_code.STATUS_ERROR,o={type:_code.WEBIM_CONNCTION_SERVER_ERROR},r&&(o.conflict=!0),n.onError(o));n.context.status_now=e},_getJid=function(e,t){var n=e.toJid||"";if(""===n){var r=(t.context.appKey||"")+"_"+e.to+"@"+t.domain;e.resource&&(r=r+"/"+e.resource),n=r}return n},_getJidByName=function(e,t){return _getJid({to:e},t)},_validCheck=function(e,t){if(""==(e=e||{}).user)return t.onError({type:_code.WEBIM_CONNCTION_USER_NOT_ASSIGN_ERROR}),!1;var n=e.user+""||"",r=e.appKey||"",o=r.split("#");if(2!==o.length)return t.onError({type:_code.WEBIM_CONNCTION_APPKEY_NOT_ASSIGN_ERROR}),!1;var i=o[0],s=o[1];if(!i)return t.onError({type:_code.WEBIM_CONNCTION_APPKEY_NOT_ASSIGN_ERROR}),!1;if(!s)return t.onError({type:_code.WEBIM_CONNCTION_APPKEY_NOT_ASSIGN_ERROR}),!1;var a=r+"_"+n.toLowerCase()+"@"+t.domain,c=e.resource||"webim";return t.isMultiLoginSessions&&(c+=n+(new Date).getTime()+Math.floor(1e6*Math.random().toFixed(6))),t.context.jid=a+"/"+c,t.context.userId=n,t.context.appKey=r,t.context.appName=s,t.context.orgName=i,!0},_getXmppUrl=function(e,t){if(/^(ws|http)s?:\/\/?/.test(e))return e;var n={prefix:"http",base:"://"+e,suffix:"/http-bind/"};return t&&_utils.isSupportWss?(n.prefix="wss",n.suffix="/ws/"):t?n.prefix="https":window.WebSocket&&(n.prefix="ws",n.suffix="/ws/"),n.prefix+n.base+n.suffix},connection=function(e){if(!this instanceof connection)return new connection(e);e=e||{};this.isHttpDNS=e.isHttpDNS||!1,this.isMultiLoginSessions=e.isMultiLoginSessions||!1,this.wait=e.wait||30,this.retry=e.retry||!1,this.https=e.https&&"https:"===location.protocol,this.url=_getXmppUrl(e.url,this.https),this.hold=e.hold||1,this.route=e.route||null,this.domain=e.domain||"easemob.com",this.inactivity=e.inactivity||30,this.heartBeatWait=e.heartBeatWait||4500,this.maxRetries=e.maxRetries||5,this.isAutoLogin=!1!==e.isAutoLogin,this.pollingTime=e.pollingTime||800,this.stropheConn=!1,this.autoReconnectNumMax=e.autoReconnectNumMax||0,this.autoReconnectNumTotal=0,this.autoReconnectInterval=e.autoReconnectInterval||0,this.context={status:_code.STATUS_INIT},this.sendQueue=new Queue,this.intervalId=null,this.apiUrl=e.apiUrl||"",this.isWindowSDK=e.isWindowSDK||!1,this.encrypt=e.encrypt||{encrypt:{type:"none"}},this.delivery=e.delivery||!1,this.user="",this.orgName="",this.appName="",this.token="",this.unSendMsgArr=[],this.dnsArr=["https://rs.easemob.com","https://rsbak.easemob.com","http://182.92.174.78","http://112.126.66.111"],this.dnsIndex=0,this.dnsTotal=this.dnsArr.length,this.restHosts=null,this.restIndex=0,this.restTotal=0,this.xmppHosts=null,this.xmppIndex=0,this.xmppTotal=0,this.groupOption={},isStropheLog=e.isStropheLog||!1};connection.prototype.registerUser=function(e){"https:"!=location.protocol&&this.isHttpDNS?(this.dnsIndex=0,this.getHttpDNS(e,"signup")):this.signup(e)},connection.prototype.handelSendQueue=function(){var e=this.sendQueue.pop();null!==e&&this.sendReceiptsMessage(e)},connection.prototype.listen=function(e){this.onOpened=e.onOpened||_utils.emptyfn,this.onClosed=e.onClosed||_utils.emptyfn,this.onTextMessage=e.onTextMessage||_utils.emptyfn,this.onEmojiMessage=e.onEmojiMessage||_utils.emptyfn,this.onPictureMessage=e.onPictureMessage||_utils.emptyfn,this.onAudioMessage=e.onAudioMessage||_utils.emptyfn,this.onVideoMessage=e.onVideoMessage||_utils.emptyfn,this.onFileMessage=e.onFileMessage||_utils.emptyfn,this.onLocationMessage=e.onLocationMessage||_utils.emptyfn,this.onCmdMessage=e.onCmdMessage||_utils.emptyfn,this.onPresence=e.onPresence||_utils.emptyfn,this.onRoster=e.onRoster||_utils.emptyfn,this.onError=e.onError||_utils.emptyfn,this.onReceivedMessage=e.onReceivedMessage||_utils.emptyfn,this.onInviteMessage=e.onInviteMessage||_utils.emptyfn,this.onDeliverdMessage=e.onDeliveredMessage||_utils.emptyfn,this.onReadMessage=e.onReadMessage||_utils.emptyfn,this.onMutedMessage=e.onMutedMessage||_utils.emptyfn,this.onOffline=e.onOffline||_utils.emptyfn,this.onOnline=e.onOnline||_utils.emptyfn,this.onConfirmPop=e.onConfirmPop||_utils.emptyfn,this.onCreateGroup=e.onCreateGroup||_utils.emptyfn,this.onUpdateMyGroupList=e.onUpdateMyGroupList||_utils.emptyfn,this.onUpdateMyRoster=e.onUpdateMyRoster||_utils.emptyfn,this.onBlacklistUpdate=e.onBlacklistUpdate||_utils.emptyfn,_listenNetwork(this.onOnline,this.onOffline)},connection.prototype.heartBeat=function(e){!0!==e&&(e=!1);var t=this,n=!/^ws|wss/.test(t.url)||/mobile/.test(navigator.userAgent);if(!this.heartBeatID&&(e||n)){var r={toJid:this.domain,type:"normal"};this.heartBeatID=setInterval(function(){_utils.isSupportWss&&t.ping(r)},this.heartBeatWait)}},connection.prototype.stopHeartBeat=function(){"number"==typeof this.heartBeatID&&(this.heartBeatID=clearInterval(this.heartBeatID))},connection.prototype.sendReceiptsMessage=function(e){var t=$msg({from:this.context.jid||"",to:this.domain,id:e.id||""}).c("received",{xmlns:"urn:xmpp:receipts",id:e.id||""});this.sendCommand(t.tree())},connection.prototype.cacheReceiptsMessage=function(e){this.sendQueue.push(e)},connection.prototype.getStrophe=function(){if("https:"!=location.protocol&&this.isHttpDNS){var e="",t=this.xmppHosts[this.xmppIndex],n=_utils.getXmlFirstChild(t,"domain"),r=_utils.getXmlFirstChild(t,"ip");if(r){e=r.textContent;var o=_utils.getXmlFirstChild(t,"port");"80"!=o.textContent&&(e+=":"+o.textContent)}else e=n.textContent;if(""!=e){this.url=this.url.replace(/(.+\/\/).+(\/.+)/,"$1"+e+"$2")}}return new Strophe.Connection(this.url,{inactivity:this.inactivity,maxRetries:this.maxRetries,pollingTime:this.pollingTime})},connection.prototype.getHostsByTag=function(e,t){var n=_utils.getXmlFirstChild(e,t);if(!n)return console.log(t+" hosts error"),null;var r=n.getElementsByTagName("hosts");return 0==r.length?(console.log(t+" hosts error2"),null):r[0].getElementsByTagName("host")},connection.prototype.getRestFromHttpDNS=function(e,t){if(this.restIndex>this.restTotal)console.log("rest hosts all tried,quit");else{var n="",r=this.restHosts[this.restIndex],o=_utils.getXmlFirstChild(r,"domain"),i=_utils.getXmlFirstChild(r,"ip");if(i){var s=_utils.getXmlFirstChild(r,"port");n=("https:"===location.protocol?"https:":"http:")+"//"+i.textContent+":"+s.textContent}else n=("https:"===location.protocol?"https:":"http:")+"//"+o.textContent;""!=n&&(this.apiUrl=n,e.apiUrl=n),"login"==t?this.login(e):this.signup(e)}},connection.prototype.getHttpDNS=function(e,t){var n=this,r={url:this.dnsArr[this.dnsIndex]+"/easemob/server.xml",dataType:"text",type:"GET",data:{app_key:encodeURIComponent(e.appKey)},success:function(r){r=(new DOMParser).parseFromString(r,"text/xml").documentElement;var o=n.getHostsByTag(r,"rest");if(o){n.restHosts=o,n.restTotal=o.length;var i=function(e){return Array.prototype.slice.call(e,0)};try{Array.prototype.slice.call(document.documentElement.childNodes,0)[0].nodeType}catch(e){i=function(e){for(var t=[],n=0,r=e.length;n<r;n++)t.push(e[n]);return t}}var s=i(n.getHostsByTag(r,"xmpp"));if(s){for(var a,c=0;c<s.length;c++)if(a=n.https?"https":"http",_utils.getXmlFirstChild(s[c],"protocol").textContent===a){var u=s[c];s.splice(c,1),s.unshift(u)}n.xmppHosts=s,n.xmppTotal=s.length,n.getRestFromHttpDNS(e,t)}else console.log("xmpp hosts error3")}else console.log("rest hosts error3")}||_utils.emptyfn,error:function(r,o,i){console.log("getHttpDNS error",r,i),n.dnsIndex++,n.dnsIndex<n.dnsTotal&&n.getHttpDNS(e,t)}||_utils.emptyfn};_utils.ajax(r)},connection.prototype.signup=function(e){var t=this,n=e.orgName||"",r=e.appName||"",o=e.appKey||"",i=e.success||EMPTYFN,s=e.error||EMPTYFN;if(!n&&!r&&o){var a=o.split("#");2===a.length&&(n=a[0],r=a[1])}if(n||r){var c=e.https||c,u=e.apiUrl+"/"+n+"/"+r+"/users",l={username:e.username,password:e.password,nickname:e.nickname||""},h=_utils.stringify(l);_utils.ajax({url:u,dataType:"json",data:h,success:i,error:function(n){return"https:"!=location.protocol&&t.isHttpDNS&&t.restIndex+1<t.restTotal?(t.restIndex++,void t.getRestFromHttpDNS(e,"signup")):(t.clear(),void s(n))}})}else s({type:_code.WEBIM_CONNCTION_APPKEY_NOT_ASSIGN_ERROR})},connection.prototype.open=function(e){var t=e.appKey,n=t.split("#")[0],r=t.split("#")[1];this.orgName=n,this.appName=r,e.accessToken&&(this.token=e.accessToken),e.xmppURL&&(this.url=_getXmppUrl(e.xmppURL,this.https)),"https:"!=location.protocol&&this.isHttpDNS?(this.dnsIndex=0,this.getHttpDNS(e,"login")):this.login(e)},connection.prototype.login=function(e){if(this.user=e.user,_validCheck(e,this)){var t=this;if(!t.isOpened())if(e.accessToken)e.access_token=e.accessToken,t.context.restTokenData=e,_login(e,t);else{var n=e.apiUrl,r=this.context.userId,o=e.pwd||"",i=this.context.appName,s=this.context.orgName;this.context.status=_code.STATUS_DOLOGIN_USERGRID;var a={grant_type:"password",username:r,password:o,timestamp:+new Date},c={url:n+"/"+s+"/"+i+"/token",dataType:"json",data:_utils.stringify(a),success:function(n){t.context.status=_code.STATUS_DOLOGIN_IM,t.context.restTokenData=n,e.success&&e.success(n),t.token=n.access_token,_login(n,t)}||_utils.emptyfn,error:function(n,r){return e.error&&e.error(),"https:"!=location.protocol&&t.isHttpDNS&&t.restIndex+1<t.restTotal?(t.restIndex++,void t.getRestFromHttpDNS(e,"login")):(t.clear(),void(n.error&&n.error_description?t.onError({type:_code.WEBIM_CONNCTION_OPEN_USERGRID_ERROR,data:n,xhr:r}):t.onError({type:_code.WEBIM_CONNCTION_OPEN_ERROR,data:n,xhr:r})))}||_utils.emptyfn};_utils.ajax(c)}}},connection.prototype.attach=function(e){if(_validCheck(e,this)){var t=(e=e||{}).accessToken||"";if(""==t)return void this.onError({type:_code.WEBIM_CONNCTION_TOKEN_NOT_ASSIGN_ERROR});var n=e.sid||"";if(""===n)return void this.onError({type:_code.WEBIM_CONNCTION_SESSIONID_NOT_ASSIGN_ERROR});var r=e.rid||"";if(""===r)return void this.onError({type:_code.WEBIM_CONNCTION_RID_NOT_ASSIGN_ERROR});var o=this.getStrophe();this.context.accessToken=t,this.context.stropheConn=o,this.context.status=_code.STATUS_DOLOGIN_IM;var i=this,s=this.context.jid,a=this.wait,c=this.hold,u=this.wind||5;o.attach(s,n,r,function(e,t){_loginCallback(e,t,i)},a,c,u)}},connection.prototype.close=function(e){this.logOut=!0,this.stopHeartBeat(),this.context.status==_code.STATUS_INIT||this.isClosed()||this.isClosing()||(this.context.status=_code.STATUS_CLOSING,this.context.stropheConn.disconnect(e))},connection.prototype.addHandler=function(e,t,n,r,o,i,s){this.context.stropheConn.addHandler(e,t,n,r,o,i,s)},connection.prototype.notifyVersion=function(e,t){_getJid({},this);var n=$iq({from:this.context.jid||"",to:this.domain,type:"result"}).c("query",{xmlns:"jabber:iq:version"}).c("name").t("easemob").up().c("version").t(_version).up().c("os").t("webim"),r=(e=e||_utils.emptyfn,t||this.onError);this.context.stropheConn.sendIQ(n.tree(),e,function(e){r({type:_code.WEBIM_CONNCTION_NOTIFYVERSION_ERROR,data:e})})},connection.prototype.handlePresence=function(e){if(!this.isClosed()){var t=e.getAttribute("from")||"",n=e.getAttribute("to")||"",r=e.getAttribute("type")||"",o=e.getAttribute("presence_type")||"",i=!1,s=!1,a=!1,c=!1,u={from:_parseNameFromJidFn(t),to:_parseNameFromJidFn(n),fromJid:t,toJid:n,type:r,chatroom:!!e.getElementsByTagName("roomtype").length},l=e.getElementsByTagName("show");if(l&&0<l.length){var h=l[0];u.show=Strophe.getText(h)}var p=e.getElementsByTagName("status");if(p&&0<p.length){var d=p[0];u.status=Strophe.getText(d),u.code=d.getAttribute("code")}var f=e.getElementsByTagName("priority");if(f&&0<f.length){var _=f[0];u.priority=Strophe.getText(_)}if((m=e.getElementsByTagName("error"))&&0<m.length){var m=m[0];u.error={code:m.getAttribute("code")}}if((g=e.getElementsByTagName("destroy"))&&0<g.length){var g=g[0];u.destroy=!0;var y=g.getElementsByTagName("reason");y&&0<y.length&&(u.reason=Strophe.getText(y[0]))}var v=e.getElementsByTagName("item");if(v&&0<v.length){var E=v[0],b=E.getAttribute("role"),N=E.getAttribute("jid"),S=E.getAttribute("affiliation");if("none"==b&&N){var T=_parseNameFromJidFn(N),O=E.getElementsByTagName("actor")[0].getAttribute("nick");u.actor=O,u.kicked=T}"moderator"==b&&"201"==u.code&&"owner"===S&&(u.type="createGroupACK",i=!0)}var x=e.getElementsByTagName("x");if(x&&0<x.length){var I=x[0].getElementsByTagName("apply"),C=x[0].getElementsByTagName("accept"),R=x[0].getElementsByTagName("item"),A=x[0].getElementsByTagName("decline"),M=x[0].getElementsByTagName("add_admin"),w=x[0].getElementsByTagName("remove_admin"),B=x[0].getElementsByTagName("add_mute"),k=x[0].getElementsByTagName("remove_mute");if(I&&0<I.length)c=!0,u.toNick=I[0].getAttribute("toNick"),u.type="joinGroupNotifications",j=(j=I[0].getAttribute("to").split("@")[0].split("_"))[j.length-1],u.gid=j;else if(C&&0<C.length)u.type="joinPublicGroupSuccess";else if(R&&0<R.length){S=R[0].getAttribute("affiliation"),b=R[0].getAttribute("role");if("member"==S||"participant"==b){s=!0,u.mid=u.fromJid.split("/"),u.mid=u.mid[u.mid.length-1],u.type="memberJoinPublicGroupSuccess";var D=e.getElementsByTagName("roomtype");if(D&&0<D.length)"chatroom"==(r=D[0].getAttribute("type"))&&(u.type="memberJoinChatRoomSuccess")}}else if(A&&A.length){a=!0;var j=A[0].getAttribute("fromNick"),L=_parseNameFromJidFn(A[0].getAttribute("from"));u.type="joinPublicGroupDeclined",u.owner=L,u.gid=j}else if(M&&0<M.length){j=_parseNameFromJidFn(M[0].getAttribute("mucjid")),L=_parseNameFromJidFn(M[0].getAttribute("from"));u.owner=L,u.gid=j,u.type="addAdmin"}else if(w&&0<w.length){j=_parseNameFromJidFn(w[0].getAttribute("mucjid")),L=_parseNameFromJidFn(w[0].getAttribute("from"));u.owner=L,u.gid=j,u.type="removeAdmin"}else if(B&&0<B.length){j=_parseNameFromJidFn(B[0].getAttribute("mucjid")),L=_parseNameFromJidFn(B[0].getAttribute("from"));u.owner=L,u.gid=j,u.type="addMute"}else if(k&&0<k.length){j=_parseNameFromJidFn(k[0].getAttribute("mucjid")),L=_parseNameFromJidFn(k[0].getAttribute("from"));u.owner=L,u.gid=j,u.type="removeMute"}}if(u.chatroom)u.presence_type=o,u.original_type=u.type,t.slice(t.lastIndexOf("/")+1)===this.context.userId&&(""!==u.type||u.code?("unavailable"===o||"unavailable"===u.type)&&(u.status?110==u.code?u.type="leaveChatRoom":u.error&&406==u.error.code&&(u.type="reachChatRoomCapacity"):u.type="leaveChatRoom"):u.type="joinChatRoomSuccess");else if(u.presence_type=o,u.original_type=r,/subscribe/.test(u.type));else if(""!=r||u.status||u.error||i||c||s||a){if("unavailable"===o||"unavailable"===r)if(u.destroy)u.type="deleteGroupChat";else if(307==u.code||321==u.code){var F=e.getAttribute("nick");u.type=F?"removedFromGroup":"leaveGroup"}}else;this.onPresence(u,e)}},connection.prototype.handlePing=function(e){if(!this.isClosed()){var t=e.getAttribute("id"),n=e.getAttribute("from"),r=e.getAttribute("to"),o=$iq({from:r,to:n,id:t,type:"result"});this.sendCommand(o.tree())}},connection.prototype.handleIq=function(){return!0},connection.prototype.handleIqPrivacy=function(e){0==e.getElementsByTagName("list").length||this.getBlacklist()},connection.prototype.handleIqRoster=function(e){var t=e.getAttribute("id"),n=e.getAttribute("from")||"",r=(_parseNameFromJidFn(n),this.context.jid),o=(this.context.userId,$iq({type:"result",id:t,from:r}));this.sendCommand(o.tree());var i=e.getElementsByTagName("query");if(i&&0<i.length){var s=i[0],a=_parseFriend(s,this,n);this.onRoster(a)}return!0},connection.prototype.handleMessage=function(e){var t=this;if(!this.isClosed()){var n=e.getAttribute("id")||"";this.cacheReceiptsMessage({id:n});var r=_parseResponseMessage(e);if(r.errorMsg)return void this.handlePresence(e);var o=e.getElementsByTagName("error"),i="",s="",a=!1;if(0<o.length){a=!0,i=o[0].getAttribute("code");var c=o[0].getElementsByTagName("text");s=c[0].textContent||c[0].text}var u=r.data;for(var l in u)if(u.hasOwnProperty(l)){if((R=u[l]).from&&R.to){var h,p=(R.from+"").toLowerCase(),d=(R.to+"").toLowerCase(),f=R.ext||{},_=e.getElementsByTagName("roomtype");h=_.length?_[0].getAttribute("type")||"chat":e.getAttribute("type")||"chat";var m=R.bodies;if(m&&0!=m.length){var g=R.bodies[0],y=g.type,v=!1;try{switch(y){case"txt":var E=g.msg;if("base64"===t.encrypt.type)E=atob(E);else if("aes"===t.encrypt.type){var b=CryptoJS.enc.Utf8.parse(t.encrypt.key),N=CryptoJS.enc.Utf8.parse(t.encrypt.iv),S=t.encrypt.mode.toLowerCase(),T={};"cbc"===S?T={iv:N,mode:CryptoJS.mode.CBC,padding:CryptoJS.pad.Pkcs7}:"ebc"===S&&(T={mode:CryptoJS.mode.ECB,padding:CryptoJS.pad.Pkcs7});var O=E;E=CryptoJS.AES.decrypt(O,b,T).toString(CryptoJS.enc.Utf8)}var x=_utils.parseTextMessage(E,WebIM.Emoji);if(x.isemoji)(R={id:n,type:h,from:p,to:d,delay:r.delayTimeStamp,data:x.body,ext:f}).delay||delete R.delay,R.error=a,R.errorText=s,R.errorCode=i,this.onEmojiMessage(R);else(R={id:n,type:h,from:p,to:d,delay:r.delayTimeStamp,data:E,ext:f}).delay||delete R.delay,R.error=a,R.errorText=s,R.errorCode=i,this.onTextMessage(R);break;case"img":var I=0,C=0;g.size&&(I=g.size.width,C=g.size.height),(R={id:n,type:h,from:p,to:d,url:"https:"!=location.protocol&&t.isHttpDNS?t.apiUrl+g.url.substr(g.url.indexOf("/",9)):g.url,secret:g.secret,filename:g.filename,thumb:g.thumb,thumb_secret:g.thumb_secret,file_length:g.file_length||"",width:I,height:C,filetype:g.filetype||"",accessToken:this.context.accessToken||"",ext:f,delay:r.delayTimeStamp}).delay||delete R.delay,R.error=a,R.errorText=s,R.errorCode=i,this.onPictureMessage(R);break;case"audio":(R={id:n,type:h,from:p,to:d,url:"https:"!=location.protocol&&t.isHttpDNS?t.apiUrl+g.url.substr(g.url.indexOf("/",9)):g.url,secret:g.secret,filename:g.filename,length:g.length||"",file_length:g.file_length||"",filetype:g.filetype||"",accessToken:this.context.accessToken||"",ext:f,delay:r.delayTimeStamp}).delay||delete R.delay,R.error=a,R.errorText=s,R.errorCode=i,this.onAudioMessage(R);break;case"file":(R={id:n,type:h,from:p,to:d,url:"https:"!=location.protocol&&t.isHttpDNS?t.apiUrl+g.url.substr(g.url.indexOf("/",9)):g.url,secret:g.secret,filename:g.filename,file_length:g.file_length,accessToken:this.context.accessToken||"",ext:f,delay:r.delayTimeStamp}).delay||delete R.delay,R.error=a,R.errorText=s,R.errorCode=i,this.onFileMessage(R);break;case"loc":(R={id:n,type:h,from:p,to:d,addr:g.addr,lat:g.lat,lng:g.lng,ext:f,delay:r.delayTimeStamp}).delay||delete R.delay,R.error=a,R.errorText=s,R.errorCode=i,this.onLocationMessage(R);break;case"video":(R={id:n,type:h,from:p,to:d,url:"https:"!=location.protocol&&t.isHttpDNS?t.apiUrl+g.url.substr(g.url.indexOf("/",9)):g.url,secret:g.secret,filename:g.filename,file_length:g.file_length,accessToken:this.context.accessToken||"",ext:f,delay:r.delayTimeStamp}).delay||delete R.delay,R.error=a,R.errorText=s,R.errorCode=i,this.onVideoMessage(R);break;case"cmd":var R;if((R={id:n,from:p,to:d,action:g.action,ext:f,delay:r.delayTimeStamp}).delay||delete R.delay,R.error=a,R.errorText=s,R.errorCode=i,"em_retrieve_dns"===g.action&&(v=!0),0!==g.action.indexOf("em_"))t.onCmdMessage(R);else{var A=new WebIM.message("read",t.getUniqueId());A.set({id:R.id,to:R.from,ext:{logo:"easemob"}}),t.send(A.body),t.handelSendQueue()}}if(t.delivery){var M=t.getUniqueId(),w=R.id,B=new WebIM.message("delivery",M);B.set({id:w,to:R.from}),t.send(B.body)}v&&this.close()}catch(t){this.onError({type:_code.WEBIM_CONNCTION_CALLBACK_INNER_ERROR,data:t})}}}}}},connection.prototype.handleDeliveredMessage=function(e){var t=e.id,n={mid:e.getElementsByTagName("body")[0].innerHTML};this.onDeliverdMessage(n),this.sendReceiptsMessage({id:t})},connection.prototype.handleAckedMessage=function(e){var t=e.id,n={mid:e.getElementsByTagName("body")[0].innerHTML};this.onReadMessage(n),this.sendReceiptsMessage({id:t})},connection.prototype.handleReceivedMessage=function(e){try{var t,n={mid:o=e.getElementsByTagName("received")[0].getAttribute("mid"),id:r=e.getElementsByTagName("body")[0].innerHTML};this.onReceivedMessage(n)}catch(t){this.onError({type:_code.WEBIM_CONNCTION_CALLBACK_INNER_ERROR,data:t})}var r,o,i=e.getElementsByTagName("received");if(0<i.length&&(r=i[0].childNodes&&0<i[0].childNodes.length?i[0].childNodes[0].nodeValue:i[0].innerHTML||i[0].innerText,o=i[0].getAttribute("mid")),_msgHash[r]){try{_msgHash[r].msg.success instanceof Function&&_msgHash[r].msg.success(r,o)}catch(t){this.onError({type:_code.WEBIM_CONNCTION_CALLBACK_INNER_ERROR,data:t})}delete _msgHash[r]}},connection.prototype.handleInviteMessage=function(e){var t=null,n=e.getElementsByTagName("invite"),r=e.getElementsByTagName("reason")[0].textContent,o=e.getAttribute("id")||"";if(this.sendReceiptsMessage({id:o}),n&&0<n.length){var i=n[0].getAttribute("from");t=_parseNameFromJidFn(i)}var s=e.getElementsByTagName("x"),a=null;if(s&&0<s.length)for(var c=0;c<s.length;c++)if("jabber:x:conference"===s[c].namespaceURI){var u=s[c].getAttribute("jid");a=_parseNameFromJidFn(u)}this.onInviteMessage({type:"invite",from:t,roomid:a,reason:r})},connection.prototype.handleMutedMessage=function(e){var t=e.id;this.onMutedMessage({mid:t})},connection.prototype.sendCommand=function(e){this.isOpened()?this.context.stropheConn.send(e):(this.unSendMsgArr.push(e),!this.offLineSendConnecting&&!this.logOut&&(this.offLineSendConnecting=!0,this.reconnect()),this.onError({type:_code.WEBIM_CONNCTION_DISCONNECTED,reconnect:!0}))},connection.prototype.getUniqueId=function(e){this.autoIncrement?this.autoIncrement++:this.autoIncrement=1;var t=new Date,n=new Date(2010,1,1),r=t.getTime()-n.getTime(),o=parseFloat(r).toString(16)+this.autoIncrement;return"string"==typeof e||"number"==typeof e?e+"_"+o:"WEBIM_"+o},connection.prototype.send=function(e){var t=this,n=e;if("txt"===n.type)if("base64"===this.encrypt.type)(n=_.clone(e)).msg=btoa(n.msg);else if("aes"===this.encrypt.type){n=_.clone(e);var r=CryptoJS.enc.Utf8.parse(this.encrypt.key),o=CryptoJS.enc.Utf8.parse(this.encrypt.iv),i=this.encrypt.mode.toLowerCase(),s={};"cbc"===i?s={iv:o,mode:CryptoJS.mode.CBC,padding:CryptoJS.pad.Pkcs7}:"ebc"===i&&(s={mode:CryptoJS.mode.ECB,padding:CryptoJS.pad.Pkcs7});var a=CryptoJS.AES.encrypt(n.msg,r,s);n.msg=a.toString()}if(this.isWindowSDK)WebIM.doQuery('{"type":"sendMessage","to":"'+n.to+'","message_type":"'+n.type+'","msg":"'+encodeURI(n.msg)+'","chatType":"'+n.chatType+'"}',function(){},function(){var e={data:{data:"send"},type:_code.WEBIM_MESSAGE_SED_ERROR};t.onError(e)});else if("[object Object]"===Object.prototype.toString.call(n)){var c=this.context.appKey||"",u=c+"_"+n.to+"@"+this.domain;n.group&&(u=c+"_"+n.to+"@conference."+this.domain),n.resource&&(u=u+"/"+n.resource),n.toJid=u,n.id=n.id||this.getUniqueId(),_msgHash[n.id]=new _message(n),_msgHash[n.id].send(this)}else"string"==typeof n&&_msgHash[n]&&_msgHash[n].send(this)},connection.prototype.addRoster=function(e){var t=_getJid(e,this),n=e.name||"",r=e.groups||"",o=$iq({type:"set"});if(o.c("query",{xmlns:"jabber:iq:roster"}),o.c("item",{jid:t,name:n}),r)for(var i=0;i<r.length;i++)o.c("group").t(r[i]).up();var s=e.success||_utils.emptyfn,a=e.error||_utils.emptyfn;this.context.stropheConn.sendIQ(o.tree(),s,a)},connection.prototype.removeRoster=function(e){var t=_getJid(e,this),n=$iq({type:"set"}).c("query",{xmlns:"jabber:iq:roster"}).c("item",{jid:t,subscription:"remove"}),r=e.success||_utils.emptyfn,o=e.error||_utils.emptyfn;this.context.stropheConn.sendIQ(n,r,o)},connection.prototype.getRoster=function(e){var t=$iq({type:"get"}).c("query",{xmlns:"jabber:iq:roster"}),n=(e=e||{}).success||this.onRoster,r=e.error||this.onError;this.isOpened()?this.context.stropheConn.sendIQ(t.tree(),function(e){var t=[],r=e.getElementsByTagName("query");if(r&&0<r.length){var o=r[0];t=_parseFriend(o)}n(t,e)},function(e){r({type:_code.WEBIM_CONNCTION_GETROSTER_ERROR,data:e})}):r({type:_code.WEBIM_CONNCTION_DISCONNECTED})},connection.prototype.subscribe=function(e){var t=_getJid(e,this),n=$pres({to:t,type:"subscribe"});e.message&&n.c("status").t(e.message).up(),e.nick&&n.c("nick",{xmlns:"http://jabber.org/protocol/nick"}).t(e.nick),this.sendCommand(n.tree())},connection.prototype.subscribed=function(e){var t=_getJid(e,this),n=$pres({to:t,type:"subscribed"});e.message&&n.c("status").t(e.message).up(),this.sendCommand(n.tree())},connection.prototype.unsubscribe=function(e){var t=_getJid(e,this),n=$pres({to:t,type:"unsubscribe"});e.message&&n.c("status").t(e.message),this.sendCommand(n.tree())},connection.prototype.unsubscribed=function(e){var t=_getJid(e,this),n=$pres({to:t,type:"unsubscribed"});e.message&&n.c("status").t(e.message).up(),this.sendCommand(n.tree())},connection.prototype.joinPublicGroup=function(e){var t=this.context.appKey+"_"+e.roomId+"@conference."+this.domain+"/"+this.context.userId,n=e.success||_utils.emptyfn,r=e.error||_utils.emptyfn,o=$pres({from:this.context.jid,to:t}).c("x",{xmlns:Strophe.NS.MUC});this.context.stropheConn.sendIQ(o.tree(),n,function(e){r({type:_code.WEBIM_CONNCTION_JOINROOM_ERROR,data:e})})},connection.prototype.listRooms=function(e){var t=$iq({to:e.server||"conference."+this.domain,from:this.context.jid,type:"get"}).c("query",{xmlns:Strophe.NS.DISCO_ITEMS}),n=e.success||_utils.emptyfn,r=e.error||this.onError,o=e.error||_utils.emptyfn;this.context.stropheConn.sendIQ(t.tree(),function(e){var t;t=_parseRoom(e);try{n(t)}catch(t){r({type:_code.WEBIM_CONNCTION_GETROOM_ERROR,data:t})}},function(e){o({type:_code.WEBIM_CONNCTION_GETROOM_ERROR,data:e})})},connection.prototype.queryRoomMember=function(e){this.domain;var t=[],n=$iq({to:this.context.appKey+"_"+e.roomId+"@conference."+this.domain,type:"get"}).c("query",{xmlns:Strophe.NS.MUC+"#admin"}).c("item",{affiliation:"member"}),r=e.success||_utils.emptyfn,o=e.error||_utils.emptyfn;this.context.stropheConn.sendIQ(n.tree(),function(e){var n=e.getElementsByTagName("item");if(n)for(var o=0;o<n.length;o++){var i={jid:n[o].getAttribute("jid"),affiliation:"member"};t.push(i)}r(t)},function(e){o({type:_code.WEBIM_CONNCTION_GETROOMMEMBER_ERROR,data:e})})},connection.prototype.queryRoomInfo=function(e){var t=this.domain,n=$iq({to:this.context.appKey+"_"+e.roomId+"@conference."+t,type:"get"}).c("query",{xmlns:Strophe.NS.DISCO_INFO}),r=e.success||_utils.emptyfn,o=[],i=e.error||_utils.emptyfn;this.context.stropheConn.sendIQ(n.tree(),function(e){var n="",i=e.getElementsByTagName("feature");i&&(n=i[1].getAttribute("var")+"|"+i[3].getAttribute("var")+"|"+i[4].getAttribute("var")),"muc_public|muc_membersonly|muc_notallowinvites"==n?n="PUBLIC_JOIN_APPROVAL":"muc_public|muc_open|muc_notallowinvites"==n?n="PUBLIC_JOIN_OPEN":"muc_hidden|muc_membersonly|muc_allowinvites"==n?n="PRIVATE_MEMBER_INVITE":"muc_hidden|muc_membersonly|muc_notallowinvites"==n&&(n="PRIVATE_OWNER_INVITE");var s=e.getElementsByTagName("field"),a={};if(s){for(var c=0;c<s.length;c++){var u=s[c],l=u.getAttribute("var"),h=l.split("_")[1];switch(l){case"muc#roominfo_occupants":case"muc#roominfo_maxusers":case"muc#roominfo_affiliations":case"muc#roominfo_description":a[h]=u.textContent||u.text||"";break;case"muc#roominfo_owner":var p={jid:(u.textContent||u.text)+"@"+t,affiliation:"owner"};o.push(p),a[h]=u.textContent||u.text}}a.name=e.getElementsByTagName("identity")[0].getAttribute("name")}r(n,o,a)},function(e){i({type:_code.WEBIM_CONNCTION_GETROOMINFO_ERROR,data:e})})},connection.prototype.queryRoomOccupants=function(e){var t=e.success||_utils.emptyfn,n=e.error||_utils.emptyfn,r={xmlns:Strophe.NS.DISCO_ITEMS},o=$iq({from:this.context.jid,to:this.context.appKey+"_"+e.roomId+"@conference."+this.domain,type:"get"}).c("query",r);this.context.stropheConn.sendIQ(o.tree(),function(e){var n;n=_parseRoomOccupants(e),t(n)},function(e){n({type:_code.WEBIM_CONNCTION_GETROOMOCCUPANTS_ERROR,data:e})})},connection.prototype.setUserSig=function(e){var t=$pres({xmlns:"jabber:client"});e=e||"",t.c("status").t(e),this.sendCommand(t.tree())},connection.prototype.setPresence=function(e,t){var n=$pres({xmlns:"jabber:client"});e&&(t?(n.c("show").t(e),n.up().c("status").t(t)):n.c("show").t(e)),this.sendCommand(n.tree())},connection.prototype.getPresence=function(){var e=$pres({xmlns:"jabber:client"});this.sendCommand(e.tree())},connection.prototype.ping=function(e){var t=_getJid(e=e||{},this),n=$iq({from:this.context.jid||"",to:t,type:"get"}).c("ping",{xmlns:"urn:xmpp:ping"}),r=e.success||_utils.emptyfn,o=e.error||this.onError;this.isOpened()?this.context.stropheConn.sendIQ(n.tree(),r,function(e){o({type:_code.WEBIM_CONNCTION_PING_ERROR,data:e})}):o({type:_code.WEBIM_CONNCTION_DISCONNECTED})},connection.prototype.isOpened=function(){return this.context.status==_code.STATUS_OPENED},connection.prototype.isOpening=function(){var e=this.context.status;return e==_code.STATUS_DOLOGIN_USERGRID||e==_code.STATUS_DOLOGIN_IM},connection.prototype.isClosing=function(){return this.context.status==_code.STATUS_CLOSING},connection.prototype.isClosed=function(){return this.context.status==_code.STATUS_CLOSED},connection.prototype.clear=function(){var e=this.context.appKey;if(this.errorType!=_code.WEBIM_CONNCTION_DISCONNECTED&&this.logOut&&(this.unSendMsgArr=[],this.offLineSendConnecting=!1,this.context={status:_code.STATUS_INIT,appKey:e}),this.intervalId&&clearInterval(this.intervalId),this.restIndex=0,this.xmppIndex=0,this.errorType==_code.WEBIM_CONNCTION_CLIENT_LOGOUT||-1==this.errorType){var t={data:{data:"logout"},type:_code.WEBIM_CONNCTION_CLIENT_LOGOUT};this.onError(t)}},connection.prototype.getChatRooms=function(e){if(_utils.isCanSetRequestHeader){var t=this,n=e.accessToken||this.context.accessToken;if(n){var r=e.apiUrl,o=this.context.appName,i=this.context.orgName;if(!o||!i)return void t.onError({type:_code.WEBIM_CONNCTION_AUTH_ERROR});var s={url:r+"/"+i+"/"+o+"/chatrooms",dataType:"json",type:"GET",headers:{Authorization:"Bearer "+n},data:{pagenum:parseInt(e.pagenum)||1,pagesize:parseInt(e.pagesize)||20},success:function(t){"function"==typeof e.success&&e.success(t)}||_utils.emptyfn,error:function(e,n){e.error&&e.error_description&&t.onError({type:_code.WEBIM_CONNCTION_LOAD_CHATROOM_ERROR,msg:e.error_description,data:e,xhr:n})}||_utils.emptyfn};_utils.ajax(s)}else t.onError({type:_code.WEBIM_CONNCTION_TOKEN_NOT_ASSIGN_ERROR})}else t.onError({type:_code.WEBIM_CONNCTION_NOT_SUPPORT_CHATROOM_ERROR})},connection.prototype.joinChatRoom=function(e){var t=this.context.appKey+"_"+e.roomId+"@conference."+this.domain+"/"+this.context.userId,n=e.success||_utils.emptyfn,r=e.error||_utils.emptyfn,o=$pres({from:this.context.jid,to:t}).c("x",{xmlns:Strophe.NS.MUC+"#user"}).c("item",{affiliation:"member",role:"participant"}).up().up().c("roomtype",{xmlns:"easemob:x:roomtype",type:"chatroom"});this.context.stropheConn.sendIQ(o.tree(),n,function(e){r({type:_code.WEBIM_CONNCTION_JOINCHATROOM_ERROR,data:e})})},connection.prototype.quitChatRoom=function(e){var t=this.context.appKey+"_"+e.roomId+"@conference."+this.domain+"/"+this.context.userId,n=e.success||_utils.emptyfn,r=e.error||_utils.emptyfn,o=$pres({from:this.context.jid,to:t,type:"unavailable"}).c("x",{xmlns:Strophe.NS.MUC+"#user"}).c("item",{affiliation:"none",role:"none"}).up().up().c("roomtype",{xmlns:"easemob:x:roomtype",type:"chatroom"});this.context.stropheConn.sendIQ(o.tree(),n,function(e){r({type:_code.WEBIM_CONNCTION_QUITCHATROOM_ERROR,data:e})})},connection.prototype._onReceiveInviteFromGroup=function(info){info=eval("("+info+")");var self=this,options={title:"Group invitation",msg:info.user+" invites you to join into group:"+info.group_id,agree:function(){WebIM.doQuery('{"type":"acceptInvitationFromGroup","id":"'+info.group_id+'","user":"'+info.user+'"}',function(){},function(e,t){var n={data:{data:"acceptInvitationFromGroup error:"+t},type:_code.WEBIM_CONNECTION_ACCEPT_INVITATION_FROM_GROUP};self.onError(n)})},reject:function(){WebIM.doQuery('{"type":"declineInvitationFromGroup","id":"'+info.group_id+'","user":"'+info.user+'"}',function(){},function(e,t){var n={data:{data:"declineInvitationFromGroup error:"+t},type:_code.WEBIM_CONNECTION_DECLINE_INVITATION_FROM_GROUP};self.onError(n)})}};this.onConfirmPop(options)},connection.prototype._onReceiveInviteAcceptionFromGroup=function(info){info=eval("("+info+")");var options={title:"Group invitation response",msg:info.user+" agreed to join into group:"+info.group_id,agree:function(){}};this.onConfirmPop(options)},connection.prototype._onReceiveInviteDeclineFromGroup=function(info){info=eval("("+info+")");var options={title:"Group invitation response",msg:info.user+" rejected to join into group:"+info.group_id,agree:function(){}};this.onConfirmPop(options)},connection.prototype._onAutoAcceptInvitationFromGroup=function(info){info=eval("("+info+")");var options={title:"Group invitation",msg:"You had joined into the group:"+info.group_name+" automatically.Inviter:"+info.user,agree:function(){}};this.onConfirmPop(options)},connection.prototype._onLeaveGroup=function(info){info=eval("("+info+")");var options={title:"Group notification",msg:"You have been out of the group:"+info.group_id+".Reason:"+info.msg,agree:function(){}};this.onConfirmPop(options)},connection.prototype._onReceiveJoinGroupApplication=function(info){info=eval("("+info+")");var self=this,options={title:"Group join application",msg:info.user+" applys to join into group:"+info.group_id,agree:function(){WebIM.doQuery('{"type":"acceptJoinGroupApplication","id":"'+info.group_id+'","user":"'+info.user+'"}',function(){},function(e,t){var n={data:{data:"acceptJoinGroupApplication error:"+t},type:_code.WEBIM_CONNECTION_ACCEPT_JOIN_GROUP};self.onError(n)})},reject:function(){WebIM.doQuery('{"type":"declineJoinGroupApplication","id":"'+info.group_id+'","user":"'+info.user+'"}',function(){},function(e,t){var n={data:{data:"declineJoinGroupApplication error:"+t},type:_code.WEBIM_CONNECTION_DECLINE_JOIN_GROUP};self.onError(n)})}};this.onConfirmPop(options)},connection.prototype._onReceiveAcceptionFromGroup=function(info){info=eval("("+info+")");var options={title:"Group notification",msg:"You had joined into the group:"+info.group_name+".",agree:function(){}};this.onConfirmPop(options)},connection.prototype._onReceiveRejectionFromGroup=function(){info=eval("("+info+")");var options={title:"Group notification",msg:"You have been rejected to join into the group:"+info.group_name+".",agree:function(){}};this.onConfirmPop(options)},connection.prototype._onUpdateMyGroupList=function(e){this.onUpdateMyGroupList(e)},connection.prototype._onUpdateMyRoster=function(e){this.onUpdateMyRoster(e)},connection.prototype.reconnect=function(e){var t=this;e&&t.xmppIndex++,setTimeout(function(){_login(t.context.restTokenData,t)},1e3*(0==this.autoReconnectNumTotal?0:this.autoReconnectInterval)),this.autoReconnectNumTotal++},connection.prototype.closed=function(){var e={data:{data:"Closed error"},type:_code.WEBIM_CONNECTION_CLOSED};this.onError(e)},connection.prototype.getBlacklist=function(e){e=e||{};var t=$iq({type:"get"}),n=e.success||_utils.emptyfn,r=e.error||_utils.emptyfn,o=this;t.c("query",{xmlns:"jabber:iq:privacy"}).c("list",{name:"special"}),this.context.stropheConn.sendIQ(t.tree(),function(e){o.onBlacklistUpdate(_parsePrivacy(e)),n()},function(){o.onBlacklistUpdate([]),r()})},connection.prototype.addToBlackList=function(e){for(var t=$iq({type:"set"}),n=e.list||{},r=e.type||"jid",o=e.success||_utils.emptyfn,i=e.error||_utils.emptyfn,s=t.c("query",{xmlns:"jabber:iq:privacy"}).c("list",{name:"special"}),a=Object.keys(n),c=a.length,u=2,l=0;l<c;l++){var h=n[a[l]],p=(r=h.type||"jid",h.jid);s=s.c("item",{action:"deny",order:u++,type:r,value:p}).c("message"),l!==c-1&&(s=s.up().up())}this.context.stropheConn.sendIQ(s.tree(),o,i)},connection.prototype.removeFromBlackList=function(e){for(var t=$iq({type:"set"}),n=e.list||{},r=e.success||_utils.emptyfn,o=e.error||_utils.emptyfn,i=t.c("query",{xmlns:"jabber:iq:privacy"}).c("list",{name:"special"}),s=Object.keys(n),a=s.length,c=0;c<a;c++){var u=n[s[c]],l=u.type||"jid",h=u.jid,p=u.order;i=i.c("item",{action:"deny",order:p,type:l,value:h}).c("message"),c!==a-1&&(i=i.up().up())}this.context.stropheConn.sendIQ(i.tree(),r,o)},connection.prototype._getGroupJid=function(e){return(this.context.appKey||"")+"_"+e+"@conference."+this.domain},connection.prototype.addToGroupBlackList=function(e){var t=e.success||_utils.emptyfn,n=e.error||_utils.emptyfn,r=_getJid(e,this),o=this._getGroupJid(e.roomId),i=$iq({type:"set",to:o});i.c("query",{xmlns:"http://jabber.org/protocol/muc#admin"}).c("item",{affiliation:"outcast",jid:r}),this.context.stropheConn.sendIQ(i.tree(),t,n)},connection.prototype.getGroupBlacklist=function(e){var t=e.success||_utils.emptyfn,n=e.error||_utils.emptyfn,r=this._getGroupJid(e.roomId),o=$iq({type:"get",to:r});o.c("query",{xmlns:"http://jabber.org/protocol/muc#admin"}).c("item",{affiliation:"outcast"}),this.context.stropheConn.sendIQ(o.tree(),function(e){t(_parseGroupBlacklist(e))},function(){n()})},connection.prototype.removeGroupMemberFromBlacklist=function(e){var t=e.success||_utils.emptyfn,n=e.error||_utils.emptyfn,r=_getJid(e,this),o=this._getGroupJid(e.roomId),i=$iq({type:"set",to:o});i.c("query",{xmlns:"http://jabber.org/protocol/muc#admin"}).c("item",{affiliation:"none",jid:r}),this.context.stropheConn.sendIQ(i.tree(),function(){t()},function(){n()})},connection.prototype.changeGroupSubject=function(e){var t=e.success||_utils.emptyfn,n=e.error||_utils.emptyfn,r=this._getGroupJid(e.roomId),o=$iq({type:"set",to:r});o.c("query",{xmlns:"http://jabber.org/protocol/muc#owner"}).c("x",{type:"submit",xmlns:"jabber:x:data"}).c("field",{var:"FORM_TYPE"}).c("value").t("http://jabber.org/protocol/muc#roomconfig").up().up().c("field",{var:"muc#roomconfig_roomname"}).c("value").t(e.subject).up().up().c("field",{var:"muc#roomconfig_roomdesc"}).c("value").t(e.description),this.context.stropheConn.sendIQ(o.tree(),function(){t()},function(){n()})},connection.prototype.destroyGroup=function(e){var t=e.success||_utils.emptyfn,n=e.error||_utils.emptyfn,r=this._getGroupJid(e.roomId),o=$iq({type:"set",to:r});o.c("query",{xmlns:"http://jabber.org/protocol/muc#owner"}).c("destroy").c("reason").t(e.reason||""),this.context.stropheConn.sendIQ(o.tree(),function(){t()},function(){n()})},connection.prototype.leaveGroupBySelf=function(e){var t=this,n=e.success||_utils.emptyfn,r=e.error||_utils.emptyfn,o=_getJid(e,this),i=this._getGroupJid(e.roomId),s=$iq({type:"set",to:i});s.c("query",{xmlns:"http://jabber.org/protocol/muc#admin"}).c("item",{affiliation:"none",jid:o}),this.context.stropheConn.sendIQ(s.tree(),function(e){n(e);var r=$pres({type:"unavailable",to:i+"/"+t.context.userId});t.sendCommand(r.tree())},function(e){r(e)})},connection.prototype.leaveGroup=function(e){for(var t=e.success||_utils.emptyfn,n=e.error||_utils.emptyfn,r=e.list||[],o=this._getGroupJid(e.roomId),i=$iq({type:"set",to:o}),s=i.c("query",{xmlns:"http://jabber.org/protocol/muc#admin"}),a=Object.keys(r),c=a.length,u=0;u<c;u++){var l=r[a[u]],h=_getJidByName(l,this);s=s.c("item",{affiliation:"none",jid:h}).up().c("item",{role:"none",jid:h}).up()}this.context.stropheConn.sendIQ(i.tree(),function(e){t(e)},function(e){n(e)})},connection.prototype.addGroupMembers=function(e){for(var t=e.success||_utils.emptyfn,n=e.error||_utils.emptyfn,r=e.list||[],o=this._getGroupJid(e.roomId),i=$iq({type:"set",to:o}),s=i.c("query",{xmlns:"http://jabber.org/protocol/muc#admin"}),a=r.length,c=0;c<a;c++){var u=r[c],l=_getJidByName(u,this);s=s.c("item",{affiliation:"member",jid:l}).up();var h=$msg({to:o}).c("x",{xmlns:"http://jabber.org/protocol/muc#user"}).c("invite",{to:l}).c("reason").t(e.reason||"");this.sendCommand(h.tree())}this.context.stropheConn.sendIQ(i.tree(),function(e){t(e)},function(e){n(e)})},connection.prototype.acceptInviteFromGroup=function(e){e.success=function(){},this.addGroupMembers(e)},connection.prototype.rejectInviteFromGroup=function(){},connection.prototype.createGroupAsync=function(e){var t=e.from,n=this,r=this._getGroupJid(t),o=(this.context.userId,this.groupOption),i=e.success||_utils.emptyfn,s=$iq({type:"get",to:r}).c("query",{xmlns:"http://jabber.org/protocol/muc#owner"});n.context.stropheConn.sendIQ(s.tree(),function(e){if("setAttribute"in e){var s=e.getElementsByTagName("x")[0];s.setAttribute("type","submit")}else Strophe.forEachChild(e,"x",function(e){e.setAttribute("type","submit")});Strophe.info("step 5 ----------"),Strophe.forEachChild(s,"field",function(e){var t=e.getAttribute("var"),n=e.getElementsByTagName("value")[0];switch(Strophe.info(t),t){case"muc#roomconfig_maxusers":_setText(n,o.optionsMaxUsers||200);break;case"muc#roomconfig_roomname":_setText(n,o.subject||"");break;case"muc#roomconfig_roomdesc":_setText(n,o.description||"");break;case"muc#roomconfig_publicroom":_setText(n,+o.optionsPublic);break;case"muc#roomconfig_membersonly":_setText(n,+o.optionsMembersOnly);break;case"muc#roomconfig_moderatedroom":_setText(n,+o.optionsModerate);break;case"muc#roomconfig_persistentroom":_setText(n,1);break;case"muc#roomconfig_allowinvites":_setText(n,+o.optionsAllowInvites);break;case"muc#roomconfig_allowvisitornickchange":case"muc#roomconfig_allowvisitorstatus":case"allow_private_messages":_setText(n,0);break;case"allow_private_messages_from_visitors":_setText(n,"nobody")}});var a=$iq({to:r,type:"set"}).c("query",{xmlns:"http://jabber.org/protocol/muc#owner"}).cnode(s);n.context.stropheConn.sendIQ(a.tree(),function(){n.addGroupMembers({list:o.members,roomId:t}),i(o)},function(){})},function(){})},connection.prototype.createGroup=function(e){this.groupOption=e;var t=+new Date,n=this._getGroupJid(t)+"/"+this.context.userId,r=$pres({to:n}).c("x",{xmlns:"http://jabber.org/protocol/muc"}).up().c("create",{xmlns:"http://jabber.org/protocol/muc"}).up();this.sendCommand(r.tree())},connection.prototype.createGroupNew=function(e){e.data.owner=this.user,e.data.invite_need_confirm=!1;var t={url:this.apiUrl+"/"+this.orgName+"/"+this.appName+"/chatgroups",dataType:"json",type:"POST",data:JSON.stringify(e.data),headers:{Authorization:"Bearer "+this.token,"Content-Type":"application/json"}};t.success=function(t){e.success(t),this.onCreateGroup(t)}.bind(this),t.error=e.error||_utils.emptyfn,WebIM.utils.ajax(t)},connection.prototype.blockGroup=function(e){var t=e.groupId;t="notification_ignore_"+t;var n={entities:[]};n.entities[0]={},n.entities[0][t]=!0;var r={type:"PUT",url:this.apiUrl+"/"+this.orgName+"/"+this.appName+"/users/"+this.user,data:JSON.stringify(n),headers:{Authorization:"Bearer "+this.token,"Content-Type":"application/json"}};r.success=e.success||_utils.emptyfn,r.error=e.error||_utils.emptyfn,WebIM.utils.ajax(r)},connection.prototype.joinGroup=function(e){var t={url:this.apiUrl+"/"+this.orgName+"/"+this.appName+"/chatgroups/"+e.groupId+"/apply",type:"POST",dataType:"json",data:JSON.stringify({message:"join group"}),headers:{Authorization:"Bearer "+this.token,"Content-Type":"application/json"}};t.success=e.success||_utils.emptyfn,t.error=e.error||_utils.emptyfn,WebIM.utils.ajax(t)},connection.prototype.listGroups=function(e){var t=[];if(t.limit=e.limit,t.cursor=e.cursor,t.cursor||delete t.cursor,isNaN(e.limit))throw'The parameter "limit" should be a number';var n={url:this.apiUrl+"/"+this.orgName+"/"+this.appName+"/publicchatgroups",type:"GET",dataType:"json",data:t,headers:{Authorization:"Bearer "+this.token,"Content-Type":"application/json"}};n.success=e.success||_utils.emptyfn,n.error=e.error||_utils.emptyfn,WebIM.utils.ajax(n)},connection.prototype.getGroupInfo=function(e){var t={url:this.apiUrl+"/"+this.orgName+"/"+this.appName+"/chatgroups/"+e.groupId,type:"GET",dataType:"json",headers:{Authorization:"Bearer "+this.token,"Content-Type":"application/json"}};t.success=e.success||_utils.emptyfn,t.error=e.error||_utils.emptyfn,WebIM.utils.ajax(t)},connection.prototype.getGroup=function(e){var t={url:this.apiUrl+"/"+this.orgName+"/"+this.appName+"/users/"+this.user+"/joined_chatgroups",dataType:"json",type:"GET",headers:{Authorization:"Bearer "+this.token,"Content-Type":"application/json"}};t.success=e.success||_utils.emptyfn,t.error=e.error||_utils.emptyfn,WebIM.utils.ajax(t)},connection.prototype.listGroupMember=function(e){if(isNaN(e.pageNum)||0>=e.pageNum)throw'The parameter "pageNum" should be a positive number';if(isNaN(e.pageSize)||0>=e.pageSize)throw'The parameter "pageSize" should be a positive number';if(null===e.groupId&&void 0===e.groupId)throw'The parameter "groupId" should be added';var t=[],n=e.groupId;t.pagenum=e.pageNum,t.pagesize=e.pageSize;var r={url:this.apiUrl+"/"+this.orgName+"/"+this.appName+"/chatgroups/"+n+"/users",dataType:"json",type:"GET",data:t,headers:{Authorization:"Bearer "+this.token,"Content-Type":"application/json"}};r.success=e.success||_utils.emptyfn,r.error=e.error||_utils.emptyfn,WebIM.utils.ajax(r)},connection.prototype.mute=function(e){var t=e.groupId,n={usernames:[e.username],mute_duration:e.muteDuration},r={url:this.apiUrl+"/"+this.orgName+"/"+this.appName+"/chatgroups/"+t+"/mute",dataType:"json",type:"POST",headers:{Authorization:"Bearer "+this.token,"Content-Type":"application/json"},data:JSON.stringify(n)};r.success=e.success||_utils.emptyfn,r.error=e.error||_utils.emptyfn,WebIM.utils.ajax(r)},connection.prototype.removeMute=function(e){var t=e.groupId,n=e.username,r={url:this.apiUrl+"/"+this.orgName+"/"+this.appName+"/chatgroups/"+t+"/mute/"+n,dataType:"json",type:"DELETE",headers:{Authorization:"Bearer "+this.token,"Content-Type":"application/json"}};r.success=e.success||_utils.emptyfn,r.error=e.error||_utils.emptyfn,WebIM.utils.ajax(r)},connection.prototype.getGroupAdmin=function(e){var t=e.groupId,n={url:this.apiUrl+"/"+this.orgName+"/"+this.appName+"/chatgroups/"+t+"/admin",dataType:"json",type:"GET",headers:{Authorization:"Bearer "+this.token,"Content-Type":"application/json"}};n.success=e.success||_utils.emptyfn,n.error=e.error||_utils.emptyfn,WebIM.utils.ajax(n)},connection.prototype.getMuted=function(e){var t=e.groupId,n={url:this.apiUrl+"/"+this.orgName+"/"+this.appName+"/chatgroups/"+t+"/mute",dataType:"json",type:"GET",headers:{Authorization:"Bearer "+this.token,"Content-Type":"application/json"}};n.success=e.success||_utils.emptyfn,n.error=e.error||_utils.emptyfn,WebIM.utils.ajax(n)},connection.prototype.setAdmin=function(e){var t=e.groupId,n={newadmin:e.username},r={url:this.apiUrl+"/"+this.orgName+"/"+this.appName+"/chatgroups/"+t+"/admin",type:"POST",dataType:"json",data:JSON.stringify(n),headers:{Authorization:"Bearer "+this.token,"Content-Type":"application/json"}};r.success=e.success||_utils.emptyfn,r.error=e.error||_utils.emptyfn,WebIM.utils.ajax(r)},connection.prototype.removeAdmin=function(e){var t=e.groupId,n=e.username,r={url:this.apiUrl+"/"+this.orgName+"/"+this.appName+"/chatgroups/"+t+"/admin/"+n,type:"DELETE",dataType:"json",headers:{Authorization:"Bearer "+this.token,"Content-Type":"application/json"}};r.success=e.success||_utils.emptyfn,r.error=e.error||_utils.emptyfn,WebIM.utils.ajax(r)},connection.prototype.agreeJoinGroup=function(e){var t=e.groupId,n={applicant:e.applicant,verifyResult:!0,reason:"no clue"},r={url:this.apiUrl+"/"+this.orgName+"/"+this.appName+"/chatgroups/"+t+"/apply_verify",type:"POST",dataType:"json",data:JSON.stringify(n),headers:{Authorization:"Bearer "+this.token,"Content-Type":"application/json"}};r.success=e.success||_utils.emptyfn,r.error=e.error||_utils.emptyfn,WebIM.utils.ajax(r)},connection.prototype.rejectJoinGroup=function(e){var t=e.groupId,n={applicant:e.applicant,verifyResult:!1,reason:"no clue"},r={url:this.apiUrl+"/"+this.orgName+"/"+this.appName+"/chatgroups/"+t+"/apply_verify",type:"POST",dataType:"json",data:JSON.stringify(n),headers:{Authorization:"Bearer "+this.token,"Content-Type":"application/json"}};r.success=e.success||_utils.emptyfn,r.error=e.error||_utils.emptyfn,WebIM.utils.ajax(r)},connection.prototype.groupBlockSingle=function(e){var t=e.groupId,n=e.username,r={url:this.apiUrl+"/"+this.orgName+"/"+this.appName+"/chatgroups/"+t+"/blocks/users/"+n,type:"POST",dataType:"json",headers:{Authorization:"Bearer "+this.token,"Content-Type":"application/json"}};r.success=e.success||_utils.emptyfn,r.error=e.error||_utils.emptyfn,WebIM.utils.ajax(r)},connection.prototype.groupBlockMulti=function(e){var t=e.groupId,n=e.usernames,r={url:this.apiUrl+"/"+this.orgName+"/"+this.appName+"/chatgroups/"+t+"/blocks/users",data:JSON.stringify({usernames:n}),type:"POST",dataType:"json",headers:{Authorization:"Bearer "+this.token,"Content-Type":"application/json"}};r.success=e.success||_utils.emptyfn,r.error=e.error||_utils.emptyfn,WebIM.utils.ajax(r)},connection.prototype.removeGroupBlockSingle=function(e){var t=e.groupId,n=e.username,r={url:this.apiUrl+"/"+this.orgName+"/"+this.appName+"/chatgroups/"+t+"/blocks/users/"+n,type:"DELETE",dataType:"json",headers:{Authorization:"Bearer "+this.token,"Content-Type":"application/json"}};r.success=e.success||_utils.emptyfn,r.error=e.error||_utils.emptyfn,WebIM.utils.ajax(r)},connection.prototype.removeGroupBlockMulti=function(e){var t=e.groupId,n=e.username.join(","),r={url:this.apiUrl+"/"+this.orgName+"/"+this.appName+"/chatgroups/"+t+"/blocks/users/"+n,type:"DELETE",dataType:"json",headers:{Authorization:"Bearer "+this.token,"Content-Type":"application/json"}};r.success=e.success||_utils.emptyfn,r.error=e.error||_utils.emptyfn,WebIM.utils.ajax(r)},connection.prototype.dissolveGroup=function(e){var t=e.groupId,n={url:this.apiUrl+"/"+this.orgName+"/"+this.appName+"/chatgroups/"+t+"?version=v3",type:"DELETE",dataType:"json",headers:{Authorization:"Bearer "+this.token,"Content-Type":"application/json"}};n.success=e.success||_utils.emptyfn,n.error=e.error||_utils.emptyfn,WebIM.utils.ajax(n)},connection.prototype.getGroupBlacklistNew=function(e){var t=e.groupId,n={url:this.apiUrl+"/"+this.orgName+"/"+this.appName+"/chatgroups/"+t+"/blocks/users",type:"GET",dataType:"json",headers:{Authorization:"Bearer "+this.token,"Content-Type":"application/json"}};n.success=e.success||_utils.emptyfn,n.error=e.error||_utils.emptyfn,WebIM.utils.ajax(n)},connection.prototype.quitGroup=function(e){var t=e.groupId,n={url:this.apiUrl+"/"+this.orgName+"/"+this.appName+"/chatgroups/"+t+"/quit",type:"DELETE",dataType:"json",headers:{Authorization:"Bearer "+this.token,"Content-Type":"application/json"}};n.success=e.success||_utils.emptyfn,n.error=e.error||_utils.emptyfn,WebIM.utils.ajax(n)},connection.prototype.modifyGroup=function(e){var t=e.groupId,n={groupname:e.groupName,description:e.description},r={url:this.apiUrl+"/"+this.orgName+"/"+this.appName+"/chatgroups/"+t,type:"PUT",data:JSON.stringify(n),dataType:"json",headers:{Authorization:"Bearer "+this.token,"Content-Type":"application/json"}};r.success=e.success||_utils.emptyfn,r.error=e.error||_utils.emptyfn,WebIM.utils.ajax(r)},connection.prototype.removeSingleGroupMember=function(e){var t=e.groupId,n=e.username,r={url:this.apiUrl+"/"+this.orgName+"/"+this.appName+"/chatgroups/"+t+"/users/"+n,type:"DELETE",dataType:"json",headers:{Authorization:"Bearer "+this.token,"Content-Type":"application/json"}};r.success=e.success||_utils.emptyfn,r.error=e.error||_utils.emptyfn,WebIM.utils.ajax(r)},connection.prototype.removeMultiGroupMember=function(e){var t=e.groupId,n=e.users.join(","),r={url:this.apiUrl+"/"+this.orgName+"/"+this.appName+"/chatgroups/"+t+"/users/"+n,type:"DELETE",dataType:"json",headers:{Authorization:"Bearer "+this.token,"Content-Type":"application/json"}};r.success=e.success||_utils.emptyfn,r.error=e.error||_utils.emptyfn,WebIM.utils.ajax(r)},connection.prototype.inviteToGroup=function(e){var t=e.groupId,n=e.users,r={url:this.apiUrl+"/"+this.orgName+"/"+this.appName+"/chatgroups/"+t+"/invite",type:"POST",data:JSON.stringify({usernames:n}),dataType:"json",headers:{Authorization:"Bearer "+this.token,"Content-Type":"application/json"}};r.success=e.success||_utils.emptyfn,r.error=e.error||_utils.emptyfn,WebIM.utils.ajax(r)};var WebIM=window.WebIM||{};WebIM.connection=connection,WebIM.utils=_utils,WebIM.statusCode=_code,WebIM.message=_msg.message,WebIM.doQuery=function(e,t,n){void 0===window.cefQuery||window.cefQuery({request:e,persistent:!1,onSuccess:t,onFailure:n})},WebIM.debug=function(e){logMessage=function(t){e&&console.log(WebIM.utils.ts()+"[recv] ",t.data)},Strophe.Connection.prototype.rawOutput=function(t){e&&console.log("%c "+WebIM.utils.ts()+"[send] "+t,"background-color: #e2f7da")}},__webpack_exports__.default=WebIM},function(e,t,n){n(10),function(){"use strict";var e=n(9).utils,r=function(e,t){return!this instanceof r?new r(e):(this._msg={},"function"==typeof r[e]&&(r[e].prototype.setGroup=this.setGroup,this._msg=new r[e](t)),this._msg)};r.prototype.setGroup=function(e){this.body.group=e},r.read=function(e){this.id=e,this.type="read"},r.read.prototype.set=function(e){this.body={ackId:e.id,to:e.to}},r.delivery=function(e){this.id=e,this.type="delivery"},r.delivery.prototype.set=function(e){this.body={bodyId:e.id,to:e.to}},r.txt=function(e){this.id=e,this.type="txt",this.body={}},r.txt.prototype.set=function(e){this.value=e.msg,this.body={id:this.id,to:e.to,msg:this.value,type:this.type,roomType:e.roomType,ext:e.ext||{},success:e.success,fail:e.fail},e.roomType||delete this.body.roomType},r.cmd=function(e){this.id=e,this.type="cmd",this.body={}},r.cmd.prototype.set=function(e){this.value="",this.body={to:e.to,action:e.action,msg:this.value,type:this.type,roomType:e.roomType,ext:e.ext||{},success:e.success},e.roomType||delete this.body.roomType},r.location=function(e){this.id=e,this.type="loc",this.body={}},r.location.prototype.set=function(e){this.body={to:e.to,type:this.type,roomType:e.roomType,addr:e.addr,lat:e.lat,lng:e.lng,ext:e.ext||{}}},r.img=function(e){this.id=e,this.type="img",this.body={}},r.img.prototype.set=function(t){t.file=t.file||e.getFileUrl(t.fileInputId),this.value=t.file,this.body={id:this.id,file:this.value,apiUrl:t.apiUrl,to:t.to,type:this.type,ext:t.ext||{},roomType:t.roomType,onFileUploadError:t.onFileUploadError,onFileUploadComplete:t.onFileUploadComplete,success:t.success,fail:t.fail,flashUpload:t.flashUpload,width:t.width,height:t.height,body:t.body,uploadError:t.uploadError,uploadComplete:t.uploadComplete},t.roomType||delete this.body.roomType},r.audio=function(e){this.id=e,this.type="audio",this.body={}},r.audio.prototype.set=function(t){t.file=t.file||e.getFileUrl(t.fileInputId),this.value=t.file,this.filename=t.filename||this.value.filename,this.body={id:this.id,file:this.value,filename:this.filename,apiUrl:t.apiUrl,to:t.to,type:this.type,ext:t.ext||{},length:t.length||0,roomType:t.roomType,file_length:t.file_length,onFileUploadError:t.onFileUploadError,onFileUploadComplete:t.onFileUploadComplete,success:t.success,fail:t.fail,flashUpload:t.flashUpload,body:t.body},t.roomType||delete this.body.roomType},r.file=function(e){this.id=e,this.type="file",this.body={}},r.file.prototype.set=function(t){t.file=t.file||e.getFileUrl(t.fileInputId),this.value=t.file,this.filename=t.filename||this.value.filename,this.body={id:this.id,file:this.value,filename:this.filename,apiUrl:t.apiUrl,to:t.to,type:this.type,ext:t.ext||{},roomType:t.roomType,onFileUploadError:t.onFileUploadError,onFileUploadComplete:t.onFileUploadComplete,success:t.success,fail:t.fail,flashUpload:t.flashUpload,body:t.body},t.roomType||delete this.body.roomType},r.video=function(){},r.video.prototype.set=function(){};var o=function(e){return!this instanceof o?new o(e,conn):void(this.msg=e)};o.prototype.send=function(t){var n=this,r=function(n){n.ext=n.ext||{},n.ext.weichat=n.ext.weichat||{},n.ext.weichat.originType=n.ext.weichat.originType||"webim";var r,o={from:t.context.userId||"",to:n.to,bodies:[n.body],ext:n.ext||{}},i=e.stringify(o);if(r=$msg({type:n.group||"chat",to:n.toJid,id:n.id,xmlns:"jabber:client"}).c("body").t(i),n.roomType&&r.up().c("roomtype",{xmlns:"easemob:x:roomtype",type:"chatroom"}),n.bodyId){r=$msg({from:t.context.jid||"",to:n.toJid,id:n.id,xmlns:"jabber:client"}).c("body").t(n.bodyId);var s={xmlns:"urn:xmpp:receipts",id:n.bodyId};r.up().c("delivery",s)}if(n.ackId){if(0<=t.context.jid.indexOf(n.toJid))return;r=$msg({from:t.context.jid||"",to:n.toJid,id:n.id,xmlns:"jabber:client"}).c("body").t(n.ackId);var a={xmlns:"urn:xmpp:receipts",id:n.ackId};r.up().c("acked",a)}setTimeout(function(){"undefined"!=typeof _msgHash&&_msgHash[n.id]&&_msgHash[n.id].msg.fail instanceof Function&&_msgHash[n.id].msg.fail(n.id)},6e4),t.sendCommand(r.tree(),n.id)};if(n.msg.file){if(n.msg.body&&n.msg.body.url)return void r(n.msg);var o=n.msg.onFileUploadComplete;n.msg.onFileUploadComplete=function(e){if(e.entities[0]["file-metadata"]){var i=e.entities[0]["file-metadata"]["content-length"];n.msg.filetype=e.entities[0]["file-metadata"]["content-type"],204800<i&&(n.msg.thumbnail=!0)}n.msg.body={type:n.msg.type||"file",url:("https:"!=location.protocol&&t.isHttpDNS?t.apiUrl+e.uri.substr(e.uri.indexOf("/",9)):e.uri)+"/"+e.entities[0].uuid,secret:e.entities[0]["share-secret"],filename:n.msg.file.filename||n.msg.filename,size:{width:n.msg.width||0,height:n.msg.height||0},length:n.msg.length||0,file_length:n.msg.ext.file_length||0,filetype:n.msg.filetype},r(n.msg),o instanceof Function&&o(e,n.msg.id)},e.uploadFile.call(t,n.msg)}else n.msg.body={type:"chat"===n.msg.type?"txt":n.msg.type,msg:n.msg.msg},"cmd"===n.msg.type?n.msg.body.action=n.msg.action:"loc"===n.msg.type&&(n.msg.body.addr=n.msg.addr,n.msg.body.lat=n.msg.lat,n.msg.body.lng=n.msg.lng),r(n.msg)},t._msg=o,t.message=r}()},function(e,t,n){e.exports=function(e){return function(){if("function"==typeof ArrayBuffer){var t=e.lib,n=t.WordArray,r=n.init,o=n.init=function(e){if(e instanceof ArrayBuffer&&(e=new Uint8Array(e)),(e instanceof Int8Array||"undefined"!=typeof Uint8ClampedArray&&e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array||e instanceof Float64Array)&&(e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength)),e instanceof Uint8Array){for(var t=e.byteLength,n=[],o=0;o<t;o++)n[o>>>2]|=e[o]<<24-o%4*8;r.call(this,n,t)}else r.apply(this,arguments)};o.prototype=n}}(),e.lib.WordArray}(n(0))},function(e,t,n){var r,o=String.fromCharCode;r=function(e){return function(){function t(e){return 4278255360&e<<8|16711935&e>>>8}var n=e,r=n.lib.WordArray,i=n.enc;i.Utf16=i.Utf16BE={stringify:function(e){for(var t,n=e.words,r=e.sigBytes,i=[],s=0;s<r;s+=2)t=65535&n[s>>>2]>>>16-s%4*8,i.push(o(t));return i.join("")},parse:function(e){for(var t=e.length,n=[],o=0;o<t;o++)n[o>>>1]|=e.charCodeAt(o)<<16-o%2*16;return r.create(n,2*t)}};i.Utf16LE={stringify:function(e){for(var n,r=e.words,i=e.sigBytes,s=[],a=0;a<i;a+=2)n=t(65535&r[a>>>2]>>>16-a%4*8),s.push(o(n));return s.join("")},parse:function(e){for(var n=e.length,o=[],i=0;i<n;i++)o[i>>>1]|=t(e.charCodeAt(i)<<16-i%2*16);return r.create(o,2*n)}}}(),e.enc.Utf16},e.exports=r(n(0))},function(e,t,n){e.exports=function(e){return n=(t=e).lib,r=n.WordArray,o=t.algo,i=o.SHA256,s=o.SHA224=i.extend({_doReset:function(){this._hash=new r.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var e=i._doFinalize.call(this);return e.sigBytes-=4,e}}),t.SHA224=i._createHelper(s),t.HmacSHA224=i._createHmacHelper(s),e.SHA224;var t,n,r,o,i,s}(n(0),n(11))},function(e,t,n){e.exports=function(e){return n=(t=e).x64,r=n.Word,o=n.WordArray,i=t.algo,s=i.SHA512,a=i.SHA384=s.extend({_doReset:function(){this._hash=new o.init([new r.init(3418070365,3238371032),new r.init(1654270250,914150663),new r.init(2438529370,812702999),new r.init(355462360,4144912697),new r.init(1731405415,4290775857),new r.init(2394180231,1750603025),new r.init(3675008525,1694076839),new r.init(1203062813,3204075428)])},_doFinalize:function(){var e=s._doFinalize.call(this);return e.sigBytes-=16,e}}),t.SHA384=s._createHelper(a),t.HmacSHA384=s._createHmacHelper(a),e.SHA384;var t,n,r,o,i,s,a}(n(0),n(5),n(12))},function(e,t,n){e.exports=function(e){return function(t){var n=e,r=n.lib,o=r.WordArray,i=r.Hasher,s=n.x64,a=s.Word,c=n.algo,u=[],l=[],h=[];!function(){for(var e=1,t=0,n=0;24>n;n++){u[e+5*t]=(n+1)*(n+2)/2%64;var r=t%5,o=(2*e+3*t)%5;e=r,t=o}for(var e=0;5>e;e++)for(var t=0;5>t;t++)l[e+5*t]=t+(2*e+3*t)%5*5;for(var i=1,s=0;24>s;s++){for(var c=0,p=0,d=0;7>d;d++){if(1&i){var f=(1<<d)-1;32>f?p^=1<<f:c^=1<<f-32}128&i?i=113^i<<1:i<<=1}h[s]=a.create(c,p)}}();var p=[];!function(){for(var e=0;25>e;e++)p[e]=a.create()}();var d=c.SHA3=i.extend({cfg:i.cfg.extend({outputLength:512}),_doReset:function(){for(var e=this._state=[],t=0;25>t;t++)e[t]=new a.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(e,t){for(var n=this._state,r=this.blockSize/2,o=0;o<r;o++){var i=e[t+2*o],s=e[t+2*o+1];i=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8),s=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8);var a=n[o];a.high^=s,a.low^=i}for(var c=0;24>c;c++){for(var d=0;5>d;d++){for(var f=0,_=0,m=0;5>m;m++)a=n[d+5*m],f^=a.high,_^=a.low;var g=p[d];g.high=f,g.low=_}for(var d=0;5>d;d++)for(var y=p[(d+4)%5],v=p[(d+1)%5],E=v.high,b=v.low,f=y.high^(E<<1|b>>>31),_=y.low^(b<<1|E>>>31),m=0;5>m;m++)(a=n[d+5*m]).high^=f,a.low^=_;for(var N=1;25>N;N++){var a=n[N],S=a.high,T=a.low,O=u[N];if(32>O)var f=S<<O|T>>>32-O,_=T<<O|S>>>32-O;else var f=T<<O-32|S>>>64-O,_=S<<O-32|T>>>64-O;var x=p[l[N]];x.high=f,x.low=_}var I=p[0],C=n[0];I.high=C.high,I.low=C.low;for(var d=0;5>d;d++)for(var m=0;5>m;m++){var N=d+5*m,a=n[N],R=p[N],A=p[(d+1)%5+5*m],M=p[(d+2)%5+5*m];a.high=R.high^~A.high&M.high,a.low=R.low^~A.low&M.low}var a=n[0],w=h[c];a.high^=w.high,a.low^=w.low}},_doFinalize:function(){var e=this._data,n=e.words,r=(this._nDataBytes,8*e.sigBytes),i=32*this.blockSize;n[r>>>5]|=1<<24-r%32,n[(t.ceil((r+1)/i)*i>>>5)-1]|=128,e.sigBytes=4*n.length,this._process();for(var s=this._state,a=this.cfg.outputLength/8,c=[],u=0;u<a/8;u++){var l=s[u],h=l.high,p=l.low;h=16711935&(h<<8|h>>>24)|4278255360&(h<<24|h>>>8),p=16711935&(p<<8|p>>>24)|4278255360&(p<<24|p>>>8),c.push(p),c.push(h)}return new o.init(c,a)},clone:function(){for(var e=i.clone.call(this),t=e._state=this._state.slice(0),n=0;25>n;n++)t[n]=t[n].clone();return e}});n.SHA3=i._createHelper(d),n.HmacSHA3=i._createHmacHelper(d)}(Math),e.SHA3}(n(0),n(5))},function(e,t,n){e.exports=function(e){return function(){function t(e,t,n){return e^t^n}function n(e,t,n){return e&t|~e&n}function r(e,t,n){return(e|~t)^n}function o(e,t,n){return e&n|t&~n}function i(e,t,n){return e^(t|~n)}function s(e,t){return e<<t|e>>>32-t}var a=e,c=a.lib,u=c.WordArray,l=c.Hasher,h=a.algo,p=u.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),d=u.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),f=u.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),_=u.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),m=u.create([0,1518500249,1859775393,2400959708,2840853838]),g=u.create([1352829926,1548603684,1836072691,2053994217,0]),y=h.RIPEMD160=l.extend({_doReset:function(){this._hash=u.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,a){for(var c=0;16>c;c++){var u=a+c,l=e[u];e[u]=16711935&(l<<8|l>>>24)|4278255360&(l<<24|l>>>8)}var h,y,v,E,b,N,S,T,O,x,I=this._hash.words,C=m.words,R=g.words,A=p.words,M=d.words,w=f.words,B=_.words;N=h=I[0],S=y=I[1],T=v=I[2],O=E=I[3],x=b=I[4];for(var k,c=0;80>c;c+=1)k=0|h+e[a+A[c]],k+=16>c?t(y,v,E)+C[0]:32>c?n(y,v,E)+C[1]:48>c?r(y,v,E)+C[2]:64>c?o(y,v,E)+C[3]:i(y,v,E)+C[4],k=0|(k=s(k|=0,w[c]))+b,h=b,b=E,E=s(v,10),v=y,y=k,k=0|N+e[a+M[c]],k+=16>c?i(S,T,O)+R[0]:32>c?o(S,T,O)+R[1]:48>c?r(S,T,O)+R[2]:64>c?n(S,T,O)+R[3]:t(S,T,O)+R[4],k=0|(k=s(k|=0,B[c]))+x,N=x,x=O,O=s(T,10),T=S,S=k;k=0|I[1]+v+O,I[1]=0|I[2]+E+x,I[2]=0|I[3]+b+N,I[3]=0|I[4]+h+S,I[4]=0|I[0]+y+T,I[0]=k},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,r=8*e.sigBytes;t[r>>>5]|=128<<24-r%32,t[14+(r+64>>>9<<4)]=16711935&(n<<8|n>>>24)|4278255360&(n<<24|n>>>8),e.sigBytes=4*(t.length+1),this._process();for(var o,i=this._hash,s=i.words,a=0;5>a;a++)o=s[a],s[a]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8);return i},clone:function(){var e=l.clone.call(this);return e._hash=this._hash.clone(),e}});a.RIPEMD160=l._createHelper(y),a.HmacRIPEMD160=l._createHmacHelper(y)}(Math),e.RIPEMD160}(n(0))},function(e,t,n){e.exports=function(e){return n=(t=e).lib,r=n.Base,o=n.WordArray,i=t.algo,s=i.SHA1,a=i.HMAC,c=i.PBKDF2=r.extend({cfg:r.extend({keySize:4,hasher:s,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var n,r=this.cfg,i=a.create(r.hasher,e),s=o.create(),c=o.create([1]),u=s.words,l=c.words,h=r.keySize,p=r.iterations;u.length<h;){n=i.update(t).finalize(c),i.reset();for(var d=n.words,f=d.length,_=n,m=1;m<p;m++){_=i.finalize(_),i.reset();for(var g=_.words,y=0;y<f;y++)d[y]^=g[y]}s.concat(n),l[0]++}return s.sigBytes=4*h,s}}),t.PBKDF2=function(e,t,n){return c.create(n).compute(e,t)},e.PBKDF2;var t,n,r,o,i,s,a,c}(n(0),n(6),n(7))},function(e,t,n){e.exports=function(e){return e.mode.CFB=function(){function t(e,t,n,r){var o=this._iv;if(o){var i=o.slice(0);this._iv=void 0}else var i=this._prevBlock;r.encryptBlock(i,0);for(var s=0;s<n;s++)e[t+s]^=i[s]}var n=e.lib.BlockCipherMode.extend();return n.Encryptor=n.extend({processBlock:function(e,n){var r=this._cipher,o=r.blockSize;t.call(this,e,n,o,r),this._prevBlock=e.slice(n,n+o)}}),n.Decryptor=n.extend({processBlock:function(e,n){var r=this._cipher,o=r.blockSize,i=e.slice(n,n+o);t.call(this,e,n,o,r),this._prevBlock=i}}),n}(),e.mode.CFB}(n(0),n(1))},function(e,t,n){e.exports=function(e){return e.mode.CTR=(t=e.lib.BlockCipherMode.extend(),n=t.Encryptor=t.extend({processBlock:function(e,t){var n=this._cipher,r=n.blockSize,o=this._iv,i=this._counter;o&&(i=this._counter=o.slice(0),this._iv=void 0);var s=i.slice(0);n.encryptBlock(s,0),i[r-1]=0|i[r-1]+1;for(var a=0;a<r;a++)e[t+a]^=s[a]}}),t.Decryptor=n,t),e.mode.CTR;var t,n}(n(0),n(1))},function(e,t,n){e.exports=function(e){return e.mode.CTRGladman=function(){function t(e){if(255==(255&e>>24)){var t=255&e>>16,n=255&e>>8,r=255&e;255===t?(t=0,255===n?(n=0,255===r?r=0:++r):++n):++t,e=0,e+=t<<16,e+=n<<8,e+=r}else e+=16777216;return e}function n(e){return 0===(e[0]=t(e[0]))&&(e[1]=t(e[1])),e}var r=e.lib.BlockCipherMode.extend(),o=r.Encryptor=r.extend({processBlock:function(e,t){var r=this._cipher,o=r.blockSize,i=this._iv,s=this._counter;i&&(s=this._counter=i.slice(0),this._iv=void 0),n(s);var a=s.slice(0);r.encryptBlock(a,0);for(var c=0;c<o;c++)e[t+c]^=a[c]}});return r.Decryptor=o,r}(),e.mode.CTRGladman}(n(0),n(1))},function(e,t,n){e.exports=function(e){return e.mode.OFB=(t=e.lib.BlockCipherMode.extend(),n=t.Encryptor=t.extend({processBlock:function(e,t){var n=this._cipher,r=n.blockSize,o=this._iv,i=this._keystream;o&&(i=this._keystream=o.slice(0),this._iv=void 0),n.encryptBlock(i,0);for(var s=0;s<r;s++)e[t+s]^=i[s]}}),t.Decryptor=n,t),e.mode.OFB;var t,n}(n(0),n(1))},function(e,t,n){e.exports=function(e){return e.mode.ECB=((t=e.lib.BlockCipherMode.extend()).Encryptor=t.extend({processBlock:function(e,t){this._cipher.encryptBlock(e,t)}}),t.Decryptor=t.extend({processBlock:function(e,t){this._cipher.decryptBlock(e,t)}}),t),e.mode.ECB;var t}(n(0),n(1))},function(e,t,n){e.exports=function(e){return e.pad.AnsiX923={pad:function(e,t){var n=e.sigBytes,r=4*t,o=r-n%r,i=n+o-1;e.clamp(),e.words[i>>>2]|=o<<24-i%4*8,e.sigBytes+=o},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},e.pad.Ansix923}(n(0),n(1))},function(e,t,n){e.exports=function(e){return e.pad.Iso10126={pad:function(t,n){var r=4*n,o=r-t.sigBytes%r;t.concat(e.lib.WordArray.random(o-1)).concat(e.lib.WordArray.create([o<<24],1))},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},e.pad.Iso10126}(n(0),n(1))},function(e,t,n){e.exports=function(e){return e.pad.Iso97971={pad:function(t,n){t.concat(e.lib.WordArray.create([2147483648],1)),e.pad.ZeroPadding.pad(t,n)},unpad:function(t){e.pad.ZeroPadding.unpad(t),t.sigBytes--}},e.pad.Iso97971}(n(0),n(1))},function(e,t,n){e.exports=function(e){return e.pad.ZeroPadding={pad:function(e,t){var n=4*t;e.clamp(),e.sigBytes+=n-(e.sigBytes%n||n)},unpad:function(e){for(var t=e.words,n=e.sigBytes-1;!(255&t[n>>>2]>>>24-n%4*8);)n--;e.sigBytes=n+1}},e.pad.ZeroPadding}(n(0),n(1))},function(e,t,n){e.exports=function(e){return e.pad.NoPadding={pad:function(){},unpad:function(){}},e.pad.NoPadding}(n(0),n(1))},function(e,t,n){e.exports=function(e){return n=(t=e).lib,r=n.CipherParams,o=t.enc,i=o.Hex,t.format.Hex={stringify:function(e){return e.ciphertext.toString(i)},parse:function(e){var t=i.parse(e);return r.create({ciphertext:t})}},e.format.Hex;var t,n,r,o,i}(n(0),n(1))},function(e,t,n){e.exports=function(e){return function(){var t=e,n=t.lib,r=n.BlockCipher,o=t.algo,i=[],s=[],a=[],c=[],u=[],l=[],h=[],p=[],d=[],f=[];!function(){for(var e=[],t=0;256>t;t++)e[t]=128>t?t<<1:283^t<<1;for(var n,r=0,o=0,t=0;256>t;t++){n=(n=o^o<<1^o<<2^o<<3^o<<4)>>>8^255&n^99,i[r]=n,s[n]=r;var _=e[r],m=e[_],g=e[m],y=257*e[n]^16843008*n;a[r]=y<<24|y>>>8,c[r]=y<<16|y>>>16,u[r]=y<<8|y>>>24,l[r]=y;var y=16843009*g^65537*m^257*_^16843008*r;h[n]=y<<24|y>>>8,p[n]=y<<16|y>>>16,d[n]=y<<8|y>>>24,f[n]=y,r?(r=_^e[e[e[g^_]]],o^=e[e[o]]):r=o=1}}();var _=[0,1,2,4,8,16,32,64,128,27,54],m=o.AES=r.extend({_doReset:function(){if(!this._nRounds||this._keyPriorReset!==this._key){for(var e=this._keyPriorReset=this._key,t=e.words,n=e.sigBytes/4,r=this._nRounds=n+6,o=4*(r+1),s=this._keySchedule=[],a=0;a<o;a++)if(a<n)s[a]=t[a];else{var c=s[a-1];a%n?6<n&&4==a%n&&(c=i[c>>>24]<<24|i[255&c>>>16]<<16|i[255&c>>>8]<<8|i[255&c]):(c=i[(c=c<<8|c>>>24)>>>24]<<24|i[255&c>>>16]<<16|i[255&c>>>8]<<8|i[255&c],c^=_[0|a/n]<<24),s[a]=s[a-n]^c}for(var u=this._invKeySchedule=[],l=0;l<o;l++){if(a=o-l,l%4)var c=s[a];else var c=s[a-4];u[l]=4>l||4>=a?c:h[i[c>>>24]]^p[i[255&c>>>16]]^d[i[255&c>>>8]]^f[i[255&c]]}}},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._keySchedule,a,c,u,l,i)},decryptBlock:function(e,t){var n=e[t+1];e[t+1]=e[t+3],e[t+3]=n,this._doCryptBlock(e,t,this._invKeySchedule,h,p,d,f,s);var n=e[t+1];e[t+1]=e[t+3],e[t+3]=n},_doCryptBlock:function(e,t,n,r,o,i,s,a){for(var c=this._nRounds,u=e[t]^n[0],l=e[t+1]^n[1],h=e[t+2]^n[2],p=e[t+3]^n[3],d=4,f=1;f<c;f++){var _=r[u>>>24]^o[255&l>>>16]^i[255&h>>>8]^s[255&p]^n[d++],m=r[l>>>24]^o[255&h>>>16]^i[255&p>>>8]^s[255&u]^n[d++],g=r[h>>>24]^o[255&p>>>16]^i[255&u>>>8]^s[255&l]^n[d++],y=r[p>>>24]^o[255&u>>>16]^i[255&l>>>8]^s[255&h]^n[d++];u=_,l=m,h=g,p=y}var _=(a[u>>>24]<<24|a[255&l>>>16]<<16|a[255&h>>>8]<<8|a[255&p])^n[d++],m=(a[l>>>24]<<24|a[255&h>>>16]<<16|a[255&p>>>8]<<8|a[255&u])^n[d++],g=(a[h>>>24]<<24|a[255&p>>>16]<<16|a[255&u>>>8]<<8|a[255&l])^n[d++],y=(a[p>>>24]<<24|a[255&u>>>16]<<16|a[255&l>>>8]<<8|a[255&h])^n[d++];e[t]=_,e[t+1]=m,e[t+2]=g,e[t+3]=y},keySize:8});t.AES=r._createHelper(m)}(),e.AES}(n(0),n(3),n(4),n(2),n(1))},function(e,t,n){e.exports=function(e){return function(){function t(e,t){var n=(this._lBlock>>>e^this._rBlock)&t;this._rBlock^=n,this._lBlock^=n<<e}function n(e,t){var n=(this._rBlock>>>e^this._lBlock)&t;this._lBlock^=n,this._rBlock^=n<<e}var r=e,o=r.lib,i=o.WordArray,s=o.BlockCipher,a=r.algo,c=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],u=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],l=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],h=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],p=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],d=a.DES=s.extend({_doReset:function(){for(var e,t=this._key,n=t.words,r=[],o=0;56>o;o++)e=c[o]-1,r[o]=1&n[e>>>5]>>>31-e%32;for(var i=this._subKeys=[],s=0;16>s;s++){for(var a=i[s]=[],h=l[s],o=0;24>o;o++)a[0|o/6]|=r[(u[o]-1+h)%28]<<31-o%6,a[4+(0|o/6)]|=r[28+(u[o+24]-1+h)%28]<<31-o%6;a[0]=a[0]<<1|a[0]>>>31;for(var o=1;7>o;o++)a[o]>>>=4*(o-1)+3;a[7]=a[7]<<5|a[7]>>>27}for(var p=this._invSubKeys=[],o=0;16>o;o++)p[o]=i[15-o]},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._subKeys)},decryptBlock:function(e,t){this._doCryptBlock(e,t,this._invSubKeys)},_doCryptBlock:function(e,r,o){this._lBlock=e[r],this._rBlock=e[r+1],t.call(this,4,252645135),t.call(this,16,65535),n.call(this,2,858993459),n.call(this,8,16711935),t.call(this,1,1431655765);for(var i=0;16>i;i++){for(var s=o[i],a=this._lBlock,c=this._rBlock,u=0,l=0;8>l;l++)u|=h[l][((c^s[l])&p[l])>>>0];this._lBlock=c,this._rBlock=a^u}var d=this._lBlock;this._lBlock=this._rBlock,this._rBlock=d,t.call(this,1,1431655765),n.call(this,8,16711935),n.call(this,2,858993459),t.call(this,16,65535),t.call(this,4,252645135),e[r]=this._lBlock,e[r+1]=this._rBlock},keySize:2,ivSize:2,blockSize:2});r.DES=s._createHelper(d);var f=a.TripleDES=s.extend({_doReset:function(){var e=this._key,t=e.words;this._des1=d.createEncryptor(i.create(t.slice(0,2))),this._des2=d.createEncryptor(i.create(t.slice(2,4))),this._des3=d.createEncryptor(i.create(t.slice(4,6)))},encryptBlock:function(e,t){this._des1.encryptBlock(e,t),this._des2.decryptBlock(e,t),this._des3.encryptBlock(e,t)},decryptBlock:function(e,t){this._des3.decryptBlock(e,t),this._des2.encryptBlock(e,t),this._des1.decryptBlock(e,t)},keySize:6,ivSize:2,blockSize:2});r.TripleDES=s._createHelper(f)}(),e.TripleDES}(n(0),n(3),n(4),n(2),n(1))},function(e,t,n){e.exports=function(e){return function(){function t(){for(var e=this._S,t=this._i,n=this._j,r=0,o=0;4>o;o++){n=(n+e[t=(t+1)%256])%256;var i=e[t];e[t]=e[n],e[n]=i,r|=e[(e[t]+e[n])%256]<<24-8*o}return this._i=t,this._j=n,r}var n=e,r=n.lib,o=r.StreamCipher,i=n.algo,s=i.RC4=o.extend({_doReset:function(){for(var e=this._key,t=e.words,n=e.sigBytes,r=this._S=[],o=0;256>o;o++)r[o]=o;for(var o=0,i=0;256>o;o++){var s=o%n,a=255&t[s>>>2]>>>24-s%4*8;i=(i+r[o]+a)%256;var c=r[o];r[o]=r[i],r[i]=c}this._i=this._j=0},_doProcessBlock:function(e,n){e[n]^=t.call(this)},keySize:8,ivSize:0});n.RC4=o._createHelper(s);var a=i.RC4Drop=s.extend({cfg:s.cfg.extend({drop:192}),_doReset:function(){s._doReset.call(this);for(var e=this.cfg.drop;0<e;e--)t.call(this)}});n.RC4Drop=o._createHelper(a)}(),e.RC4}(n(0),n(3),n(4),n(2),n(1))},function(e,t,n){e.exports=function(e){return function(){function t(){for(var e=this._X,t=this._C,n=0;8>n;n++)a[n]=t[n];t[0]=0|t[0]+1295307597+this._b,t[1]=0|t[1]+3545052371+(t[0]>>>0<a[0]>>>0?1:0),t[2]=0|t[2]+886263092+(t[1]>>>0<a[1]>>>0?1:0),t[3]=0|t[3]+1295307597+(t[2]>>>0<a[2]>>>0?1:0),t[4]=0|t[4]+3545052371+(t[3]>>>0<a[3]>>>0?1:0),t[5]=0|t[5]+886263092+(t[4]>>>0<a[4]>>>0?1:0),t[6]=0|t[6]+1295307597+(t[5]>>>0<a[5]>>>0?1:0),t[7]=0|t[7]+3545052371+(t[6]>>>0<a[6]>>>0?1:0),this._b=t[7]>>>0<a[7]>>>0?1:0;for(var n=0;8>n;n++){var r=e[n]+t[n],o=65535&r,i=r>>>16;c[n]=((o*o>>>17)+o*i>>>15)+i*i^(0|(4294901760&r)*r)+(0|(65535&r)*r)}e[0]=0|c[0]+(c[7]<<16|c[7]>>>16)+(c[6]<<16|c[6]>>>16),e[1]=0|c[1]+(c[0]<<8|c[0]>>>24)+c[7],e[2]=0|c[2]+(c[1]<<16|c[1]>>>16)+(c[0]<<16|c[0]>>>16),e[3]=0|c[3]+(c[2]<<8|c[2]>>>24)+c[1],e[4]=0|c[4]+(c[3]<<16|c[3]>>>16)+(c[2]<<16|c[2]>>>16),e[5]=0|c[5]+(c[4]<<8|c[4]>>>24)+c[3],e[6]=0|c[6]+(c[5]<<16|c[5]>>>16)+(c[4]<<16|c[4]>>>16),e[7]=0|c[7]+(c[6]<<8|c[6]>>>24)+c[5]}var n=e,r=n.lib,o=r.StreamCipher,i=n.algo,s=[],a=[],c=[],u=i.Rabbit=o.extend({_doReset:function(){for(var e=this._key.words,n=this.cfg.iv,r=0;4>r;r++)e[r]=16711935&(e[r]<<8|e[r]>>>24)|4278255360&(e[r]<<24|e[r]>>>8);var o=this._X=[e[0],e[3]<<16|e[2]>>>16,e[1],e[0]<<16|e[3]>>>16,e[2],e[1]<<16|e[0]>>>16,e[3],e[2]<<16|e[1]>>>16],i=this._C=[e[2]<<16|e[2]>>>16,4294901760&e[0]|65535&e[1],e[3]<<16|e[3]>>>16,4294901760&e[1]|65535&e[2],e[0]<<16|e[0]>>>16,4294901760&e[2]|65535&e[3],e[1]<<16|e[1]>>>16,4294901760&e[3]|65535&e[0]];this._b=0;for(var r=0;4>r;r++)t.call(this);for(var r=0;8>r;r++)i[r]^=o[7&r+4];if(n){var s=n.words,a=s[0],c=s[1],u=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8),l=16711935&(c<<8|c>>>24)|4278255360&(c<<24|c>>>8),h=u>>>16|4294901760&l,p=l<<16|65535&u;i[0]^=u,i[1]^=h,i[2]^=l,i[3]^=p,i[4]^=u,i[5]^=h,i[6]^=l,i[7]^=p;for(var r=0;4>r;r++)t.call(this)}},_doProcessBlock:function(e,n){var r=this._X;t.call(this),s[0]=r[0]^r[5]>>>16^r[3]<<16,s[1]=r[2]^r[7]>>>16^r[5]<<16,s[2]=r[4]^r[1]>>>16^r[7]<<16,s[3]=r[6]^r[3]>>>16^r[1]<<16;for(var o=0;4>o;o++)s[o]=16711935&(s[o]<<8|s[o]>>>24)|4278255360&(s[o]<<24|s[o]>>>8),e[n+o]^=s[o]},blockSize:4,ivSize:2});n.Rabbit=o._createHelper(u)}(),e.Rabbit}(n(0),n(3),n(4),n(2),n(1))},function(e,t,n){e.exports=function(e){return function(){function t(){for(var e=this._X,t=this._C,n=0;8>n;n++)a[n]=t[n];t[0]=0|t[0]+1295307597+this._b,t[1]=0|t[1]+3545052371+(t[0]>>>0<a[0]>>>0?1:0),t[2]=0|t[2]+886263092+(t[1]>>>0<a[1]>>>0?1:0),t[3]=0|t[3]+1295307597+(t[2]>>>0<a[2]>>>0?1:0),t[4]=0|t[4]+3545052371+(t[3]>>>0<a[3]>>>0?1:0),t[5]=0|t[5]+886263092+(t[4]>>>0<a[4]>>>0?1:0),t[6]=0|t[6]+1295307597+(t[5]>>>0<a[5]>>>0?1:0),t[7]=0|t[7]+3545052371+(t[6]>>>0<a[6]>>>0?1:0),this._b=t[7]>>>0<a[7]>>>0?1:0;for(var n=0;8>n;n++){var r=e[n]+t[n],o=65535&r,i=r>>>16;c[n]=((o*o>>>17)+o*i>>>15)+i*i^(0|(4294901760&r)*r)+(0|(65535&r)*r)}e[0]=0|c[0]+(c[7]<<16|c[7]>>>16)+(c[6]<<16|c[6]>>>16),e[1]=0|c[1]+(c[0]<<8|c[0]>>>24)+c[7],e[2]=0|c[2]+(c[1]<<16|c[1]>>>16)+(c[0]<<16|c[0]>>>16),e[3]=0|c[3]+(c[2]<<8|c[2]>>>24)+c[1],e[4]=0|c[4]+(c[3]<<16|c[3]>>>16)+(c[2]<<16|c[2]>>>16),e[5]=0|c[5]+(c[4]<<8|c[4]>>>24)+c[3],e[6]=0|c[6]+(c[5]<<16|c[5]>>>16)+(c[4]<<16|c[4]>>>16),e[7]=0|c[7]+(c[6]<<8|c[6]>>>24)+c[5]}var n=e,r=n.lib,o=r.StreamCipher,i=n.algo,s=[],a=[],c=[],u=i.RabbitLegacy=o.extend({_doReset:function(){var e=this._key.words,n=this.cfg.iv,r=this._X=[e[0],e[3]<<16|e[2]>>>16,e[1],e[0]<<16|e[3]>>>16,e[2],e[1]<<16|e[0]>>>16,e[3],e[2]<<16|e[1]>>>16],o=this._C=[e[2]<<16|e[2]>>>16,4294901760&e[0]|65535&e[1],e[3]<<16|e[3]>>>16,4294901760&e[1]|65535&e[2],e[0]<<16|e[0]>>>16,4294901760&e[2]|65535&e[3],e[1]<<16|e[1]>>>16,4294901760&e[3]|65535&e[0]];this._b=0;for(var i=0;4>i;i++)t.call(this);for(var i=0;8>i;i++)o[i]^=r[7&i+4];if(n){var s=n.words,a=s[0],c=s[1],u=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8),l=16711935&(c<<8|c>>>24)|4278255360&(c<<24|c>>>8),h=u>>>16|4294901760&l,p=l<<16|65535&u;o[0]^=u,o[1]^=h,o[2]^=l,o[3]^=p,o[4]^=u,o[5]^=h,o[6]^=l,o[7]^=p;for(var i=0;4>i;i++)t.call(this)}},_doProcessBlock:function(e,n){var r=this._X;t.call(this),s[0]=r[0]^r[5]>>>16^r[3]<<16,s[1]=r[2]^r[7]>>>16^r[5]<<16,s[2]=r[4]^r[1]>>>16^r[7]<<16,s[3]=r[6]^r[3]>>>16^r[1]<<16;for(var o=0;4>o;o++)s[o]=16711935&(s[o]<<8|s[o]>>>24)|4278255360&(s[o]<<24|s[o]>>>8),e[n+o]^=s[o]},blockSize:4,ivSize:2});n.RabbitLegacy=o._createHelper(u)}(),e.RabbitLegacy}(n(0),n(3),n(4),n(2),n(1))},function(e,t){!function(){function e(e){this.array=void 0===e?[]:Array(e)}e.prototype={length:function(){return this.array.length},at:function(e){return this.array[e]},set:function(e,t){this.array[e]=t},push:function(e){return this.array.push(e)},slice:function(e,t){return this.array=this.array.slice(e,t)},concat:function(e){this.array=this.array.concat(e)},remove:function(e,t){t=void 0===t?1:t,this.array.splice(e,t)},join:function(e){return this.array.join(e)},clear:function(){this.array.length=0}};var n=function(){this._array_h=new e};n.prototype={_index:0,push:function(e){this._array_h.push(e)},pop:function(){var e=null;return this._array_h.length()&&(e=this._array_h.at(this._index),2*++this._index>=this._array_h.length()&&(this._array_h.slice(this._index),this._index=0)),e},head:function(){var e=null,t=this._array_h.length();return t&&(e=this._array_h.at(t-1)),e},tail:function(){var e=null;return this._array_h.length()&&(e=this._array_h.at(this._index)),e},length:function(){return this._array_h.length()-this._index},empty:function(){return 0===this._array_h.length()},clear:function(){this._array_h.clear()}},t.Queue=n}()},function(e,t,n){var r=Math.floor,o=Math.min,i=Math.max;(function(e,n){var s;!function(){var a="object"==typeof self&&self.self===self&&self||"object"==typeof e&&e.global===e&&e||this||{},c=a._,u=Array.prototype,l=Object.prototype,h="undefined"==typeof Symbol?null:Symbol.prototype,p=u.push,d=u.slice,f=l.toString,_=l.hasOwnProperty,m=Array.isArray,g=Object.keys,y=Object.create,v=function(){},E=function(e){return e instanceof E?e:this instanceof E?void(this._wrapped=e):new E(e)};t.nodeType?a._=E:(!n.nodeType&&n.exports&&(t=n.exports=E),t._=E),E.VERSION="1.9.1";var b,N=function(e,t,n){if(void 0===t)return e;switch(null==n?3:n){case 1:return function(n){return e.call(t,n)};case 3:return function(n,r,o){return e.call(t,n,r,o)};case 4:return function(n,r,o,i){return e.call(t,n,r,o,i)}}return function(){return e.apply(t,arguments)}},S=function(e,t,n){return E.iteratee===b?null==e?E.identity:E.isFunction(e)?N(e,t,n):E.isObject(e)&&!E.isArray(e)?E.matcher(e):E.property(e):E.iteratee(e,t)};E.iteratee=b=function(e,t){return S(e,t,1/0)};var T=function(e,t){return t=null==t?e.length-1:+t,function(){for(var n=i(arguments.length-t,0),r=Array(n),o=0;o<n;o++)r[o]=arguments[o+t];switch(t){case 0:return e.call(this,r);case 1:return e.call(this,arguments[0],r);case 2:return e.call(this,arguments[0],arguments[1],r)}var s=Array(t+1);for(o=0;o<t;o++)s[o]=arguments[o];return s[t]=r,e.apply(this,s)}},O=function(e){if(!E.isObject(e))return{};if(y)return y(e);v.prototype=e;var t=new v;return v.prototype=null,t},x=function(e){return function(t){return null==t?void 0:t[e]}},I=function(e,t){return null!=e&&_.call(e,t)},C=function(e,t){for(var n=t.length,r=0;r<n;r++){if(null==e)return;e=e[t[r]]}return n?e:void 0},R=x("length"),A=function(e){var t=R(e);return"number"==typeof t&&0<=t&&t<=9007199254740991};E.each=E.forEach=function(e,t,n){var r,o;if(t=N(t,n),A(e))for(r=0,o=e.length;r<o;r++)t(e[r],r,e);else{var i=E.keys(e);for(r=0,o=i.length;r<o;r++)t(e[i[r]],i[r],e)}return e},E.map=E.collect=function(e,t,n){t=S(t,n);for(var r,o=!A(e)&&E.keys(e),i=(o||e).length,s=Array(i),a=0;a<i;a++)r=o?o[a]:a,s[a]=t(e[r],r,e);return s};var M=function(e){var t=function(t,n,r,o){var i=!A(t)&&E.keys(t),s=(i||t).length,a=0<e?0:s-1;for(o||(r=t[i?i[a]:a],a+=e);0<=a&&a<s;a+=e){var c=i?i[a]:a;r=n(r,t[c],c,t)}return r};return function(e,n,r,o){var i=3<=arguments.length;return t(e,N(n,o,4),r,i)}};E.reduce=E.foldl=E.inject=M(1),E.reduceRight=E.foldr=M(-1),E.find=E.detect=function(e,t,n){var r=(A(e)?E.findIndex:E.findKey)(e,t,n);if(void 0!==r&&-1!==r)return e[r]},E.filter=E.select=function(e,t,n){var r=[];return t=S(t,n),E.each(e,function(e,n,o){t(e,n,o)&&r.push(e)}),r},E.reject=function(e,t,n){return E.filter(e,E.negate(S(t)),n)},E.every=E.all=function(e,t,n){t=S(t,n);for(var r,o=!A(e)&&E.keys(e),i=(o||e).length,s=0;s<i;s++)if(!t(e[r=o?o[s]:s],r,e))return!1;return!0},E.some=E.any=function(e,t,n){t=S(t,n);for(var r,o=!A(e)&&E.keys(e),i=(o||e).length,s=0;s<i;s++)if(t(e[r=o?o[s]:s],r,e))return!0;return!1},E.contains=E.includes=E.include=function(e,t,n,r){return A(e)||(e=E.values(e)),("number"!=typeof n||r)&&(n=0),0<=E.indexOf(e,t,n)},E.invoke=T(function(e,t,n){var r,o;return E.isFunction(t)?o=t:E.isArray(t)&&(r=t.slice(0,-1),t=t[t.length-1]),E.map(e,function(e){var i=o;if(!i){if(r&&r.length&&(e=C(e,r)),null==e)return;i=e[t]}return null==i?i:i.apply(e,n)})}),E.pluck=function(e,t){return E.map(e,E.property(t))},E.where=function(e,t){return E.filter(e,E.matcher(t))},E.findWhere=function(e,t){return E.find(e,E.matcher(t))},E.max=function(e,t,n){var r,o,i=-1/0,s=-1/0;if(null==t||"number"==typeof t&&"object"!=typeof e[0]&&null!=e)for(var a=0,c=(e=A(e)?e:E.values(e)).length;a<c;a++)null!=(r=e[a])&&r>i&&(i=r);else t=S(t,n),E.each(e,function(e,n,r){((o=t(e,n,r))>s||o===-1/0&&i===-1/0)&&(i=e,s=o)});return i},E.min=function(e,t,n){var r,o,i=1/0,s=1/0;if(null==t||"number"==typeof t&&"object"!=typeof e[0]&&null!=e)for(var a=0,c=(e=A(e)?e:E.values(e)).length;a<c;a++)null!=(r=e[a])&&r<i&&(i=r);else t=S(t,n),E.each(e,function(e,n,r){((o=t(e,n,r))<s||o===1/0&&i===1/0)&&(i=e,s=o)});return i},E.shuffle=function(e){return E.sample(e,1/0)},E.sample=function(e,t,n){if(null==t||n)return A(e)||(e=E.values(e)),e[E.random(e.length-1)];var r=A(e)?E.clone(e):E.values(e),s=R(r);t=i(o(t,s),0);for(var a=0;a<t;a++){var c=E.random(a,s-1),u=r[a];r[a]=r[c],r[c]=u}return r.slice(0,t)},E.sortBy=function(e,t,n){var r=0;return t=S(t,n),E.pluck(E.map(e,function(e,n,o){return{value:e,index:r++,criteria:t(e,n,o)}}).sort(function(e,t){var n=e.criteria,r=t.criteria;if(n!==r){if(n>r||void 0===n)return 1;if(n<r||void 0===r)return-1}return e.index-t.index}),"value")};var w=function(e,t){return function(n,r,o){var i=t?[[],[]]:{};return r=S(r,o),E.each(n,function(t,o){var s=r(t,o,n);e(i,t,s)}),i}};E.groupBy=w(function(e,t,n){I(e,n)?e[n].push(t):e[n]=[t]}),E.indexBy=w(function(e,t,n){e[n]=t}),E.countBy=w(function(e,t,n){I(e,n)?e[n]++:e[n]=1});var B=/[^\ud800-\udfff]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff]/g;E.toArray=function(e){return e?E.isArray(e)?d.call(e):E.isString(e)?e.match(B):A(e)?E.map(e,E.identity):E.values(e):[]},E.size=function(e){return null==e?0:A(e)?e.length:E.keys(e).length},E.partition=w(function(e,t,n){e[n?0:1].push(t)},!0),E.first=E.head=E.take=function(e,t,n){return null==e||1>e.length?null==t?void 0:[]:null==t||n?e[0]:E.initial(e,e.length-t)},E.initial=function(e,t,n){return d.call(e,0,i(0,e.length-(null==t||n?1:t)))},E.last=function(e,t,n){return null==e||1>e.length?null==t?void 0:[]:null==t||n?e[e.length-1]:E.rest(e,i(0,e.length-t))},E.rest=E.tail=E.drop=function(e,t,n){return d.call(e,null==t||n?1:t)},E.compact=function(e){return E.filter(e,Boolean)};var k=function(e,t,n,r){for(var o,i=(r=r||[]).length,s=0,a=R(e);s<a;s++)if(o=e[s],A(o)&&(E.isArray(o)||E.isArguments(o)))if(t)for(var c=0,u=o.length;c<u;)r[i++]=o[c++];else k(o,t,n,r),i=r.length;else n||(r[i++]=o);return r};E.flatten=function(e,t){return k(e,t,!1)},E.without=T(function(e,t){return E.difference(e,t)}),E.uniq=E.unique=function(e,t,n,r){E.isBoolean(t)||(r=n,n=t,t=!1),null!=n&&(n=S(n,r));for(var o=[],i=[],s=0,a=R(e);s<a;s++){var c=e[s],u=n?n(c,s,e):c;t&&!n?((!s||i!==u)&&o.push(c),i=u):n?!E.contains(i,u)&&(i.push(u),o.push(c)):!E.contains(o,c)&&o.push(c)}return o},E.union=T(function(e){return E.uniq(k(e,!0,!0))}),E.intersection=function(e){for(var t,n=[],r=arguments.length,o=0,i=R(e);o<i;o++)if(t=e[o],!E.contains(n,t)){var s;for(s=1;s<r&&E.contains(arguments[s],t);s++);s===r&&n.push(t)}return n},E.difference=T(function(e,t){return t=k(t,!0,!0),E.filter(e,function(e){return!E.contains(t,e)})}),E.unzip=function(e){for(var t=e&&E.max(e,R).length||0,n=Array(t),r=0;r<t;r++)n[r]=E.pluck(e,r);return n},E.zip=T(E.unzip),E.object=function(e,t){for(var n={},r=0,o=R(e);r<o;r++)t?n[e[r]]=t[r]:n[e[r][0]]=e[r][1];return n};var D=function(e){return function(t,n,r){n=S(n,r);for(var o=R(t),i=0<e?0:o-1;0<=i&&i<o;i+=e)if(n(t[i],i,t))return i;return-1}};E.findIndex=D(1),E.findLastIndex=D(-1),E.sortedIndex=function(e,t,n,o){for(var i=(n=S(n,o,1))(t),s=0,a=R(e);s<a;){var c=r((s+a)/2);n(e[c])<i?s=c+1:a=c}return s};var j=function(e,t,n){return function(r,s,a){var c=0,u=R(r);if("number"==typeof a)0<e?c=0<=a?a:i(a+u,c):u=0<=a?o(a+1,u):a+u+1;else if(n&&a&&u)return r[a=n(r,s)]===s?a:-1;if(s!=s)return 0<=(a=t(d.call(r,c,u),E.isNaN))?a+c:-1;for(a=0<e?c:u-1;0<=a&&a<u;a+=e)if(r[a]===s)return a;return-1}};E.indexOf=j(1,E.findIndex,E.sortedIndex),E.lastIndexOf=j(-1,E.findLastIndex),E.range=function(e,t,n){null==t&&(t=e||0,e=0),n||(n=t<e?-1:1);for(var r=i(Math.ceil((t-e)/n),0),o=Array(r),s=0;s<r;s++,e+=n)o[s]=e;return o},E.chunk=function(e,t){if(null==t||1>t)return[];for(var n=[],r=0,o=e.length;r<o;)n.push(d.call(e,r,r+=t));return n};var L=function(e,t,n,r,o){if(!(r instanceof t))return e.apply(n,o);var i=O(e.prototype),s=e.apply(i,o);return E.isObject(s)?s:i};E.bind=T(function(e,t,n){if(!E.isFunction(e))throw new TypeError("Bind must be called on a function");var r=T(function(o){return L(e,r,t,this,n.concat(o))});return r}),E.partial=T(function(e,t){var n=E.partial.placeholder,r=function(){for(var o=0,i=t.length,s=Array(i),a=0;a<i;a++)s[a]=t[a]===n?arguments[o++]:t[a];for(;o<arguments.length;)s.push(arguments[o++]);return L(e,r,this,this,s)};return r}),E.partial.placeholder=E,E.bindAll=T(function(e,t){var n=(t=k(t,!1,!1)).length;if(1>n)throw new Error("bindAll must be passed function names");for(;n--;){var r=t[n];e[r]=E.bind(e[r],e)}}),E.memoize=function(e,t){var n=function(r){var o=n.cache,i=""+(t?t.apply(this,arguments):r);return I(o,i)||(o[i]=e.apply(this,arguments)),o[i]};return n.cache={},n},E.delay=T(function(e,t,n){return setTimeout(function(){return e.apply(null,n)},t)}),E.defer=E.partial(E.delay,E,1),E.throttle=function(e,t,n){var r,o,i,s,a=0;n||(n={});var c=function(){a=!1===n.leading?0:E.now(),r=null,s=e.apply(o,i),r||(o=i=null)},u=function(){var u=E.now();a||!1!==n.leading||(a=u);var l=t-(u-a);return o=this,i=arguments,0>=l||l>t?(r&&(clearTimeout(r),r=null),a=u,s=e.apply(o,i),!r&&(o=i=null)):!r&&!1!==n.trailing&&(r=setTimeout(c,l)),s};return u.cancel=function(){clearTimeout(r),a=0,r=o=i=null},u},E.debounce=function(e,t,n){var r,o,i=function(t,n){r=null,n&&(o=e.apply(t,n))},s=T(function(s){if(r&&clearTimeout(r),n){var a=!r;r=setTimeout(i,t),a&&(o=e.apply(this,s))}else r=E.delay(i,t,this,s);return o});return s.cancel=function(){clearTimeout(r),r=null},s},E.wrap=function(e,t){return E.partial(t,e)},E.negate=function(e){return function(){return!e.apply(this,arguments)}},E.compose=function(){var e=arguments,t=e.length-1;return function(){for(var n=t,r=e[t].apply(this,arguments);n--;)r=e[n].call(this,r);return r}},E.after=function(e,t){return function(){if(1>--e)return t.apply(this,arguments)}},E.before=function(e,t){var n;return function(){return 0<--e&&(n=t.apply(this,arguments)),1>=e&&(t=null),n}},E.once=E.partial(E.before,2),E.restArguments=T;var F=!{toString:null}.propertyIsEnumerable("toString"),H=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],U=function(e,t){var n=H.length,r=e.constructor,o=E.isFunction(r)&&r.prototype||l,i="constructor";for(I(e,i)&&!E.contains(t,i)&&t.push(i);n--;)(i=H[n])in e&&e[i]!==o[i]&&!E.contains(t,i)&&t.push(i)};E.keys=function(e){if(!E.isObject(e))return[];if(g)return g(e);var t=[];for(var n in e)I(e,n)&&t.push(n);return F&&U(e,t),t},E.allKeys=function(e){if(!E.isObject(e))return[];var t=[];for(var n in e)t.push(n);return F&&U(e,t),t},E.values=function(e){for(var t=E.keys(e),n=t.length,r=Array(n),o=0;o<n;o++)r[o]=e[t[o]];return r},E.mapObject=function(e,t,n){t=S(t,n);for(var r,o=E.keys(e),i=o.length,s={},a=0;a<i;a++)s[r=o[a]]=t(e[r],r,e);return s},E.pairs=function(e){for(var t=E.keys(e),n=t.length,r=Array(n),o=0;o<n;o++)r[o]=[t[o],e[t[o]]];return r},E.invert=function(e){for(var t={},n=E.keys(e),r=0,o=n.length;r<o;r++)t[e[n[r]]]=n[r];return t},E.functions=E.methods=function(e){var t=[];for(var n in e)E.isFunction(e[n])&&t.push(n);return t.sort()};var W=function(e,t){return function(n){var r=arguments.length;if(t&&(n=Object(n)),2>r||null==n)return n;for(var o=1;o<r;o++)for(var i,s=arguments[o],a=e(s),c=a.length,u=0;u<c;u++)i=a[u],t&&void 0!==n[i]||(n[i]=s[i]);return n}};E.extend=W(E.allKeys),E.extendOwn=E.assign=W(E.keys),E.findKey=function(e,t,n){t=S(t,n);for(var r,o=E.keys(e),i=0,s=o.length;i<s;i++)if(t(e[r=o[i]],r,e))return r};var q,G,P=function(e,t,n){return t in n};E.pick=T(function(e,t){var n={},r=t[0];if(null==e)return n;E.isFunction(r)?(1<t.length&&(r=N(r,t[1])),t=E.allKeys(e)):(r=P,t=k(t,!1,!1),e=Object(e));for(var o=0,i=t.length;o<i;o++){var s=t[o],a=e[s];r(a,s,e)&&(n[s]=a)}return n}),E.omit=T(function(e,t){var n,r=t[0];return E.isFunction(r)?(r=E.negate(r),1<t.length&&(n=t[1])):(t=E.map(k(t,!1,!1),String),r=function(e,n){return!E.contains(t,n)}),E.pick(e,r,n)}),E.defaults=W(E.allKeys,!0),E.create=function(e,t){var n=O(e);return t&&E.extendOwn(n,t),n},E.clone=function(e){return E.isObject(e)?E.isArray(e)?e.slice():E.extend({},e):e},E.tap=function(e,t){return t(e),e},E.isMatch=function(e,t){var n=E.keys(t),r=n.length;if(null==e)return!r;for(var o,i=Object(e),s=0;s<r;s++)if(t[o=n[s]]!==i[o]||!(o in i))return!1;return!0},q=function(e,t,n,r){if(e===t)return 0!==e||1/e==1/t;if(null==e||null==t)return!1;if(e!=e)return t!=t;var o=typeof e;return("function"==o||"object"==o||"object"==typeof t)&&G(e,t,n,r)},G=function(e,t,n,r){e instanceof E&&(e=e._wrapped),t instanceof E&&(t=t._wrapped);var o=f.call(e);if(o!==f.call(t))return!1;switch(o){case"[object RegExp]":case"[object String]":return""+e==""+t;case"[object Number]":return+e==+e?0==+e?1/+e==1/t:+e==+t:+t!=+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object Symbol]":return h.valueOf.call(e)===h.valueOf.call(t)}var i="[object Array]"===o;if(!i){if("object"!=typeof e||"object"!=typeof t)return!1;var s=e.constructor,a=t.constructor;if(s!==a&&!(E.isFunction(s)&&s instanceof s&&E.isFunction(a)&&a instanceof a)&&"constructor"in e&&"constructor"in t)return!1}r=r||[];for(var c=(n=n||[]).length;c--;)if(n[c]===e)return r[c]===t;if(n.push(e),r.push(t),i){if((c=e.length)!==t.length)return!1;for(;c--;)if(!q(e[c],t[c],n,r))return!1}else{var u,l=E.keys(e);if(c=l.length,E.keys(t).length!==c)return!1;for(;c--;)if(u=l[c],!I(t,u)||!q(e[u],t[u],n,r))return!1}return n.pop(),r.pop(),!0},E.isEqual=function(e,t){return q(e,t)},E.isEmpty=function(e){return!(null!=e)||(A(e)&&(E.isArray(e)||E.isString(e)||E.isArguments(e))?0===e.length:0===E.keys(e).length)},E.isElement=function(e){return!(!e||1!==e.nodeType)},E.isArray=m||function(e){return"[object Array]"===f.call(e)},E.isObject=function(e){var t=typeof e;return"function"==t||"object"==t&&!!e},E.each(["Arguments","Function","String","Number","Date","RegExp","Error","Symbol","Map","WeakMap","Set","WeakSet"],function(e){E["is"+e]=function(t){return f.call(t)==="[object "+e+"]"}}),E.isArguments(arguments)||(E.isArguments=function(e){return I(e,"callee")});var J=a.document&&a.document.childNodes;"object"!=typeof Int8Array&&"function"!=typeof J&&(E.isFunction=function(e){return"function"==typeof e||!1}),E.isFinite=function(e){return!E.isSymbol(e)&&isFinite(e)&&!isNaN(parseFloat(e))},E.isNaN=function(e){return E.isNumber(e)&&isNaN(e)},E.isBoolean=function(e){return!0===e||!1===e||"[object Boolean]"===f.call(e)},E.isNull=function(e){return null===e},E.isUndefined=function(e){return void 0===e},E.has=function(e,t){if(!E.isArray(t))return I(e,t);for(var n,r=t.length,o=0;o<r;o++){if(n=t[o],null==e||!_.call(e,n))return!1;e=e[n]}return!!r},E.noConflict=function(){return a._=c,this},E.identity=function(e){return e},E.constant=function(e){return function(){return e}},E.noop=function(){},E.property=function(e){return E.isArray(e)?function(t){return C(t,e)}:x(e)},E.propertyOf=function(e){return null==e?function(){}:function(t){return E.isArray(t)?C(e,t):e[t]}},E.matcher=E.matches=function(e){return e=E.extendOwn({},e),function(t){return E.isMatch(t,e)}},E.times=function(e,t,n){var r=Array(i(0,e));t=N(t,n,1);for(var o=0;o<e;o++)r[o]=t(o);return r},E.random=function(e,t){return null==t&&(t=e,e=0),e+r(Math.random()*(t-e+1))},E.now=Date.now||function(){return(new Date).getTime()};var z={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},X=E.invert(z),$=function(e){var t=function(t){return e[t]},n="(?:"+E.keys(e).join("|")+")",r=RegExp(n),o=RegExp(n,"g");return function(e){return e=null==e?"":""+e,r.test(e)?e.replace(o,t):e}};E.escape=$(z),E.unescape=$(X),E.result=function(e,t,n){E.isArray(t)||(t=[t]);var r=t.length;if(!r)return E.isFunction(n)?n.call(e):n;for(var o,i=0;i<r;i++)void 0===(o=null==e?void 0:e[t[i]])&&(o=n,i=r),e=E.isFunction(o)?o.call(e):o;return e};var K=0;E.uniqueId=function(e){var t=++K+"";return e?e+t:t},E.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var Q=/(.)^/,V={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},Y=/\\|'|\r|\n|\u2028|\u2029/g,Z=function(e){return"\\"+V[e]};E.template=function(e,t,n){!t&&n&&(t=n),t=E.defaults({},t,E.templateSettings);var r,o=RegExp([(t.escape||Q).source,(t.interpolate||Q).source,(t.evaluate||Q).source].join("|")+"|$","g"),i=0,s="__p+='";e.replace(o,function(t,n,r,o,a){return s+=e.slice(i,a).replace(Y,Z),i=a+t.length,n?s+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'":r?s+="'+\n((__t=("+r+"))==null?'':__t)+\n'":o&&(s+="';\n"+o+"\n__p+='"),t}),s+="';\n",t.variable||(s="with(obj||{}){\n"+s+"}\n"),s="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+s+"return __p;\n";try{r=new Function(t.variable||"obj","_",s)}catch(t){throw t.source=s,t}var a=function(e){return r.call(this,e,E)},c=t.variable||"obj";return a.source="function("+c+"){\n"+s+"}",a},E.chain=function(e){var t=E(e);return t._chain=!0,t};var ee=function(e,t){return e._chain?E(t).chain():t};E.mixin=function(e){return E.each(E.functions(e),function(t){var n=E[t]=e[t];E.prototype[t]=function(){var e=[this._wrapped];return p.apply(e,arguments),ee(this,n.apply(E,e))}}),E},E.mixin(E),E.each(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=u[e];E.prototype[e]=function(){var n=this._wrapped;return t.apply(n,arguments),("shift"===e||"splice"===e)&&0===n.length&&delete n[0],ee(this,n)}}),E.each(["concat","join","slice"],function(e){var t=u[e];E.prototype[e]=function(){return ee(this,t.apply(this._wrapped,arguments))}}),E.prototype.value=function(){return this._wrapped},E.prototype.valueOf=E.prototype.toJSON=E.prototype.value,E.prototype.toString=function(){return this._wrapped+""},void 0===(s=function(){return E}.apply(t,[]))||(n.exports=s)}()}).call(this,n(42),n(43)(e))},function(e){var t=function(){return this}();try{t=t||new Function("return this")()}catch(e){"object"==typeof window&&(t=window)}e.exports=t},function(e){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],!e.children&&(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}}]);